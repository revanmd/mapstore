(self.webpackChunkmapstore2=self.webpackChunkmapstore2||[]).push([[2269],{782269:(o,e,t)=>{"use strict";t.r(e),t.d(e,{default:()=>m});var i=t(624089),r=t(65792),l=t.n(r),n=t(984596),a=t.n(n),s=t(396026),c=t.n(s);function d(o){let{color:e,opacity:t}=o;const[r,n,a,s]=l()(e).gl();return void 0!==t?new i.Color(r,n,a,t):new i.Color(r,n,a,s)}function p(o,e){var t,i;switch(o){case"polyline":return null===(t=e[o])||void 0===t?void 0:t.positions;case"polygon":return null===(i=e[o])||void 0===i?void 0:i.hierarchy;default:return null}}function h(o){let{color:e,opacity:t,dasharray:r}=o;if((null==r?void 0:r.length)<=0)return d({color:e,opacity:t});const l=r.reduce(((o,e)=>o+e),0);return new i.PolylineDashMaterialProperty({color:d({color:e,opacity:t}),dashLength:l,dashPattern:parseInt(r.map((o=>Math.floor(o/l*16))).map(((o,e)=>c()(o).map((()=>e%2==0?"1":"0")).join(""))).join(""),2)})}function y(o){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return o.properties?Object.keys(o.properties).reduce(((e,t)=>{const i=new RegExp(`\\{\\{${t}\\}\\}`,"g");return e.replace(i,o.properties[t]??"")}),e):e}const f=["billboard","box","corridor","cylinder","ellipse","ellipsoid","label","model","tileset","path","plane","point","polygon","polyline","polylineVolume","rectangle","wall"];function u(){let{rules:o=[]}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{images:e=[],getImageIdFromSymbolizer:t,geoStylerStyleFilter:r=(()=>!0)}=arguments.length>1?arguments[1]:void 0;return l=>{let{entities:n,opacity:s=1}=l;n.forEach((o=>{let e={};f.forEach((t=>{o._msStoredCoordinates||(e[t]=p(t,o)||void 0),o[t]=void 0})),o._msStoredCoordinates||(o._msStoredCoordinates=e)})),o.forEach((o=>{o.symbolizers.forEach((l=>{n.forEach((n=>{var c;const p=(null==n||null===(c=n.properties)||void 0===c?void 0:c.getValue(i.JulianDate.now()))||{};if(!o.filter||r({properties:p||{}},o.filter)){if("Mark"===l.kind&&n.position){const{image:o,width:r,height:a}=e.find((o=>{let{id:e}=o;return e===t(l)}))||{};if(o){const e=r>a?r:a,t=2*l.radius/e;n.billboard=new i.BillboardGraphics({image:o,scale:t,rotation:i.Math.toRadians(-1*l.rotate||0),disableDepthTestDistance:l.msBringToFront?Number.POSITIVE_INFINITY:0,heightReference:i.HeightReference.CLAMP_TO_GROUND,color:d({color:"#ffffff",opacity:1*s})})}}if("Icon"===l.kind&&n.position){const{image:o,width:r,height:a}=e.find((o=>{let{id:e}=o;return e===t(l)}))||{};if(o){const e=r>a?r:a,t=l.size/e;n.billboard=new i.BillboardGraphics({image:o,scale:t,rotation:i.Math.toRadians(-1*l.rotate||0),disableDepthTestDistance:l.msBringToFront?Number.POSITIVE_INFINITY:0,heightReference:i.HeightReference.CLAMP_TO_GROUND,color:d({color:"#ffffff",opacity:l.opacity*s})})}}var f,u;"Line"===l.kind&&n._msStoredCoordinates.polyline&&(n.polyline=new i.PolylineGraphics({material:null!=l&&l.dasharray?h({color:l.color,opacity:l.opacity*s,dasharray:l.dasharray}):d({color:l.color,opacity:l.opacity*s}),width:l.width,positions:n._msStoredCoordinates.polyline,clampToGround:l.msClampToGround})),"Fill"===l.kind&&n._msStoredCoordinates.polygon&&(n.polygon=new i.PolygonGraphics({material:d({color:l.color,opacity:l.fillOpacity*s}),hierarchy:n._msStoredCoordinates.polygon,classificationType:"terrain"===l.msClassificationType?i.ClassificationType.TERRAIN:"3d"===l.msClassificationType?i.ClassificationType.CESIUM_3D_TILE:i.ClassificationType.BOTH}),l.outlineColor&&0!==l.outlineWidth&&(n.polyline=new i.PolylineGraphics({material:d({color:l.outlineColor,opacity:l.outlineOpacity*s}),width:l.outlineWidth,positions:n._msStoredCoordinates.polygon.getValue().positions,clampToGround:l.msClampToGround}))),"Text"===l.kind&&n.position&&(n.label=new i.LabelGraphics({text:y({properties:p},l.label),font:[l.fontStyle,l.fontWeight,`${l.size}px`,a()(l.font||["serif"]).join(", ")].filter((o=>o)).join(" "),fillColor:d({color:l.color,opacity:1*s}),heightReference:i.HeightReference.CLAMP_TO_GROUND,pixelOffset:new i.Cartesian2((null==l||null===(f=l.offset)||void 0===f?void 0:f[0])??0,(null==l||null===(u=l.offset)||void 0===u?void 0:u[1])??0),outlineColor:d({color:l.haloColor,opacity:1*s}),outlineWidth:l.haloWidth}))}}))}))}))}}const m=class{constructor(){let{drawIcons:o,getImageIdFromSymbolizer:e,geoStylerStyleFilter:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._drawIcons=o||(()=>Promise.resolve(null)),this._getImageIdFromSymbolizer=e||(o=>o.symbolizerId),this._geoStylerStyleFilter=t||(()=>!0)}readStyle(){return new Promise(((o,e)=>{try{o(null)}catch(o){e(o)}}))}writeStyle(o){var e=this;return new Promise(((t,i)=>{try{this._drawIcons(o).then((function(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const r=u(o,{images:i,getImageIdFromSymbolizer:e._getImageIdFromSymbolizer,geoStylerStyleFilter:e._geoStylerStyleFilter});t(r)}))}catch(o){i(o)}}))}}},540098:o=>{var e=Math.ceil,t=Math.max;o.exports=function(o,i,r,l){for(var n=-1,a=t(e((i-o)/(r||1)),0),s=Array(a);a--;)s[l?a:++n]=o,o+=r;return s}},747445:(o,e,t)=>{var i=t(540098),r=t(816612),l=t(418601);o.exports=function(o){return function(e,t,n){return n&&"number"!=typeof n&&r(e,t,n)&&(t=n=void 0),e=l(e),void 0===t?(t=e,e=0):t=l(t),n=void 0===n?e<t?1:-1:l(n),i(e,t,n,o)}}},396026:(o,e,t)=>{var i=t(747445)();o.exports=i}}]);