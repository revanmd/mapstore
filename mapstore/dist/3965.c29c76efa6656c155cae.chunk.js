(self.webpackChunkmapstore2=self.webpackChunkmapstore2||[]).push([[3965,2619],{227556:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});var o=r(124852),s=r(843033);let i;const n=e=>{const{map:t,onBoxEnd:r,status:n}=e;return(0,o.useEffect)((()=>{"start"===n?(i=new s.Z({condition:function(e){return e.originalEvent.altKey}}),t.addInteraction(i)):"end"===n&&t.removeInteraction(i)}),[n]),(0,o.useEffect)((()=>{i&&i.on("boxend",(e=>{r({boxExtent:i.getGeometry().getExtent(),modifiers:{ctrl:e.mapBrowserEvent.pointerEvent.ctrlKey,metaKey:e.mapBrowserEvent.pointerEvent.metaKey}})}))}),[n]),null}},612814:(e,t,r)=>{"use strict";r.d(t,{Z:()=>me});var o=r(124852),s=r.n(o),i=r(957043),n=r.n(i),a=r(91175),p=r.n(a),c=r(313311),l=r.n(c),d=r(512571),h=r.n(d),u=r(957557),g=r.n(u),y=r(701469),m=r.n(y),w=r(610928),f=r.n(w),C=r(763105),S=r.n(C),P=r(414293),G=r.n(P),I=r(984596),v=r.n(I),F=r(45697),x=r.n(F),T=r(727418),E=r.n(T),b=r(455877),M=r.n(b),L=r(470509),k=r.n(L),O=r(835516),j=r(351546),Z=r(119950),D=r(847529),A=r(363082),W=r(923715),N=r(169141),R=r(623068),V=r(973410),H=r(429902),J=r(372445),B=r(552329),q=r(640353),_=r(752043),K=r(944538),U=r(525642),z=r(513987),X=r(869669),$=r(798090),Y=r(831219),Q=r(120767),ee=r(898185),te=r(315565),re=r(409371),oe=r(378426),se=r(436403),ie=r(718369),ne=r(829194),ae=r(701577),pe=r(51273),ce=r(756834),le=r(421915),de=r(650141),he=r(880161),ue=r(487758);function ge(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const ye=new N.Z;class me extends s().Component{constructor(){var e;super(...arguments),e=this,ge(this,"getNewFeature",((e,t,r,o)=>new R.Z({geometry:this.createOLGeometry({type:e,coordinates:t,radius:r,center:o})}))),ge(this,"getMapCrs",(()=>this.props.map.getView().getProjection().getCode())),ge(this,"getWMSSnapSource",((e,t)=>{var r;const o=this.props.toggleSnappingIsLoading;if((null==this||null===(r=this.snapMetadata)||void 0===r?void 0:r.id)!==e.id){const r=new V.Z({format:new N.Z,loader:function(s,i,n){const a=n.getCode(),p=(0,ue.g7)(e.search.url,e.name,{version:"1.1.0",outputFormat:"application/json",srsname:a,bbox:s.join(",")+","+a,maxFeatures:(null==t?void 0:t.maxFeatures)??5e5});o();const c=e=>{r.removeLoadedExtent(s),e&&console.warn(e)};k().get(p).then((e=>{o(),200===e.status?r.addFeatures(r.getFormat().readFeatures(e.data)):c()})).catch(c)},strategy:this.selectLoadingStrategy(t)});this.snapMetadata={id:e.id,source:r}}return this.snapMetadata.source})),ge(this,"getLayerInstance",(e=>this.props.map.getLayers().getArray().find((t=>t.get("msId")===e)))),ge(this,"updateFeatureStyles",(e=>{e&&e.length>0&&e.forEach((e=>{if(e.style){let t=this.toOlFeature(e);t&&t.setStyle(e.style?(0,W.C2)(e):this.toOlStyle(e.style,e.selected))}}))})),ge(this,"updateOnlyFeatureStyles",(e=>{this.drawLayer&&this.drawLayer.getSource().getFeatures().forEach((t=>{let r=p()(e.features).features||e.features,o=l()(r,(e=>e.properties.id===t.getProperties().id));if(o){let e=(0,Z.createStylesAsync)(v()(o.style));k().all(e).then((e=>{t.setStyle((()=>(0,W.Cw)({...o,style:e})))}))}}))})),ge(this,"addLayer",((e,t)=>{let r=null;const o=this.convertGeometryTypeToStyleType(e.drawMethod);r=t=>{let r=p()(e.features)&&l()(p()(e.features).features,(e=>e.properties.id===t.getProperties().id))||null;if(r){let e=(0,Z.createStylesAsync)(v()(r.style));return k().all(e).then((e=>{t.setStyle((()=>(0,W.Cw)({...r,style:e})))})),null}return(0,W.Cw)({style:W.jF[o]})},this.geojson=new N.Z,this.drawSource=new V.Z,this.drawLayer=new H.Z({source:this.drawSource,zIndex:1e8,style:r}),this.props.map.addLayer(this.drawLayer),t&&this.addInteractions(e);let s=p()(e.features);if(s&&s.features&&s.features.length){const t=s.features.filter((t=>!t.properties.isCircle||t.properties.isCircle&&!t.properties.canEdit||!e.options.drawEnabled));return this.addFeatures(E()({},e,{features:[{...s,features:t}]}))}return this.addFeatures(e)})),ge(this,"addFeatures",(e=>{let{features:t,drawMethod:r,options:o}=e;const s=this.getMapCrs();let i;if(t.forEach((e=>{if("FeatureCollection"===e.type){let t=(new N.Z).readFeatures(e);o.geodesic||(t=t.map((e=>(0,D.aj)(e,s)))),this.drawSource=new V.Z({features:t}),this.drawLayer.setSource(this.drawSource)}else{let n=null,a=e;var t;if(a.geometry&&"GeometryCollection"!==a.geometry.type&&(a=(0,j.reprojectGeoJson)(a,a.featureProjection,s).geometry),"GeometryCollection"!==a.type)"Circle"===r&&a&&(a.properties&&a.properties.center||a.center)?(n=a.properties&&a.properties.center?(0,j.reproject)(a.properties.center,"EPSG:4326",s):a.center,n=[n.x,n.y],i=new R.Z({geometry:this.createOLGeometry({type:"Circle",center:n,projection:"EPSG:3857",radius:a.properties&&a.properties.radius||a.radius,options:o})})):i=new R.Z({geometry:this.createOLGeometry(a.geometry?a.geometry:{...a,radius:null===(t=a.properties)||void 0===t?void 0:t.radius,center:n})}),i.setProperties(e.properties),this.drawSource.addFeature(i)}})),0===t.length&&(o.editEnabled||o.drawEnabled))o.transformToFeatureCollection?(this.drawSource=new V.Z({features:(new N.Z).readFeatures({type:"FeatureCollection",features:[]})}),this.drawLayer.setSource(this.drawSource)):(i=new R.Z({geometry:this.createOLGeometry({type:r,coordinates:null})}),this.drawSource.addFeature(i));else{if(t[0]&&"GeometryCollection"===t[0].type){this.drawSource=new V.Z({features:(new N.Z).readFeatures(t[0])});let e=this.replacePolygonsWithCircles(this.drawSource.getFeatures()[0]);this.drawSource.getFeatures()[0].getGeometry().setGeometries(e),this.drawLayer.setSource(this.drawSource)}t[0]&&t[0].geometry&&"GeometryCollection"===t[0].geometry.type&&(i=(0,j.reprojectGeoJson)(t[0],o.featureProjection,s).geometry,this.drawSource=new V.Z({features:(new N.Z).readFeatures(i)}),this.drawSource.getFeatures()[0].set("textGeometriesIndexes",t[0].properties&&t[0].properties.textGeometriesIndexes),this.drawSource.getFeatures()[0].set("textValues",t[0].properties&&t[0].properties.textValues),this.drawSource.getFeatures()[0].set("circles",t[0].properties&&t[0].properties.circles),this.drawLayer.setSource(this.drawSource))}return this.updateFeatureStyles(t),i})),ge(this,"replaceFeatures",(e=>{let t;return this.drawLayer?(this.drawSource.clear(),t=this.addFeatures(e),e.style&&this.drawLayer.setStyle((t=>{let r=l()(p()(e.features).features,(e=>e.properties.id===t.getProperties().id));if(r){let e=(0,Z.createStylesAsync)(v()(r.style));return k().all(e).then((e=>{t.setStyle((()=>(0,W.Cw)({...r,style:e})))})),null}const o=this.convertGeometryTypeToStyleType(e.drawMethod);return(0,W.Cw)({style:W.jF[o]})}))):t=this.addLayer(e,e.options&&e.options.drawEnabled||!1),t})),ge(this,"endDrawing",(e=>{const t=this.replaceFeatures(e);if(t){const r=this.fromOLFeature(t);"Circle"===e.drawMethod&&e&&e.features&&e.features.length&&e.features[0]&&e.features[0].radius>=0&&(r.radius=e.features[0].radius),this.props.onEndDrawing(r,e.drawOwner)}})),ge(this,"addDrawInteraction",((e,t,r,o)=>{this.drawInteraction&&this.removeDrawInteraction(),this.drawInteraction=new J.ZP(this.drawPropertiesForGeometryType(e,r,this.drawSource,o)),this.props.map.disableEventListener("singleclick"),this.drawInteraction.on("drawstart",(()=>{this.selectInteraction&&(this.selectInteraction.getFeatures().clear(),this.selectInteraction.setActive(!1))})),this.drawInteraction.on("drawend",(e=>{const r=e.feature.clone();if(r.set("id",M().v1()),"Circle"===this.props.drawMethod&&"Circle"===r.getGeometry().getType()){const e=r.getGeometry().getRadius(),t=r.getGeometry().getCenter();r.setGeometry(this.polygonFromCircle(t,e))}const o=this.fromOLFeature(r,t);this.props.onEndDrawing(o,this.props.drawOwner),this.props.options.stopAfterDrawing&&this.props.onChangeDrawingStatus("stop",this.props.drawMethod,this.props.drawOwner,this.props.features.concat([o])),this.selectInteraction&&(this.addSelectInteraction(),this.selectInteraction.setActive(!0))})),this.props.map.addInteraction(this.drawInteraction),this.setDoubleClickZoomEnabled(!1)})),ge(this,"selectLoadingStrategy",(e=>"all"===(null==e?void 0:e.strategy)?he.$6:he.VW)),ge(this,"addSnapInteraction",(e=>{let{snapping:t,snappingLayerInstance:r,snapConfig:o}=e;if(!t)return;const s=this.getLayerInstance(r.id),i=r.type;if(this.removeSnapInteraction(),s){switch(null==s?void 0:s.type){case D.ox:this.snapInteraction=new de.Z({...o,source:s.getSource()});break;case D.dV:case D.k4:if("wms"===i){const e=this.getWMSSnapSource(r,o);this.snapLayer=new H.Z({source:e,style:new Y.default({stroke:new Q.default({color:"rgba(255,255,0,0)"})})}),this.props.map.addLayer(this.snapLayer),this.snapInteraction=new de.Z({...o,source:e})}}this.snapInteraction&&this.props.map.addInteraction(this.snapInteraction)}})),ge(this,"toMulti",(e=>"Point"===e.getType()?new B.Z([e.getCoordinates()]):e)),ge(this,"handleDrawAndEdit",((e,t,r,o)=>{this.drawInteraction&&this.removeDrawInteraction(),this.drawInteraction=new J.ZP(this.drawPropertiesForGeometryType((0,O.getSimpleGeomType)(e),r,(0,O.isSimpleGeomType)(e)?this.drawSource:null,o)),this.props.map.disableEventListener("singleclick"),this.drawInteraction.on("drawstart",(()=>{this.selectInteraction&&(this.selectInteraction.getFeatures().clear(),this.selectInteraction.setActive(!1))})),this.drawInteraction.on("drawend",(r=>{const s=r.feature.clone(),i=M().v1();s.set("id",i);let n,a,c,d=s.getGeometry(),h=this.drawLayer.getSource().getFeatures(),u=this.props.features;if(this.props.options.transformToFeatureCollection){let t;if("Circle"===e){let e,s,n;if(c="Polygon",this.props.options.geodesic){s=r.feature.getGeometry().geodesicCenter||(0,le.qg)(d.getExtent());const t=this.props.map.getView().getProjection().getCode(),o=[[...s],[...d.getCoordinates()[0][0]]].map((e=>this.reprojectCoordinatesToWGS84(e,t)));e=(0,j.calculateDistance)(o,"haversine"),n=(0,q.iu)(o[0],e).clone().transform("EPSG:4326",t).getCoordinates()}else e=d.getRadius(),s=d.getCenter(),n=this.polygonCoordsFromCircle(s,e);t=this.getNewFeature(c,n),s=(0,j.reproject)(s,this.getMapCrs(),"EPSG:4326",!1);const a=o&&o.features&&o.features.length&&o.features[0]&&o.features[0].features&&o.features[0].features.length&&o.features[0].features.filter((e=>e.properties.isDrawing))[0].properties.id||i;t.setProperties({isCircle:!0,radius:e,center:[s.x,s.y],id:a,crs:this.getMapCrs(),isGeodesic:this.props.options.geodesic})}else if("Polygon"===e){c=this.props.drawMethod;let e=d.getCoordinates();e[0].push(e[0][0]),t=this.getNewFeature(c,e)}else{c="Text"===e?"Point":this.props.drawMethod;let r=d.getCoordinates();t=this.getNewFeature(c,r),"Text"===e&&t.setProperties({isText:!0,valueText:"."})}const s=h.length>=1?[...this.replaceCirclesWithPolygonsInFeatureColl(h)]:[];t.getProperties().id||t.setProperties({id:M().v1()});const n=[...s,t];let a=ye.writeFeaturesObject(n);const p=new V.Z({features:(new N.Z).readFeatures(a)});this.drawLayer.setSource(p);let l=(0,j.reprojectGeoJson)(a,this.getMapCrs(),"EPSG:4326");this.props.onGeometryChanged([l],this.props.drawOwner,this.props.options&&this.props.options.stopAfterDrawing?"enterEditMode":"","Text"===e,"Circle"===e),this.props.onEndDrawing(l,this.props.drawOwner),this.props.onDrawingFeatures([f()(l.features)])}else{if("Circle"===e){c="Polygon";const e=d.getRadius(),t=d.getCenter(),r=this.polygonCoordsFromCircle(t,e),o=this.toMulti(this.createOLGeometry({type:c,coordinates:r}));if(1===u.length&&u[0]&&!u[0].geometry)n=[],a=new $.default([o]);else if(n=this.toMulti(p()(h).getGeometry()),n.getGeometries){const e=this.replaceCirclesWithPolygons(p()(h));a=new $.default([...e,o])}else a=new $.default([n,o]);s.setGeometry(a)}else if("Text"===e||"MultiPoint"===e){let e=d.getCoordinates();c="MultiPoint";let t=this.toMulti(this.createOLGeometry({type:c,coordinates:[e]}));if(1!==u.length||u[0].geometry)if(n=this.toMulti(p()(h).getGeometry()),n.getGeometries){let e=this.replaceCirclesWithPolygons(p()(h));a=new $.default([...e,t])}else a=n.clone(),a.appendPoint(t.getPoint(0));else n=[],a=t.clone();s.setGeometry(a)}else if(!(0,O.isSimpleGeomType)(e)){let t;a=null,n=1!==u.length||u[0].geometry?this.toMulti(p()(h).getGeometry()):this.toMulti(this.createOLGeometry({type:e,coordinates:null}));let r=h.map((e=>"GeometryCollection"===e.getGeometry().getType()?e.getGeometry().getGeometries():e.getGeometry()));"GeometryCollection"===h[0].getGeometry().getType()&&(r=r[0]);let o=l()(r,(t=>t.getType()===e));if(o?this.appendToMultiGeometry(e,o,d):t=this.toMulti(this.createOLGeometry({type:e,coordinates:d.getCoordinates()})),d.getType()!==(0,O.getSimpleGeomType)(n.getType())){let r=p()(h).getGeometry().getGeometries?this.replaceCirclesWithPolygons(p()(h)):[];if(o){let e=r.map((e=>e.getType()===o.getType()?o:e));a=new $.default(e)}else a="GeometryCollection"===n.getType()?new $.default([...r,t]):"Text"===e?new $.default([t]):new $.default([n,t]);s.setGeometry(a)}else s.setGeometry(o)}let r=this.props.features[0].properties;"Text"===e&&(r=E()({},this.props.features[0].properties,{textValues:(this.props.features[0].properties.textValues||[]).concat(["."]),textGeometriesIndexes:(this.props.features[0].properties.textGeometriesIndexes||[]).concat([s.getGeometry().getGeometries().length-1])})),"Circle"===e&&(r=E()({},r,{circles:(this.props.features[0].properties.circles||[]).concat([s.getGeometry().getGeometries().length-1])}));let o=this.fromOLFeature(s,t,r);const i=new V.Z({features:(new N.Z).readFeatures(o)});this.drawLayer.setSource(i);let g=(0,j.reprojectGeoJson)(ye.writeFeatureObject(s.clone()),this.getMapCrs(),"EPSG:4326");"Polygon"===g.geometry.type&&g.geometry.coordinates[0].push(g.geometry.coordinates[0][0]),this.props.onGeometryChanged([g],this.props.drawOwner,this.props.options&&this.props.options.stopAfterDrawing?"enterEditMode":"","Text"===e,"Circle"===e),this.props.onEndDrawing(o,this.props.drawOwner),o=(0,j.reprojectGeoJson)(o,this.getMapCrs(),"EPSG:4326");const y=(0,O.isSimpleGeomType)(this.props.drawMethod)&&"GeometryCollection"!==this.props.features[0].geometry.type?this.props.features.map((e=>({...e,featureProjection:this.getMapCrs()}))).concat([{...o,type:"Feature",geometry:{type:o.type,coordinates:o.coordinates},featureProjection:this.getMapCrs(),properties:r}]):[{...o,properties:r}];this.props.options.stopAfterDrawing?this.props.onChangeDrawingStatus("stop",this.props.drawMethod,this.props.drawOwner,y):this.props.onChangeDrawingStatus("replace",this.props.drawMethod,this.props.drawOwner,y.map((e=>(0,j.reprojectGeoJson)(e,"EPSG:4326",this.getMapCrs()))),E()({},this.props.options,{featureProjection:this.getMapCrs()})),this.selectInteraction&&(this.addSelectInteraction(),this.selectInteraction.setActive(!0))}})),this.props.map.addInteraction(this.drawInteraction),this.setDoubleClickZoomEnabled(!1)})),ge(this,"drawPropertiesForGeometryType",(function(t,r,o){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i={source:e.drawSource||o,type:t,style:"Marker"===t?(0,W.Fc)(s.style):new Y.default({fill:new ee.default({color:"rgba(255, 255, 255, 0.2)"}),stroke:new Q.default({color:"rgba(0, 0, 0, 0.5)",lineDash:[10,10],width:2}),image:new re.default({radius:5,stroke:new Q.default({color:"rgba(0, 0, 0, 0.7)"}),fill:new ee.default({color:"rgba(255, 255, 255, 0.2)"})})}),features:new oe.Z,condition:se.Bx},n={};switch(t){case"BBOX":n.type="LineString",n.maxPoints=2,n.geometryFunction=function(e,t){let r=t;r||(r=new q.ZP([]));let o=e[0],s=e[1];return r.setCoordinates([[o,[o[0],s[1]],s,[s[0],o[1]],o]]),r};break;case"Circle":n.maxPoints=100,s.options&&s.options.geodesic?n.geometryFunction=(t,r)=>{let o=r;o||(o=new q.ZP([]),o.setProperties({geodesicCenter:[...t[0]]},!0));let s=e.props.map.getView().getProjection().getCode(),i=[...t].map((t=>e.reprojectCoordinatesToWGS84(t,s))),n=(0,j.calculateDistance)(i,"haversine"),a=(0,q.iu)(i[0],n).clone().transform("EPSG:4326",s).getCoordinates();return o.setCoordinates(a),o}:n.type=t;break;case"Marker":case"Point":case"Text":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":{"LineString"===t&&(n.maxPoints=r);let o="Text"===t||"Marker"===t?"Point":t;n.type=o,n.geometryFunction=(t,r)=>{let i=r;return i||(i=e.createOLGeometry({type:o,coordinates:null,options:s.options})),i.setCoordinates(t),i};break}default:return{}}return E()({},i,n)})),ge(this,"setDoubleClickZoomEnabled",(e=>{let t=this.props.map.getInteractions();for(let r=0;r<t.getLength();r++){let o=t.item(r);if(o instanceof ie.Z){o.setActive(e);break}}})),ge(this,"updateFeatureExtent",(e=>{const t=e.features.getArray(),r=this.props.features.map((e=>{const r=p()(t.filter((t=>this.fromOLFeature(t).id===e.id)));return r?E()({},e,{geometry:r.geometry,center:r.center,extent:r.extent,coordinate:r.coordinates,radius:r.radius}):e}));this.props.onChangeDrawingStatus("replace",this.props.drawMethod,this.props.drawOwner,r)})),ge(this,"addInteractions",(e=>{this.clean(),this.drawLayer||this.addLayer(e),this.addDrawInteraction(e.drawMethod,e.options.startingPoint,e.options.maxPoints,e),e.options&&e.options.editEnabled&&(this.addSelectInteraction(),this.translateInteraction&&this.props.map.removeInteraction(this.translateInteraction),this.translateInteraction=new ne.Z({features:this.selectInteraction.getFeatures()}),this.translateInteraction.setActive(!1),this.translateInteraction.on("translateend",this.updateFeatureExtent),this.props.map.addInteraction(this.translateInteraction),this.addTranslateListener(),this.modifyInteraction&&this.props.map.removeInteraction(this.modifyInteraction),this.modifyInteraction=new ae.Z({features:this.selectInteraction.getFeatures(),condition:e=>(0,se.Xp)(e)&&!(0,se.Ko)(e)}),this.props.map.addInteraction(this.modifyInteraction)),this.drawSource.clear(),e.features.length>0&&this.addFeatures(e)})),ge(this,"addSingleClickListener",((e,t)=>t.map.on("singleclick",e))),ge(this,"addDrawOrEditInteractions",(e=>{this.state&&this.state.keySingleClickCallback&&(0,ce.B)(this.state.keySingleClickCallback);this.clean();let t,r=e.features.map((t=>(0,j.reprojectGeoJson)(t,e.options.featureProjection,this.getMapCrs())||{}));const o=r.every((e=>!!(e&&e.features&&e.features.length))),s=r.every((e=>!!(e&&e.properties&&e.properties.isCircle)));if(o)t=E()({},e,{features:r});else if(s)t=E()({},e,{features:[]});else{const o=r.reduce(((e,t)=>t.geometry?[...e,{...t.geometry,properties:t.properties}]:e),[]);t=E()({},e,{features:o})}this.drawLayer?(this.drawSource.clear(),this.addFeatures(t)):this.addLayer(t),e.options.editEnabled&&(e.options.geodesic||this.addModifyInteraction(e),!1!==e.options.translateEnabled&&this.addTranslateInteraction(),e.options.addClickCallback&&this.setState({keySingleClickCallback:this.addSingleClickListener((t=>{if(this.drawSource&&e.options){let r=this.drawSource.getFeatures(),o=0;const s=r&&r.length&&r.filter(((e,t)=>(e.getProperties().canEdit&&(o=t),e.getProperties().canEdit)))[0]||null,i=s&&s.getGeometry()&&s.getGeometry().getCoordinates&&s.getGeometry().getCoordinates()||[];let n,a=[],p=e.drawMethod;switch(p){case"Polygon":i.length?(0,A.F7)(i)?(a=h()(i[0],0,i[0].length-1),a=a.concat([t.coordinate]),a=[a.concat([i[0][0]])]):a=i[0].length>1?[[...i[0],t.coordinate,i[0][0]]]:[[...i[0],t.coordinate]]:a=[[t.coordinate]],n=this.getNewFeature(p,a),n.setProperties(g()(s&&s.getProperties()||{},"geometry"));break;case"LineString":case"MultiPoint":a=i.length?[...i,t.coordinate]:[t.coordinate],n=this.getNewFeature(p,a),n.setProperties(g()(s&&s.getProperties()||{},"geometry"));break;case"Circle":{p="Polygon";const r=s&&s.getProperties()&&s.getProperties().radius||1e4;let o=t.coordinate,i=this.polygonCoordsFromCircle(o,r);if(e.options.geodesic){const e=this.props.map.getView().getProjection().getCode(),t=[[...o]].map((t=>this.reprojectCoordinatesToWGS84(t,e)));i=(0,q.iu)(t[0],r).clone().transform("EPSG:4326",e).getCoordinates()}n=this.getNewFeature(p,i),o=(0,j.reproject)(o,this.getMapCrs(),"EPSG:4326",!1),n.setProperties(g()(s&&s.getProperties()||{},"geometry")),n.setProperties({isCircle:!0,radius:r,center:[o.x,o.y],isGeodesic:this.props.options.geodesic});break}case"Text":p="Point",n=this.getNewFeature(p,t.coordinate),n.setProperties(g()(s&&s.getProperties()||{},"geometry")),n.setProperties({isText:!0,valueText:s&&s.getProperties()&&s.getProperties().valueText||e.options.defaultTextAnnotation||"New"});break;default:a=t.coordinate,n=this.getNewFeature(p,a),n.setProperties(g()(s&&s.getProperties()||{},"geometry"))}let c={type:"Feature",geometry:{coordinates:[...(0,j.reprojectGeoJson)(ye.writeFeaturesObject([n.clone()]),this.getMapCrs(),"EPSG:4326").features[0].geometry.coordinates],type:p},properties:{...g()(n.getProperties(),"geometry")}};this.props.onDrawingFeatures([c]),e.options.geodesic||(n=(0,D.aj)(n,this.getMapCrs())),r[o]=n,this.drawSource=new V.Z({features:r}),this.drawLayer.setSource(this.drawSource),this.addModifyInteraction(e)}}),e)})),e.options&&e.options.selectEnabled&&this.addSelectInteraction(e.options&&e.options.selected,e),e.options.drawEnabled&&this.handleDrawAndEdit(e.drawMethod,e.options.startingPoint,e.options.maxPoints,e)})),ge(this,"addSelectInteraction",((e,t)=>{let r;if(this.selectInteraction&&this.props.map.removeInteraction(this.selectInteraction),e&&(r=l()(this.drawSource.getFeatures(),(t=>t.getProperties().id===e.properties.id)),r&&this.selectFeature(r)),this.selectInteraction=new pe.Z({layers:[this.drawLayer],features:new oe.Z(e&&r?[r]:null)}),r){const e=this.convertGeometryTypeToStyleType(t.drawMethod);r.setStyle((0,W.C2)({...t,style:{...t.style,type:e,highlight:!0,useSelectedStyle:t.options.useSelectedStyle}},!1,t.features[0]&&t.features[0].properties&&t.features[0].properties.valueText&&[t.features[0].properties.valueText]||[]))}this.selectInteraction.on("select",(e=>{let t=this.selectInteraction.getFeatures().getArray(),r=[];return t.length&&(r=this.props.features.map((r=>{let o=!1;if("FeatureCollection"===r.type&&t.length>0){let e=p()(t);if(this.selectFeature(e),e.getGeometry&&"Circle"===e.getGeometry().getType()){let t=e.getGeometry().getRadius(),r=(0,j.reproject)(e.getGeometry().getCenter(),this.getMapCrs(),"EPSG:4326");e.setProperties({center:[r.x,r.y],radius:t}),e=this.replaceCircleWithPolygon(e.clone())}return this.drawSource.getFeatures().forEach((t=>{t.getProperties().id===e.getProperties().id?this.selectFeature(e):this.deselectFeature(t)})),(0,j.reprojectGeoJson)(ye.writeFeatureObject(e.clone()),this.getMapCrs(),"EPSG:4326")}return o=t.reduce(((e,t)=>t.get("id")===r.id||e),!1),E()({},r,{selected:o,selectedFeature:e.selected})})),this.props.onSelectFeatures(r)),0===t.length?(this.props.onSelectFeatures([]),this.drawSource.getFeatures().map((e=>this.deselectFeature(e))),null):null})),this.props.map.addInteraction(this.selectInteraction)})),ge(this,"selectFeature",(e=>{e.setProperties({selected:!0})})),ge(this,"deselectFeature",(e=>{e.setProperties({selected:!1})})),ge(this,"removeDrawInteraction",(()=>{this.drawInteraction&&(this.props.map.removeInteraction(this.drawInteraction),this.drawInteraction=null,setTimeout((()=>this.props.map.enableEventListener("singleclick")),500),setTimeout((()=>this.setDoubleClickZoomEnabled(!0)),250))})),ge(this,"updateSnapInteraction",(e=>{var t;const r=!(null===(t=e.snappingLayerInstance)||void 0===t||!t.id);if(!r&&this.snapInteraction&&this.removeSnapInteraction(),this.snapInteraction){var o,s;const t=this.props.snapConfig!==e.snapConfig,r=(null===(o=this.props.snappingLayerInstance)||void 0===o?void 0:o.id)!==(null===(s=e.snappingLayerInstance)||void 0===s?void 0:s.id),i=!e.snapping&&this.props.snapping,n=e.snapping&&!this.props.snapping;n&&this.activateSnapInteraction(),i&&this.deactivateSnapInteraction(),(n||r||t)&&this.addSnapInteraction(e)}else e.snapping&&r&&this.addSnapInteraction(e)})),ge(this,"activateSnapInteraction",(()=>{var e;null===(e=this.snapInteraction)||void 0===e||e.setActive(!0)})),ge(this,"deactivateSnapInteraction",(()=>{var e;null===(e=this.snapInteraction)||void 0===e||e.setActive(!1)})),ge(this,"removeSnapInteraction",(()=>{this.snapInteraction&&(this.props.map.removeInteraction(this.snapInteraction),this.snapInteraction=null),this.snapLayer&&this.props.map.removeLayer(this.snapLayer)})),ge(this,"removeInteractions",(()=>{this.removeDrawInteraction(),this.removeSnapInteraction(),this.selectInteraction&&(this.props.map.enableEventListener("singleclick"),this.props.map.removeInteraction(this.selectInteraction)),this.modifyInteraction&&(this.props.map.removeInteraction(this.modifyInteraction),this.props.map.un("singleclick")),this.translateInteraction&&this.props.map.removeInteraction(this.translateInteraction)})),ge(this,"clean",(e=>{e||this.removeInteractions(),this.drawLayer&&(this.props.map.removeLayer(this.drawLayer),this.geojson=null,this.drawLayer=null,this.drawSource=null)})),ge(this,"fromOLFeature",((e,t,r)=>{const o=e.getGeometry(),s=this.props.map.getView().getProjection().getCode(),i=o.getType();if(o.getCoordinates){const r=o.getExtent(),a=o.getProperties(),p=a&&a.geodesicCenter||(0,le.qg)(r);let c,l=o.getCoordinates();if(t&&(l=n()(t,l),o.setCoordinates(l)),"Circle"===this.props.drawMethod)if(this.props.options.geodesic){const e=[[...p],[...l[0][0]]].map((e=>this.reprojectCoordinatesToWGS84(e,s)));c=(0,j.calculateDistance)(e,"haversine")}else c=this.calculateRadius(p,l);return E()({},{id:e.get("id"),type:i,extent:r,center:p,coordinates:l,radius:c,style:this.fromOlStyle(e.getStyle()),projection:this.getMapCrs()})}let a=o.getGeometries().map(((o,i)=>{const a=o.getExtent(),p=(0,le.qg)(a);let c,l=o.getCoordinates();if(t&&(l=n()(t,l),o.setCoordinates(l)),r.circles&&-1!==r.circles.indexOf(i))if(this.props.options.geodesic){const e=[[...p],[...l[0][0]]].map((e=>this.reprojectCoordinatesToWGS84(e,s)));c=(0,j.calculateDistance)(e,"haversine")}else c=this.calculateRadius(p,l);else c=0;return E()({},{id:e.get("id"),type:o.getType(),extent:a,center:p,coordinates:l,radius:c,style:this.fromOlStyle(e.getStyle()),projection:this.getMapCrs()})}));return E()({},{type:"Feature",id:e.get("id"),style:this.fromOlStyle(e.getStyle()),geometry:{type:"GeometryCollection",geometries:a},projection:s})})),ge(this,"reprojectCoordinatesToWGS84",((e,t)=>{let r=(0,j.reproject)(e,t,"EPSG:4326");return[r.x,r.y]})),ge(this,"toOlFeature",(e=>p()(this.drawSource.getFeatures().filter((t=>t.get("id")===e.id))))),ge(this,"fromOlStyle",(e=>e?{fillColor:this.rgbToHex(e.getFill().getColor()),fillTransparency:e.getFill().getColor()[3],strokeColor:e.getStroke().getColor(),strokeWidth:e.getStroke().getWidth(),text:e.getText().getText()}:{})),ge(this,"toOlStyle",((e,t,r)=>{let o=e&&e.fillColor?e.fillColor:[255,255,255,.2];"string"==typeof o&&(o=this.hexToRgb(o).concat([e.fillOpacity>=0&&e.fillOpacity<=1?e.fillOpacity:1])),e&&e.fillTransparency&&(o[3]=e.fillTransparency);let s=e&&(e.strokeColor||e.color)?e.strokeColor||e.color:"#ffcc33";t&&(s="#4a90e2"),s=this.hexToRgb(s).concat([e&&e.opacity||1]);let i=new Y.default({fill:new ee.default({color:o}),stroke:new Q.default({color:s,width:e&&(e.strokeWidth||e.weight)?e.strokeWidth||e.weight:2}),text:new te.default({text:e&&e.text?e.text:"",fill:new ee.default({color:e&&(e.strokeColor||e.color)?e.strokeColor||e.color:"#000"}),stroke:new Q.default({color:"#fff",width:2}),font:e&&e.fontSize?e.fontSize+"px helvetica":""})});return"GeometryCollection"===r?[...(0,W.EC)({style:{iconGlyph:"comment",iconShape:"square",iconColor:"blue"}}),i]:e&&(e.iconUrl||e.iconGlyph)?(0,W.EC)({style:e}):i})),ge(this,"hexToRgb",(e=>{const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(e,t,r,o){return t+t+r+r+o+o})));return t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]:null})),ge(this,"componentToHex",(e=>{var t=e.toString(16);return 1===t.length?"0"+t:t})),ge(this,"rgbToHex",(e=>"#"+this.componentToHex(e[0])+this.componentToHex(e[1])+this.componentToHex(e[2]))),ge(this,"addModifyInteraction",(e=>{this.modifyInteraction&&this.props.map.removeInteraction(this.modifyInteraction);const t=e&&e.options&&e.options.editFilter;this.modifyFeatureColl=new oe.Z(S()(this.drawLayer.getSource().getFeatures(),t)),this.modifyInteraction=new ae.Z({features:this.modifyFeatureColl,condition:e=>(0,se.Xp)(e)&&!(0,se.Ko)(e)}),this.modifyInteraction.on("modifyend",(e=>{let t=e.features.getArray().map((e=>{let t=e.clone();if(t.getGeometry&&"GeometryCollection"===t.getGeometry().getType()&&t.getGeometry().setGeometries(this.replaceCirclesWithPolygons(t)),t.getGeometry&&t.getGeometry()&&"Circle"===t.getGeometry().getType()){let r=(0,j.reproject)(t.getGeometry().getCenter(),this.getMapCrs(),"EPSG:4326"),o=t.getGeometry().getRadius();t.setProperties({center:[r.x,r.y],radius:o}),e.setProperties({center:[r.x,r.y],radius:o}),t=this.replaceCircleWithPolygon(t.clone())}return(0,j.reprojectGeoJson)(ye.writeFeatureObject(t),this.getMapCrs(),"EPSG:4326")}));this.props.options.transformToFeatureCollection?this.props.onDrawingFeatures(t):this.props.onGeometryChanged(t,this.props.drawOwner,!1,"editing","editing")})),this.props.map.addInteraction(this.modifyInteraction)})),ge(this,"addTranslateInteraction",(()=>{this.translateInteraction&&this.props.map.removeInteraction(this.translateInteraction),this.translateInteraction=new ne.Z({features:new oe.Z(this.drawLayer.getSource().getFeatures())}),this.translateInteraction.setActive(!1),this.translateInteraction.on("translateend",(e=>{let t=e.features.getArray().map((e=>{let t=e.clone();if(t.getGeometry&&"GeometryCollection"===t.getGeometry().getType()&&t.getGeometry().setGeometries(this.replaceCirclesWithPolygons(t)),t.getGeometry&&t.getGeometry()&&"Circle"===t.getGeometry().getType()){let e=(0,j.reproject)(t.getGeometry().getCenter(),this.getMapCrs(),"EPSG:4326"),r=t.getGeometry().getRadius();t.setProperties({center:[e.x,e.y],radius:r}),t=this.replaceCircleWithPolygon(t)}return e.getProperties()&&e.getProperties().selected&&this.props.onSelectFeatures([(0,j.reprojectGeoJson)(ye.writeFeatureObject(t),this.getMapCrs(),"EPSG:4326")]),(0,j.reprojectGeoJson)(ye.writeFeatureObject(t),this.getMapCrs(),"EPSG:4326")}));this.props.options.transformToFeatureCollection?this.props.onDrawingFeatures(t):this.props.onGeometryChanged(t,this.props.drawOwner,this.props.drawOwner,!1,"Text"===this.props.drawMethod,"Circle"===this.props.drawMethod)})),this.addTranslateListener(),this.props.map.addInteraction(this.translateInteraction)})),ge(this,"createOLGeometry",(e=>{let{type:t,coordinates:r,radius:o,center:s,geometries:i,projection:n,options:a={}}=e;return"GeometryCollection"===t?i&&i.length?new $.default(i.map((e=>this.olGeomFromType({type:e.type})))):new $.default([]):this.olGeomFromType({type:t,coordinates:r,radius:o,center:s,projection:n,options:a})})),ge(this,"olGeomFromType",(e=>{let t,{type:r,coordinates:o,radius:s,center:i,projection:n,options:a}=e;switch(r){case"Point":case"Marker":case"Text":t=new _.Z(o||[]);break;case"LineString":t=new K.Z(o||[]);break;case"MultiPoint":t=new B.Z(o||[]);break;case"MultiLineString":t=new U.Z(o||[]);break;case"MultiPolygon":t=new z.Z(o||[]);break;default:{let e=m()(i)?{x:i[0],y:i[1]}:i;const r=n&&!isNaN(parseFloat(s))&&e&&!G()(e.x)&&!G()(e.y)&&!isNaN(parseFloat(e.x))&&!isNaN(parseFloat(e.y));t=r?a.geodesic?(0,q.iu)(this.reprojectCoordinatesToWGS84([e.x,e.y],n),s,100).clone().transform("EPSG:4326",n):(0,q.Bb)(new X.Z([e.x,e.y],s),100):new q.ZP(o&&m()(o[0])?o:[]),t&&r&&a.geodesic&&t.setProperties({geodesicCenter:[e.x,e.y]},!0)}}return t})),ge(this,"convertGeometryTypeToStyleType",(e=>"BBOX"===e?"LineString":e)),ge(this,"appendToMultiGeometry",((e,t,r)=>{switch(e){case"MultiPoint":t.appendPoint(r);break;case"MultiLineString":t.appendLineString(r);break;case"MultiPolygon":{let e=r.getCoordinates();e[0].push(e[0][0]),r.setCoordinates(e),t.appendPolygon(r);break}}})),ge(this,"calculateRadius",((e,t)=>m()(t)&&m()(t[0])&&m()(t[0][0])?Math.sqrt(Math.pow(e[0]-t[0][0][0],2)+Math.pow(e[1]-t[0][0][1],2)):100)),ge(this,"polygonFromCircle",(function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100;return(0,q.Bb)(new X.Z(e,t),r)})),ge(this,"polygonCoordsFromCircle",(function(t,r){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100;return e.polygonFromCircle(t,r,o).getCoordinates()})),ge(this,"replaceCirclesWithPolygonsInFeatureColl",(e=>e.map((e=>"Circle"!==e.getGeometry().getType()?e:this.replaceCircleWithPolygon(e))))),ge(this,"replaceCircleWithPolygon",(e=>{if(e.getProperties().isCircle&&"Circle"===e.getGeometry().getType()){const t=e.getGeometry().getCenter(),r=e.getGeometry().getRadius();return e.setGeometry(this.polygonFromCircle(t,r)),e}return e})),ge(this,"replaceCirclesWithPolygons",(e=>e.getGeometry&&!e.getGeometry().getGeometries?e:e.getGeometry().getGeometries().map(((t,r)=>{if("Circle"!==t.getType())return t;if(e.getProperties()&&e.getProperties().circles&&-1!==e.getProperties().circles.indexOf(r)){const e=t.getCenter(),r=t.getRadius();return this.polygonFromCircle(e,r)}return t})))),ge(this,"replacePolygonsWithCircles",(e=>e.getGeometry().getGeometries().map(((t,r)=>{if("Polygon"!==t.getType())return t;if(e.getProperties()&&e.getProperties().circles&&-1!==e.getProperties().circles.indexOf(r)){const e=t.getExtent(),r=(0,le.qg)(e),o=this.calculateRadius(r,t.getCoordinates());return new X.Z(r,o)}return t})))),ge(this,"addTranslateListener",(()=>{document.addEventListener("keydown",(e=>{e.altKey&&"AltLeft"===e.code&&this.translateInteraction.setActive(!0)})),document.addEventListener("keyup",(e=>{"AltLeft"===e.code&&this.translateInteraction.setActive(!1)}))}))}UNSAFE_componentWillReceiveProps(e){if(this.drawLayer&&this.updateFeatureStyles(e.features),!e.drawStatus&&this.selectInteraction&&this.selectInteraction.getFeatures().clear(),this.props.drawStatus!==e.drawStatus||this.props.drawMethod!==e.drawMethod||this.props.features!==e.features)switch(e.drawStatus){case"create":this.addLayer(e);break;case"start":this.addInteractions(e);break;case"drawOrEdit":this.addDrawOrEditInteractions(e);break;case"stop":this.removeDrawInteraction();break;case"replace":this.replaceFeatures(e);break;case"updateStyle":this.updateOnlyFeatureStyles(e);break;case"clean":this.clean();break;case"cleanAndContinueDrawing":this.clean(!0);break;case"endDrawing":this.endDrawing(e)}this.updateSnapInteraction(e)}render(){return null}}ge(me,"propTypes",{map:x().object,drawOwner:x().string,drawStatus:x().string,drawMethod:x().string,options:x().object,features:x().array,onChangeDrawingStatus:x().func,onGeometryChanged:x().func,onDrawStopped:x().func,onDrawingFeatures:x().func,onSelectFeatures:x().func,onEndDrawing:x().func,style:x().object,snapping:x().bool,snappingLayer:x().object,snappingLayerInstance:x().object,isSnappingLoading:x().bool,snapConfig:x().object,onRefreshSnappingLayer:x().func,toggleSnappingIsLoading:x().func}),ge(me,"defaultProps",{map:null,drawOwner:null,drawStatus:null,drawMethod:null,features:null,options:{stopAfterDrawing:!0},onChangeDrawingStatus:()=>{},onGeometryChanged:()=>{},onDrawStopped:()=>{},onDrawingFeatures:()=>{},onSelectFeatures:()=>{},onEndDrawing:()=>{}})},993847:(e,t,r)=>{"use strict";r.d(t,{Z:()=>y});var o=r(124852),s=r.n(o),i=r(180307),n=r.n(i),a=r(45697),p=r.n(a),c=r(193409),l=r(747037),d=r.n(l),h=r(39600),u=r(492619);function g(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class y extends s().Component{constructor(){super(...arguments),g(this,"onPopupClose",(e=>{this.props.onPopupClose(e)})),g(this,"renderPopups",(()=>this.preparePopups().map((e=>{let{popup:t,id:r,component:o,content:i,props:a,containerStyle:p}=e;const c=t.getElement(),l=d()(o)&&u.default[o]||o;let g;return l?g=s().isValidElement(l)&&l||s().createElement(l,a):i&&(g=h.FP(i)?s().createElement("div",{dangerouslySetInnerHTML:{__html:i}}):i),c&&n().createPortal(s().createElement("div",{className:"map-popup-ol",key:r,onMouseUp:this.convertToClick},s().createElement("div",{className:"ol-popup-content-wrapper"},s().createElement("div",{className:"ol-popup-content",style:p},g)),s().createElement("div",{className:"ol-popup-closer",onClick:()=>this.onPopupClose(r)},"x")),c)})))),g(this,"update",(()=>{(this._popups||[]).map((e=>{let{popup:t}=e;t.setElement(t.getElement())}))})),g(this,"convertToClick",(e=>{const t=new MouseEvent("click",{bubbles:!0});t.stopPropagation=()=>{},e.target.dispatchEvent(t)})),g(this,"preparePopups",(()=>{const{popups:e=[],map:t}=this.props,r=t.getSize();return(this._popups||[]).forEach((e=>{let{popup:r,observer:o}=e;o&&o.disconnect(),r&&t.removeOverlay(r)})),this._popups=e.map((e=>{const o=20,s=Math.round(.9*r[0])-2*o,i=Math.round(.9*r[1])-2*o,{id:n,position:{coordinates:a},className:p,maxWidth:l=s,maxHeight:d=i,autoPan:u=!1,autoPanMargin:g=o,offset:y=[0,0],autoPanAnimation:m={duration:200}}=e,w=l>s?s:l,f=d>i?i:d,C=h.fH(n,p),S=new c.Z({id:n,element:C,autoPan:u,offset:y,autoPanMargin:g,autoPanAnimation:m,positioning:"bottom-center",className:"ol-overlay-container ol-unselectable",position:a});t.addOverlay(S);const P=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=new MutationObserver((()=>{e.getMap().getSize()&&(e.setPosition(void 0),e.setPosition(r.coordinates))}));return o.observe(t,{attributes:!0,childList:!0,subtree:!0}),o}(S,C,{coordinates:a});return{popup:S,observer:P,containerStyle:{maxWidth:w,maxHeight:f},...e}})),this._popups})),g(this,"stopPropagationOnPointerMove",(e=>{e.stopPropagation()}))}UNSAFE_componentWillMount(){this.props.map&&this.props.map.getOverlayContainerStopEvent().addEventListener("pointermove",this.stopPropagationOnPointerMove)}shouldComponentUpdate(e){let{popups:t}=e;return t!==this.props.popups}componentWillUnmount(){this.props.map&&this.props.map.getOverlayContainerStopEvent().removeEventListener("pointermove",this.stopPropagationOnPointerMove)}render(){return s().createElement("div",null,this.renderPopups())}}g(y,"propTypes",{map:p().object,popups:p().arrayOf(p().object),onPopupClose:p().func}),g(y,"defaultProps",{popups:[],onPopupClose:()=>{}})},492619:(e,t,r)=>{"use strict";r.r(t),r.d(t,{IDENTIFY_POPUP:()=>G,default:()=>I});var o=r(124852),s=r.n(o),i=r(554155),n=r(306637),a=r(867076),p=r(171703),c=r(22222),l=r(975872),d=r(917450),h=r(765963),u=r(701469),g=r.n(u),y=r(352353),m=r.n(y),w=r(105198),f=r(274363);const C=(0,a.compose)((0,p.connect)((0,c.P1)(l.Qf,(e=>({index:e}))),{setIndex:d.oO}),(0,a.defaultProps)({index:0,responses:[]})),S=(0,c.P1)([l.q7,l.o9,l.OK,l.us,l.x0,f.hp,l.vR],((e,t,r,o,s,i,n)=>({responses:e,validResponses:t,requests:r,format:o,showEmptyMessageGFI:s,missingResponses:(r||[]).length-(e||[]).length,renderValidOnly:i,loaded:n}))),P=(0,a.compose)((0,p.connect)(S),(0,a.defaultProps)({responses:[],container:e=>{let{index:t,children:r}=e;return s().createElement(s().Fragment,null,g()(r)&&r[t]||r)},header:w.Z}),C,n.Yy,n.mI,(0,i.Z)((e=>{let{loaded:t}=e;return m()(t)})))(h.Z),G="identify",I={identify:P}},39600:(e,t,r)=>{"use strict";r.d(t,{fH:()=>i,FP:()=>n,R3:()=>a});var o=r(455877),s=r.n(o);const i=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s()(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ms-map-popup";const r=document.createElement("div");return r.setAttribute("id",e+"-map-popup"),r.setAttribute("class",t),r},n=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.startsWith("<")},a=(e,t)=>{if(!t)return e;if(t instanceof Node){const r=document.createDocumentFragment();r.appendChild(t),e.appendChild(r)}else n(t)?e.innerHTML=t:e.append(document.createTextNode(String(t)));return e}},847529:(e,t,r)=>{"use strict";r.d(t,{ox:()=>p,dV:()=>c,k4:()=>l,aj:()=>h});var o=r(701469),s=r.n(o),i=r(351546),n=r(421915),a=r(869669);const p="VECTOR",c="TILE",l="IMAGE",d=(e,t,r,o)=>{if(s()(t)&&s()(t[0])&&s()(t[0][0])){const s=(0,i.reproject)(t[0][0],o,r);return Math.sqrt(Math.pow(e[0]-s.x,2)+Math.pow(e[1]-s.y,2))}return 100},h=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;if(!e.getGeometry()||"Polygon"!==e.getGeometry().getType()||e.getProperties().center&&0===e.getProperties().center.length)return e;if(e.getProperties()&&e.getProperties().isCircle&&e.getProperties().center&&e.getProperties().center[0]&&e.getProperties().center[1]){const o=e.getGeometry().getExtent();let s;e.getProperties().center?(s=(0,i.reproject)(e.getProperties().center,"EPSG:4326",t),s=[s.x,s.y]):s=(0,n.qg)(o);const p=e.getProperties().crs===t?e.getProperties().radius:d(s,e.getGeometry().getCoordinates(),t,r);return e.setGeometry(new a.Z(s,p)),e}return e}}}]);