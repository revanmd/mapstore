(self.webpackChunkmapstore2=self.webpackChunkmapstore2||[]).push([[7330],{430856:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>V});var n=o(218721),a=o.n(n),s=o(264721),r=o.n(s),l=o(103651),i=o.n(l),c=o(727418),d=o.n(c),p=o(45697),u=o.n(p),h=o(124852),g=o.n(h),m=o(630294),v=o(152543),y=o(22222);const f="CHANGE_CRS_INPUT_VALUE";var w=o(859518),S=o(504518),C=o(804504),b=o(719648);function E(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}class R extends g().Component{constructor(){super(...arguments),E(this,"handleChange",(e=>{this.props.changeInputValue(e.target.value)}))}render(){const{children:e}=this.props;return g().createElement("div",{className:"dropdown-menu",style:{left:"auto",right:0}},g().createElement(m.ListGroupItem,{className:"ms-prj-header",bsSize:"sm"},g().createElement("div",null,g().createElement(C.Z,{msgId:"crsSelectorSelectedCRS"})),g().createElement("div",null,this.props.selected)),g().createElement(m.ListGroup,{style:{maxHeight:150,overflowY:"auto",marginBottom:0}},e.filter((e=>!this.props.value.trim()||-1!==e.props.children.indexOf(this.props.value)))),g().createElement(m.FormControl,{ref:e=>{this.input=e},type:"text",placeholder:(0,b.S$)(this.context.messages,"crsSelectorFilterPlaceholder"),onChange:this.handleChange,value:this.props.value}))}}E(R,"propTypes",{selected:u().string,value:u().string,changeInputValue:u().func}),E(R,"contextTypes",{messages:u().object}),E(R,"defaultProps",{value:"",changeInputValue:()=>{}});const P=R;var M=o(36549);var j=o(30206),G=o(119008),I=o(820709),U=o(612912),k=o(274363),A=o(350126),T=o(101092),x=o(510644),D=o(351546),L=o(23888);function F(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}const O=(0,M.Z)(L.Z);class B extends g().Component{constructor(){super(...arguments),F(this,"state",{toggled:!1})}render(){let e=[],t={};Object.keys(this.props.availableCRS).length&&(t=(0,D.filterCRSList)(this.props.availableCRS,this.props.filterAllowedCRS,this.props.additionalCRS,this.props.projectionDefs));for(let o in t)t.hasOwnProperty(o)&&e.push({value:o});const o=(0,D.normalizeSRS)(this.props.selected,this.props.filterAllowedCRS),n=["EPSG:4326","EPSG:3857","EPSG:900913"],s=["wms","osm","tileprovider","empty"],l=e=>{i()(n,e)>-1||i()(s,this.props.currentBackground.type)>-1||this.props.currentBackground.allowedSRS&&a()(this.props.currentBackground.allowedSRS,e)?this.props.setCrs(e):this.props.onError({title:"error",message:"notification.incompatibleBackgroundAndProjection",action:{label:"close"},position:"tc",uid:"3"})},c=r()(this.props.allowedRoles,"ALL")||r()(this.props.allowedRoles,this.props.currentRole);return this.props.enabled&&c?g().createElement(m.Dropdown,{dropup:!0,className:"ms-prj-selector",onToggle:e=>this.setState({toggled:e})},g().createElement(O,{bsRole:"toggle",bsStyle:"primary",className:"map-footer-btn btn-"+(this.state.toggled?"success":"primary"),tooltip:g().createElement(C.Z,{msgId:"showCrsSelector"}),tooltipPosition:"top"},g().createElement(m.Glyphicon,{glyph:"crs"})),g().createElement(P,{bsRole:"menu",value:this.props.value,selected:o,projectionDefs:this.props.projectionDefs,filterAllowedCRS:this.props.filterAllowedCRS,additionalCRS:this.props.additionalCRS,changeInputValue:e=>this.props.typeInput(e)},e.map((e=>g().createElement(m.ListGroupItem,{key:e.value,active:o===e.value,onClick:e=>l(e.target.textContent),eventKey:e.value},e.value))))):null}}F(B,"propTypes",{selected:u().string,value:u().string,projections:u().array,availableCRS:u().object,filterAllowedCRS:u().array,projectionDefs:u().array,additionalCRS:u().object,setCrs:u().func,typeInput:u().func,enabled:u().bool,currentBackground:u().object,onError:u().func,allowedRoles:u().array,currentRole:u().string}),F(B,"defaultProps",{availableCRS:(0,D.getAvailableCRS)(),setCrs:()=>{},typeInput:()=>{},enabled:!0,allowedRoles:["ALL"]});const N=(0,v.$j)((0,y.P1)(x.L3,U.DP,k.uy,k.pb,(e=>e&&e.crsselector&&e.crsselector.value),I.eK,T.c0,A.VM,G.QF,G._d,G.h,j.cM,((e,t,o,n,a,s,r,l,i,c,d,p)=>({currentRole:e,currentBackground:t,selected:o,projectionDefs:n,value:a,enabled:!("EDIT"===s||r||l||i||c||d||p)}))),{typeInput:function(e){return{type:f,value:e}},setCrs:w.NH,onError:S.vU})(B),V={CRSSelectorPlugin:d()(N,{disablePluginIf:"{state('mapType') === 'leaflet'}",MapFooter:{name:"crsSelector",position:10,tool:!0,priority:1}}),reducers:{crsselector:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{projections:[]},t=arguments.length>1?arguments[1]:void 0;return t.type===f?d()({},e,{value:t.value}):e}},epics:{}}},30206:(e,t,o)=>{"use strict";o.d(t,{sB:()=>m,_o:()=>v,cM:()=>P,Cq:()=>V,cQ:()=>Q,dm:()=>z});var n=o(22222),a=o(612912),s=o(274363),r=o(101092),l=o(975872),i=o(91175),c=o.n(i),d=o(227361),p=o.n(d),u=o(727418),h=o.n(u),g=o(234228);const m=(0,n.P1)([a.l2],(e=>c()(e.filter((e=>"annotations"===e.id))))),v=e=>p()(e,"annotations.config.multiGeometry",!1),y=e=>p()(e,"annotations.removing"),f=e=>p()(e,"annotations.format"),w=e=>p()(e,"annotations.aeronauticalOptions"),S=e=>p()(e,"annotations.showUnsavedChangesModal",!1),C=e=>p()(e,"annotations.showUnsavedStyleModal",!1),b=e=>p()(e,"annotations.showUnsavedGeometryModal",!1),E=e=>p()(e,"annotations.showDeleteFeatureModal",!1),R=e=>!!p()(e,"annotations.closing"),P=e=>p()(e,"annotations.editing"),M=e=>p()(e,"annotations.editGeometry",!0),j=e=>p()(e,"annotations.featureType"),G=e=>p()(e,"annotations.coordinateEditorEnabled"),I=e=>!!p()(e,"annotations.drawing"),U=e=>p()(e,"annotations.stylerType"),k=e=>p()(e,"annotations.drawingText"),A=e=>p()(e,"annotations.editedFields",{}),T=e=>!!p()(e,"annotations.styling"),x=e=>p()(e,"annotations.selected",null),D=e=>p()(e,"annotations.unsavedChanges",!1),L=e=>p()(e,"annotations.unsavedGeometry",!1),F=e=>p()(e,"annotations.unsavedStyle",!1),O=e=>p()(e,"annotations.validationErrors",{}),B=e=>p()(e,"annotations.config",{}),N=e=>p()(e,"annotations.symbolList",[]),V=e=>p()(e,"annotations.symbolErrors",[]),_=e=>(P(e)?"editing":m(e)&&(e=>p()(e,"annotations.current"))(e)&&"detail")||"list",H=e=>p()(e,"annotations.showAgain",!1),Z=e=>p()(e,"annotations.showPopupWarning",!0),Q=e=>h()({},{symbolErrors:V(e),showEdit:(0,r.m6)(e),canEdit:M(e),mouseHoverEvents:(0,l.Qp)(e),closing:R(e),format:f(e)||(0,g.u8)("defaultCoordinateFormat"),aeronauticalOptions:w(e),config:B(e),drawing:I(e),drawingText:k(e),errors:O(e),editing:P(e),coordinateEditorEnabled:G(e),editedFields:A(e),mode:_(e),selected:x(e),featureType:j(e),removing:y(e),mapProjection:(0,s.uy)(e),showUnsavedChangesModal:S(e),showDeleteFeatureModal:E(e),showUnsavedGeometryModal:b(e),showUnsavedStyleModal:C(e),stylerType:U(e),styling:T(e),unsavedChanges:D(e),unsavedGeometry:L(e),unsavedStyle:F(e),symbolList:N(e),showAgain:H(e),showPopupWarning:Z(e)}),z=(0,n.P1)([Q,e=>({...e.annotations||{}}),m,_],((e,t,o,n)=>h()({},{format:t.format,aeronauticalOptions:t.aeronauticalOptions,removing:t.removing,showUnsavedChangesModal:t.showUnsavedChangesModal,showUnsavedGeometryModal:t.showUnsavedGeometryModal,showUnsavedStyleModal:t.showUnsavedStyleModal,showDeleteFeatureModal:t.showDeleteFeatureModal,closing:!!t.closing,mode:n,annotations:o&&o.features||[],current:t.current||null,editing:e.editing,selected:e.selected,filter:t.filter||"",defaultStyles:t.defaultStyles,loading:t.loading},e.config?{config:e.config}:{})));(0,n.P1)([z],(e=>{const t=e.current;return{annotation:c()(e.annotations.filter((e=>e.properties.id===t)))}}))},103651:(e,t,o)=>{var n=o(442118),a=o(640554),s=Math.max;e.exports=function(e,t,o){var r=null==e?0:e.length;if(!r)return-1;var l=null==o?0:a(o);return l<0&&(l=s(r+l,0)),n(e,t,l)}}}]);