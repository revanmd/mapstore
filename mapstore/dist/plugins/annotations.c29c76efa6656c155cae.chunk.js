(self.webpackChunkmapstore2=self.webpackChunkmapstore2||[]).push([[9972],{768977:(e,t,o)=>{"use strict";o.d(t,{Z:()=>h});var n=o(45697),s=o.n(n),r=o(124852),a=o.n(r),i=o(630294),l=o(222777);function p(){return p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},p.apply(this,arguments)}function d(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}class c extends a().Component{render(){const{cardComponent:e,items:t,colProps:o,onItemClick:n,size:s}=this.props,r=e||l.Z;return a().createElement("div",{className:"msSideGrid"+(this.props.className?" "+this.props.className:"")},a().createElement(i.Row,{className:"items-list"},t.map(((e,t)=>a().createElement(i.Col,p({key:e.id||t},o),a().createElement(r,p({onClick:function(){for(var t=arguments.length,o=new Array(t),s=0;s<t;s++)o[s]=arguments[s];return n(e,...o)},size:s},e)))))))}}d(c,"propTypes",{size:s().string,onItemClick:s().func,colProps:s().object,items:s().array,cardComponent:s().oneOfType([s().string,s().func]),className:s().string}),d(c,"defaultProps",{size:"",onItemClick:()=>{},colProps:{xs:12},className:"",items:[]});const h=c},670186:(e,t,o)=>{"use strict";o.d(t,{Z:()=>u});var n=o(124852),s=o.n(n),r=o(45697),a=o.n(r),i=o(747037),l=o.n(i),p=o(366757),d=o.n(p),c=o(119950);function h(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}class m extends s().Component{constructor(){super(...arguments),h(this,"paint",(e=>{e.save(),e.beginPath();const{color:t,fill:o}=this.props.shapeStyle;switch(e.fillStyle=o?l()(o)?o:`rgba(${o.r}, ${o.g}, ${o.b}, ${o.a})`:null,e.strokeStyle=t?l()(t)?t:`rgba(${t.r}, ${t.g}, ${t.b}, ${t.a})`:null,e.lineWidth=this.props.shapeStyle.width||this.props.shapeStyle.weight,this.props.shapeStyle.dashArray&&this.props.shapeStyle.dashArray.length&&e.setLineDash(this.props.shapeStyle.dashArray),this.props.geomType){case"Polygon":this.paintPolygon(e);break;case"Polyline":this.paintPolyline(e);break;case"Point":this.paintPoint(e,this.props.shapeStyle.markName);break;case"Circle":this.paintPoint(e,"circle");break;case"Marker":this.paintMarker(e);break;case"Text":this.paintText(e);break;case"Symbol":this.paintSymbol(e);break;default:return}e.restore()})),h(this,"drawSymbol",((e,t)=>{t.clearRect(0,0,600,600);let n=new Image,s=new Image;s.src=o(264372),n.src=e||this.props.shapeStyle.symbolUrl,n.onload=()=>{try{t.drawImage(n,this.props.width/2-n.width/2,this.props.height/2-n.height/2)}catch(e){return}},n.onerror=()=>{s.onload=()=>{try{t.drawImage(s,this.props.width/2-s.width/2,this.props.height/2-s.height/2)}catch(e){return}}}})),h(this,"paintSymbol",(e=>{(0,c.isSymbolStyle)(this.props.originalStyle)?this.props.originalStyle.symbolUrlCustomized&&this.props.originalStyle.symbolUrl?this.drawSymbol(this.props.originalStyle.symbolUrlCustomized,e):(0,c.createSvgUrl)(this.props.originalStyle,this.props.originalStyle.symbolUrlCustomized||this.props.originalStyle.symbolUrl).then((t=>this.drawSymbol(t,e))):this.drawSymbol(null,e)})),h(this,"paintText",(e=>{const{width:t,height:o}=this.props,{textAlign:n="center",label:s,font:r="14px Arial"}=this.props.shapeStyle;return e.textAlign=n,e.font=r,"start"===n?(e.strokeText(s||"New",t/2.5,o/2),void e.fillText(s||"New",t/2.5,o/2)):"end"===n?(e.strokeText(s||"New",t/1.5,o/2),void e.fillText(s||"New",t/1.5,o/2)):(e.strokeText(s||"New",t/2,o/2),void e.fillText(s||"New",t/2,o/2))})),h(this,"paintPolygon",(e=>{e.transform(1,0,0,1,-27.5,0),e.moveTo(55,8),e.lineTo(100,8),e.lineTo(117.5,40),e.lineTo(100,72),e.lineTo(55,72),e.lineTo(37.5,40),e.closePath(),e.fill(),e.stroke()})),h(this,"paintPolyline",(e=>{e.transform(1,0,0,1,0,0),e.moveTo(10,20),e.bezierCurveTo(40,40,70,0,90,20),e.stroke()})),h(this,"paintPoint",((e,t)=>{let o=this.props.shapeStyle.radius,n=o/2;switch(t){case"square":e.rect(50-n,48.5-n,o,o);break;case"circle":e.arc(50,48.5,n,0,2*Math.PI);break;case"triangle":{let t=Math.sqrt(3)*o/2/3;e.moveTo(50,48.5-2*t),e.lineTo(50+n,48.5+t),e.lineTo(50-n,48.5+t),e.closePath();break}case"star":this.paintStar(e,50,48.5,5,n,n/2);break;case"cross":this.paintCross(e,50,48.5,o,.23);break;case"x":e.translate(50,48.5),e.rotate(45*Math.PI/180),e.translate(-50,-48.5),this.paintCross(e,50,48.5,o,.23);break;default:e.arc(50,48.5,o,0,2*Math.PI)}e.fill(),e.stroke()})),h(this,"paintMarker",(e=>{let t=new Image;t.src=d();try{e.drawImage(t,42.5,24)}catch(e){return}})),h(this,"paintStar",(function(e,t,o){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,s=arguments.length>4?arguments[4]:void 0,r=arguments.length>5?arguments[5]:void 0,a=Math.PI/2*3,i=t,l=o;const p=Math.PI/n;e.moveTo(t,o-s);for(let d=0;d<n;d++)i=t+Math.cos(a)*s,l=o+Math.sin(a)*s,e.lineTo(i,l),a+=p,i=t+Math.cos(a)*r,l=o+Math.sin(a)*r,e.lineTo(i,l),a+=p;e.lineTo(t,o-s),e.closePath()})),h(this,"paintCross",((e,t,o,n,s)=>{const r=n*s/2,a=n/2;e.moveTo(t-r,o-a),e.lineTo(t+r,o-a),e.lineTo(t+r,o-r),e.lineTo(t+a,o-r),e.lineTo(t+a,o+r),e.lineTo(t+r,o+r),e.lineTo(t+r,o+a),e.lineTo(t-r,o+a),e.lineTo(t-r,o+r),e.lineTo(t-a,o+r),e.lineTo(t-a,o-r),e.lineTo(t-r,o-r),e.closePath()}))}componentDidMount(){let e=this.refs.styleCanvas.getContext("2d");e.clearRect(0,0,this.props.width||500,this.props.height||500),this.paint(e)}componentDidUpdate(){let e=this.refs.styleCanvas.getContext("2d");e.clearRect(0,0,this.props.width||500,this.props.height||500),this.paint(e)}render(){return s().createElement("canvas",{ref:"styleCanvas",style:this.props.style,width:this.props.width,height:this.props.height})}}h(m,"propTypes",{originalStyle:a().object,style:a().object,shapeStyle:a().object,geomType:a().oneOf(["Polygon","Polyline","Point","Marker","Text","Symbol","Circle",void 0]),width:a().number,height:a().number}),h(m,"defaultProps",{originalStyle:{},style:{},shapeStyle:{},geomType:"Polygon",width:100,height:80});const u=m},392021:(e,t,o)=>{"use strict";o.d(t,{Z:()=>h});var n=o(45697),s=o.n(n),r=o(124852),a=o.n(r),i=o(743129),l=o(598611),p=o.n(l);function d(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}class c extends a().Component{constructor(){super(...arguments),d(this,"styleRenderer",((e,t,o)=>{const n=this.props.styleRendererPattern||a().createElement("svg",{style:{height:33,width:"100%"},viewBox:"0 0 300 25"},a().createElement("path",{className:"ms-dash-array",strokeWidth:this.props.defaultStrokeWidth,strokeDasharray:o||e.value,d:"M0 12.5, 300 12.5"}));return a().createElement("div",{style:{display:"flex",alignItems:"center",width:"100%",paddingRight:25}},n)}))}render(){const e=p()(this.props.dashArray||"1 0"," "),t=this.props.options.find((t=>t.value===e))?this.props.options:[{value:e},...this.props.options],o=this.props.creatable?i.ZP.Creatable:i.ZP;return a().createElement(o,{options:t,disabled:this.props.disabled,menuPlacement:this.props.menuPlacement,clearable:this.props.clearable,optionRenderer:this.props.optionRenderer||this.styleRenderer,valueRenderer:this.props.valueRenderer||this.styleRenderer,value:e,isValidNewOption:this.props.isValidNewOption,onChange:e=>{if(e){const t=e.value.split(" ");this.props.onChange(t)}}})}}d(c,"propTypes",{dashArray:s().array,menuPlacement:s().string,clearable:s().bool,value:s().string,optionRenderer:s().func,styleRendererPattern:s().node,valueRenderer:s().func,disabled:s().bool,onChange:s().func,options:s().array,creatable:s().bool,isValidNewOption:s().func,defaultStrokeWidth:s().number}),d(c,"defaultProps",{dashArray:["1","0"],menuPlacement:"top",clearable:!1,onChange:()=>{},options:[{value:"1 0"},{value:"10 50 30"},{value:"6 6"},{value:"20 20"},{value:"30 30"}],defaultStrokeWidth:4});const h=c},173581:(e,t,o)=>{"use strict";o.d(t,{Z:()=>s});var n=o(124852);const s=(0,o(297977).Z)()((0,n.lazy)((()=>Promise.all([o.e(6758),o.e(9715)]).then(o.bind(o,439715)))))},42215:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>vo});var n=o(124852),s=o.n(n),r=o(727418),a=o.n(r),i=o(45697),l=o.n(i),p=o(22222),d=o(441609),c=o.n(d),h=o(152543),m=o(687753),u=o(91175),g=o.n(u),y=o(623560),f=o.n(y),b=o(352353),v=o.n(b),E=o(630294),S=o(173581),C=o(363082),w=o(454295),T=o(804504),x=o(16246),P=o(466737),k=o(8204),O=o(409669),M=o.n(O),F=o(984596),Z=o.n(F),j=o(763105),N=o.n(j),I=o(313311),A=o.n(I),G=o(630998),U=o.n(G),D=o(414293),B=o.n(D),R=o(717621),V=o.n(R),L=o(423570),z=o.n(L),W=o(521923),H=o(119950),_=o(569291),Y=o(670186),$=o(509886),q=o.n($),Q=o(908956),X=o(147814);function J(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}q()();class K extends s().Component{render(){const{style:e}=this.props;return s().createElement("div",null,s().createElement(E.Row,null,s().createElement(E.Col,{xs:12},s().createElement("strong",null,s().createElement(T.Z,{msgId:"draw.fill"})))),s().createElement(E.Row,null,s().createElement(E.Col,{xs:6},s().createElement(T.Z,{msgId:"draw.color"})),s().createElement(E.Col,{xs:6,style:{position:"static"}},s().createElement(X.Z,{color:(0,H.addOpacityToColor)(V()(e.fillColor||this.props.defaultColor).toRgb(),e.fillOpacity),width:this.props.width,onChangeColor:t=>{if(!B()(t)){const o=V()(t).toHexString(),n=t.a;this.props.onChange(e.id,{fillColor:o,fillOpacity:n})}}}))),s().createElement(E.Row,null,s().createElement(E.Col,{xs:6},s().createElement(T.Z,{msgId:"draw.opacity"})),s().createElement(E.Col,{xs:6,style:{position:"static"}},s().createElement(Q.Z,{opacity:e.fillOpacity,onChange:t=>{this.props.onChange(e.id,{fillOpacity:t})}}))))}}J(K,"propTypes",{style:l().object,defaultColor:l().string,onChange:l().func,width:l().number}),J(K,"defaultProps",{style:{},onChange:()=>{}});const ee=K;var te=o(603754),oe=o(424471);function ne(e){let{disabled:t,containerNode:o,onOpen:n,placement:r,children:a,triggerNode:i}=e;const l=t?" ms-disabled":"";return s().createElement(oe.Z,{containerNode:o,placement:r,disabled:t,onOpen:e=>n(e),content:s().createElement("div",{className:"ms-picker-node shadow-soft"},a)},s().createElement("div",{className:`ms-property-picker${l}`},s().createElement("div",{className:"ms-property-picker-swatch",style:{padding:0,boxShadow:"none"}},i)))}ne.propTypes={value:l().oneOfType([l().string,l().shape({r:l().number,g:l().number,b:l().number,a:l().number})]),format:l().string,onChangeColor:l().func,text:l().string,line:l().bool,disabled:l().bool,pickerProps:l().object,containerNode:l().node,onOpen:l().function,placement:l().string},ne.defaultProps={disabled:!1,line:!1,onChangeColor:()=>{},pickerProps:{},onOpen:()=>{}};const se=ne;function re(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}class ae extends s().Component{constructor(){var e;super(...arguments),e=this,re(this,"renderMarkers",(function(t){return t.map((t=>t.markers?e.renderMarkers(t.markers,t.name+"-"):s().createElement("div",{onClick:()=>e.selectStyle(t),className:e.isCurrentStyle(t)?"ms-marker-selected":"",style:{...t.thumbnailStyle}})))})),re(this,"isCurrentStyle",(e=>this.props.markersOptions.markersConfig.matches(this.props.style,e.style))),re(this,"selectStyle",(e=>this.props.onChange(this.props.style.id,{...this.props.markersOptions.markersConfig.getStyle(e.style)}))),re(this,"filterMarkerGlyph",(e=>{var t,o;return e&&-1!==e.toLowerCase().indexOf((null===(t=this.props.markersOptions)||void 0===t||null===(o=t.filter)||void 0===o?void 0:o.toLowerCase())||"")}))}render(){const e=this.props.markersOptions.markers.reduce(((e,t)=>{let{markers:o}=t;return[...e,...o]}),[]).find((e=>this.isCurrentStyle(e)))||{};return s().createElement("div",{className:"marker-container"},s().createElement("div",{className:"marker-icon"},s().createElement("div",{style:{flex:1}},s().createElement(T.Z,{msgId:"draw.marker.icon"})),s().createElement("div",{style:{flex:1}},s().createElement(se,{triggerNode:s().createElement("div",{style:{width:32,height:32,display:"flex",alignItems:"center",justifyContent:"center",fontSize:20,cursor:"pointer",margin:"auto"}},s().createElement("i",{className:`fa fa-${this.props.style.iconGlyph}`}))},s().createElement("div",{className:"ms-marker-icon-content",style:{width:256,height:256,overflow:"auto",position:"relative"}},s().createElement("div",{style:{position:"sticky",top:0}},s().createElement(te.Z,{filterPlaceholder:"Filter icons...",filterText:this.props.markersOptions.filter,onFilter:this.props.markersOptions.onFilterMarker})),s().createElement("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"center"}},this.props.markersOptions.glyphs.map((e=>this.filterMarkerGlyph(e)?s().createElement("div",{className:e===this.props.style.iconGlyph?"ms-marker-selected":"",style:{width:32,height:32,display:"flex",alignItems:"center",justifyContent:"center",fontSize:20,cursor:"pointer"},onClick:()=>{this.props.onChange(this.props.style.id,{iconGlyph:e})}},s().createElement("i",{className:`fa fa-${e}`})):null))))))),s().createElement("div",{className:"marker-shape"},s().createElement("div",{style:{flex:1}},s().createElement(T.Z,{msgId:"draw.marker.shape"})),s().createElement("div",{style:{flex:1}},s().createElement(se,{triggerNode:s().createElement("div",{style:{...e.thumbnailStyle,margin:"auto"}})},s().createElement("div",{className:"ms-marker-shape-content",style:{display:"flex",flexWrap:"wrap",justifyContent:"center",width:256,height:256,overflow:"auto"}},this.renderMarkers(this.props.markersOptions.markers))))))}}re(ae,"propTypes",{style:l().object,markersOptions:l().object,onChange:l().func,width:l().number}),re(ae,"defaultProps",{style:{},onChange:()=>{}});const ie=ae;var le=o(743129);function pe(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}class de extends s().Component{render(){return s().createElement("div",null,s().createElement(E.Row,null,s().createElement(E.Col,{xs:6},s().createElement("strong",null,s().createElement(T.Z,{msgId:"draw.marker.type"}))),s().createElement(E.Col,{xs:6,style:{position:"static"}},s().createElement(le.ZP,{clearable:!1,options:this.props.options,value:this.props.pointType||"marker",onChange:e=>{const t=e&&e.value;this.props.onChangeType(this.props.style.id,t)}}))))}}pe(de,"propTypes",{style:l().object,pointType:l().string,options:l().array,onChangeType:l().func,width:l().number}),pe(de,"defaultProps",{style:{},options:[{label:"Marker",value:"marker"},{label:"Symbol",value:"symbol"}],pointType:"marker",onChangeType:()=>{}});const ce=de;var he=o(701469),me=o.n(he),ue=o(618446),ge=o.n(ue),ye=o(981537);function fe(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}class be extends s().Component{constructor(){super(...arguments),fe(this,"loadSymbolsList",(e=>{const t=this.props.symbolsPath+"symbols.json";M().get(t,{"Content-type":"application/json"}).then((t=>{let{data:o}=t;me()(o)?this.props.onUpdateOptions(o.map((e=>({label:e.label||e.name,value:e.name,symbolUrl:this.props.symbolsPath+e.name+".svg?_t="+Math.random()}))),!0):this.props.onUpdateOptions([{label:e,value:e,symbolUrl:this.props.symbolsPath+e+".svg"}]),this.checkSymbolUrl(this.props),this.props.onChange(this.props.style.id);const n=this.props.symbolErrors.length?N()(this.props.symbolErrors,(e=>"loading_symbols_path"!==e)):[];this.props.onLoadingError(n)})).catch((()=>{(0,C.ZA)(this.props.symbolErrors)||this.props.onLoadingError(this.props.symbolErrors.concat(["loading_symbols_path"]))})),this.forceUpdate()})),fe(this,"checkSymbolUrl",(e=>{let{style:t,symbolErrors:o,onLoadingError:n}=e;M().get(t.symbolUrl).then((()=>{let e=o.length?N()(o,(e=>e!=="loading_symbol"+t.shape)):[];e=e.length?N()(e,(e=>"loading_symbols_path"!==e)):[],n(e)})).catch((()=>{(0,C.ZA)(this.props.symbolErrors,"loading_symbol"+t.shape)||n(o.concat(["loading_symbol"+t.shape]))}))}))}UNSAFE_componentWillMount(){if(me()(this.props.options)&&0===this.props.options.length){const e=this.props.options&&this.props.options.length?A()(this.props.options,(e=>e.value===this.props.defaultShape))&&this.props.defaultShape:C.xw;this.loadSymbolsList(e)}}UNSAFE_componentWillReceiveProps(e){if(ge()(e.style,this.props.style)||this.checkSymbolUrl(e),!ge()(e.symbolErrors,this.props.symbolErrors)){const e=this.props.options&&this.props.options.length?A()(this.props.options,(e=>e.value===this.props.defaultShape))&&this.props.defaultShape:C.xw;this.loadSymbolsList(e)}}render(){const e=e=>s().createElement("div",{style:{display:"flex",alignItems:"center"}},s().createElement("img",{src:e.symbolUrl||e.iconUrl,width:15,height:15}),s().createElement("span",{style:{flex:1,paddingLeft:4}}," ",e.label)),t=this.props.options&&this.props.options.length?A()(this.props.options,(e=>e.value===this.props.defaultShape))&&this.props.defaultShape:C.xw;return s().createElement("div",null,s().createElement(E.Row,null,s().createElement(E.Col,{xs:12},s().createElement(T.Z,{msgId:"draw.marker.layout"}))),(0,C.ZA)(this.props.symbolErrors)?s().createElement(E.Row,null,s().createElement(E.Col,{xs:6},s().createElement(T.Z,{msgId:"draw.marker.shape"})),s().createElement(E.Col,{xs:6,style:{position:"static"}},s().createElement(E.Alert,{bsStyle:"warning"},s().createElement(T.Z,{msgId:"annotations.errorLoadingSymbols"})))):s().createElement("div",null,s().createElement(E.Row,null,s().createElement(E.Col,{xs:6},s().createElement(T.Z,{msgId:"draw.marker.shape"})),s().createElement(E.Col,{xs:6,style:{position:"static"}},s().createElement(E.InputGroup,null,s().createElement(le.ZP,{clearable:!1,options:this.props.options,value:this.props.style.shape,onChange:e=>{const t=e&&e.value;this.props.onChange(this.props.style.id,{symbolUrl:this.props.symbolsPath+t+".svg",shape:t})},optionRenderer:e,valueRenderer:e}),s().createElement(E.InputGroup.Addon,{className:"btn",onClick:()=>this.loadSymbolsList(t)},s().createElement(E.Glyphicon,{glyph:"refresh"}))))),!((0,C.ZA)(this.props.symbolErrors,"loading_symbol"+this.props.style.shape)||(0,C.ZA)(this.props.symbolErrors,"loading_symbol"+this.props.defaultShape))&&s().createElement(E.Row,null,s().createElement(E.Col,{xs:6},s().createElement(T.Z,{msgId:"draw.marker.size"})),s().createElement(E.Col,{xs:6,style:{position:"static"}},s().createElement("div",{className:"mapstore-slider with-tooltip"},s().createElement(ye.Z,{tooltips:!0,step:1,start:[this.props.style.size||this.props.defaultShapeSize],format:{from:e=>Math.round(e),to:e=>Math.round(e)+" px"},range:{min:1,max:64},onChange:e=>{const t=parseInt(e[0].replace(" px",""),10);this.props.onChange(this.props.style.id,{size:t})}}))))))}}fe(be,"propTypes",{style:l().object,options:l().array,defaultShape:l().string,defaultShapeSize:l().number,onChange:l().func,onUpdateOptions:l().func,onLoadingError:l().func,symbolErrors:l().array,width:l().number,symbolsPath:l().string}),fe(be,"contextTypes",{messages:l().object}),fe(be,"defaultProps",{symbolsPath:C.Fi,style:{},defaultShape:C.xw,defaultShapeSize:64,options:[],symbolErrors:[],onChange:()=>{},onUpdateOptions:()=>{}});const ve=be;var Ee=o(185552),Se=o.n(Ee),Ce=o(392021);function we(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}q()();class Te extends s().Component{shouldComponentUpdate(e){return!ge()(this.props.style,e.style)||!ge()(this.props.lineDashOptions,e.lineDashOptions)}render(){const{style:e}=this.props;return s().createElement("div",null,s().createElement(E.Row,null,s().createElement(E.Col,{xs:12},s().createElement("strong",null,s().createElement(T.Z,{msgId:"draw.stroke"})))),s().createElement(E.Row,null,s().createElement(E.Col,{xs:6},s().createElement(T.Z,{msgId:"draw.lineDash"})),s().createElement(E.Col,{xs:6,style:{position:"static"}},s().createElement(Ce.Z,{options:this.props.lineDashOptions,dashArray:e.dashArray,onChange:t=>{this.props.onChange(e.id,{dashArray:t})}}))),s().createElement(E.Row,null,s().createElement(E.Col,{xs:6},s().createElement(T.Z,{msgId:"draw.color"})),s().createElement(E.Col,{xs:6,style:{position:"static"}},s().createElement(X.Z,{color:(0,H.addOpacityToColor)(V()(e.color||this.props.defaultColor).toRgb(),e.opacity),width:this.props.width,onChangeColor:t=>{if(!B()(t)){const o=V()(t).toHexString(),n=t.a;this.props.onChange(e.id,{color:o,opacity:n})}}}))),s().createElement(E.Row,null,s().createElement(E.Col,{xs:6},s().createElement(T.Z,{msgId:"draw.opacity"})),s().createElement(E.Col,{xs:6,style:{position:"static"}},s().createElement(Q.Z,{opacity:B()(e.opacity)?.2:e.opacity,onChange:t=>{this.props.onChange(e.id,{opacity:t})}}))),s().createElement(E.Row,null,s().createElement(E.Col,{xs:6},s().createElement(T.Z,{msgId:"draw.width"})),s().createElement(E.Col,{xs:6,style:{position:"static"}},s().createElement("div",{className:"mapstore-slider with-tooltip"},s().createElement(Se(),{tooltips:!0,step:1,start:[e.weight||e.width||1],format:{from:e=>Math.round(e),to:e=>Math.round(e)+" px"},range:{min:B()(this.props.constraints&&this.props.constraints.minWidth)?1:this.props.constraints.maxWidth,max:this.props.constraints&&this.props.constraints.maxWidth||15},onChange:t=>{const o=parseInt(t[0].replace(" px",""),10);this.props.onChange(e.id,{weight:o})}})))))}}we(Te,"propTypes",{style:l().object,defaultColor:l().string,lineDashOptions:l().array,onChange:l().func,width:l().number,constraints:l().object}),we(Te,"defaultProps",{style:{},constraints:{maxWidth:15,minWidth:1},onChange:()=>{}});const xe=Te;var Pe=o(200020),ke=o(481330),Oe=o(719648);function Me(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}q()();class Fe extends s().Component{constructor(){super(...arguments),Me(this,"state",{fontFamily:"Arial"})}render(){const e={emptyList:(0,Oe.S$)(this.context.messages,"queryform.attributefilter.autocomplete.emptyList"),open:(0,Oe.S$)(this.context.messages,"queryform.attributefilter.autocomplete.open"),emptyFilter:(0,Oe.S$)(this.context.messages,"queryform.attributefilter.autocomplete.emptyFilter")},{style:t}=this.props;return s().createElement("div",{className:"ms-text-style"},s().createElement("div",{className:"content"},s().createElement("strong",null,s().createElement(T.Z,{msgId:"draw.fontTitle"}))),s().createElement("div",{className:"content"},s().createElement("div",{className:"left"},s().createElement(T.Z,{msgId:"draw.font.family"})),s().createElement("div",{className:"right"},s().createElement(Pe.Combobox,{value:this.state.fontFamily||"Arial",textField:"value",valueField:"value",messages:e,data:this.props.fontFamilyValues,onChange:e=>{let o=e.value?e.value:e;""===o&&(o="Arial"),this.setState({fontFamily:o});const n=(0,C.vh)({...t,fontFamily:o});this.props.onChange(t.id,{fontFamily:o,font:n})}}))),s().createElement("div",{className:"content"},s().createElement("div",{className:"left"},s().createElement(T.Z,{msgId:"draw.font.size"})),s().createElement("div",{className:"right",style:{display:"flex"}},s().createElement("div",{className:"left font-size"},s().createElement(ke.Z,{value:t.fontSize||14,placeholder:"",onChange:e=>{const o=e||14,n=(0,C.vh)({...t,fontSize:o});this.props.onChange(t.id,{fontSize:o,font:n})},type:"number"})),s().createElement(Pe.Combobox,{className:"font-uom",value:t.fontSizeUom||"px",textField:"value",valueField:"value",messages:e,data:this.props.uomValues,onChange:e=>{let o=e.value?e.value:e;-1===this.props.uomValues.map((e=>e.value)).indexOf(o)&&(o="px");const n=(0,C.vh)({...t,fontSizeUom:o});this.props.onChange(t.id,{fontSizeUom:o,font:n})}}))),s().createElement("div",{className:"content"},s().createElement("div",{className:"left"},s().createElement(T.Z,{msgId:"draw.font.style"})),s().createElement("div",{className:"right"},s().createElement(Pe.Combobox,{value:t.fontStyle||"normal",textField:"value",valueField:"value",messages:e,data:this.props.fontStyleValues,onChange:e=>{let o=e.value?e.value:e;-1===this.props.fontStyleValues.map((e=>e.value)).indexOf(o)&&(o=t.fontStyle);const n=(0,C.vh)({...t,fontStyle:o});this.props.onChange(t.id,{fontStyle:o,font:n})}}))),s().createElement("div",{className:"content"},s().createElement("div",{className:"left"},s().createElement(T.Z,{msgId:"draw.font.weight"})),s().createElement("div",{className:"right"},s().createElement(Pe.Combobox,{value:t.fontWeight||"normal",textField:"value",valueField:"value",messages:e,data:this.props.fontWeightValues,onChange:e=>{let o=e.value?e.value:e;-1===this.props.fontWeightValues.map((e=>e.value)).indexOf(o)&&(o=t.fontWeight);const n=(0,C.vh)({...t,fontWeight:o});this.props.onChange(t.id,{fontWeight:o,font:n})}}))),s().createElement("div",{className:"content"},s().createElement("div",{className:"left"},s().createElement("strong",null,s().createElement(T.Z,{msgId:"draw.text"})))),s().createElement("div",{className:"content"},s().createElement("div",{className:"left"},s().createElement(T.Z,{msgId:"draw.font.textAlign"})),s().createElement("div",{className:"right"},s().createElement(Pe.Combobox,{value:t.textAlign||"center",textField:"label",valueField:"value",messages:e,data:this.props.alignValues,onChange:e=>{let o=e.value?e.value:e;-1===this.props.alignValues.map((e=>e.value)).indexOf(o)&&(o="center"),this.props.onChange(t.id,{textAlign:o})}}))),s().createElement("div",{className:"content"},s().createElement("div",{className:"left"},s().createElement(T.Z,{msgId:"draw.textRotation"})),s().createElement("div",{className:"right"},s().createElement("div",{className:"mapstore-slider with-tooltip"},s().createElement(Se(),{tooltips:!0,step:this.props.rotationStep,start:[t.textRotationDeg||0],format:{from:e=>Math.round(parseFloat(e)),to:e=>Math.round(e)+" &deg;"},range:{min:0,max:359},onChange:e=>{const o=parseInt(e[0].replace(" &deg;",""),10);this.props.onChange(t.id,{textRotationDeg:o})}})))))}}Me(Fe,"propTypes",{style:l().object,onChange:l().func,addOpacityToColor:l().func,width:l().number,uomValues:l().array,alignValues:l().array,fontStyleValues:l().array,fontWeightValues:l().array,fontFamilyValues:l().array,shapeStyle:l().object,rotationStep:l().number}),Me(Fe,"contextTypes",{messages:l().object}),Me(Fe,"defaultProps",{style:{},onChange:()=>{},uomValues:[{value:"px"},{value:"em"}],fontWeightValues:[{value:"normal"},{value:"bold"}],alignValues:[{value:"start",label:"left"},{value:"center",label:"center"},{value:"end",label:"right"}],fontStyleValues:[{value:"normal"},{value:"italic"}],fontFamilyValues:[{value:"Arial"},{value:"Helvetica"},{value:"sans-serif"},{value:"Courier"}],shapeStyle:{},rotationStep:5});const Ze=Fe;function je(){return je=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},je.apply(this,arguments)}function Ne(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}class Ie extends s().Component{constructor(){var e;super(...arguments),e=this,Ne(this,"state",{}),Ne(this,"renderPanelStyle",(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;const r={style:t,onChange:e.change,width:e.props.width},i=(0,H.isTextStyle)(t)||(0,H.isSymbolStyle)(t),l=!((0,H.isMarkerStyle)(t)||(0,H.isSymbolStyle)(t)&&((0,C.ZA)(e.props.symbolErrors)||(0,C.ZA)(e.props.symbolErrors,"loading_symbol"+t.shape)))&&s().createElement("div",{className:"ms-marker-preview",style:{display:"flex",width:"100%",height:90}},s().createElement(Y.Z,{style:{padding:0,margin:"auto",display:"block",width:i?"100%":"auto",...i&&{transform:"scaleX(2.2) scaleY(2.5)"}},originalStyle:t,shapeStyle:a()({},t,{color:(0,H.addOpacityToColor)(V()(t.color).toRgb(),B()(t.opacity)?1:t.opacity),fill:(0,H.addOpacityToColor)(V()(t.fillColor||"#FFCC33").toRgb(),B()(t.fillOpacity)?1:t.fillOpacity),radius:75}),geomType:(0,H.getStylerTitle)(t),width:i?600:90,height:120})),p=(0,H.isStrokeStyle)(t)&&(0,H.isSymbolStyle)(t)&&((0,C.ZA)(e.props.symbolErrors)||(0,C.ZA)(e.props.symbolErrors,"loading_symbol"+t.shape))?null:(0,H.isStrokeStyle)(t)?s().createElement(xe,je({},r,{defaultColor:e.props.defaultShapeStrokeColor,lineDashOptions:e.props.lineDashOptions,constraints:{maxWidth:(0,H.isSymbolStyle)(t)?5:15},key:"stroke"+n})):null,d=(0,H.isFillStyle)(t)&&(0,H.isSymbolStyle)(t)&&((0,C.ZA)(e.props.symbolErrors)||(0,C.ZA)(e.props.symbolErrors,"loading_symbol"+t.shape))?null:(0,H.isFillStyle)(t)&&s().createElement(ee,je({},r,{defaultColor:e.props.defaultShapeFillColor,key:"fill"+n}))||null,c=(0,H.isTextStyle)(t)&&s().createElement(Ze,je({},r,{rotationStep:e.props.textRotationStep}))||null,h=((0,H.isMarkerStyle)(t)||(0,H.isSymbolStyle)(t))&&s().createElement(ce,je({},r,{pointType:(0,H.isSymbolStyle)(t)?"symbol":"marker",onChangeType:e.changeSymbolType}))||null,m=(0,H.isMarkerStyle)(t)&&s().createElement(ie,je({},r,{markersOptions:e.props.markersOptions}))||null,u=(0,H.isSymbolStyle)(t)&&s().createElement(ve,je({},r,{style:{...t},symbolsPath:e.props.symbolsPath,defaultShape:e.props.defaultShape,defaultShapeSize:e.props.defaultShapeSize,onUpdateOptions:t=>{e.props.onUpdateSymbols(t)},options:e.props.symbolList,symbolErrors:e.props.symbolErrors,onLoadingError:e.props.onSetErrorSymbol}))||null,g=s().createElement("hr",null),y=[h,l,u,m,c,d,p];return s().createElement(E.Grid,{fluid:!0,style:{width:"100%"},className:"ms-style",key:"grid"+n},s().createElement(_.Z,je({},o,{key:"switchPanel"+n}),y.reduce(((e,t,o)=>[e,e&&t&&s().createElement("span",{key:"separator"+o},g),t]))))})),Ne(this,"change",((e,t)=>{const o=Z()(this.props.style);let n={...A()(o,{id:e}),...t};(0,H.isSymbolStyle)(n)?(0,H.fetchStyle)((0,H.hashAndStringify)(n))?this.updateStyles(e,(0,H.fetchStyle)((0,H.hashAndStringify)(n)),o,!0):(0,H.createSvgUrl)(n,n.symbolUrl).then((t=>{this.updateStyles(e,{...n,symbolUrlCustomized:t},o,!0)})):this.updateStyles(e,n,o,!0)})),Ne(this,"updateStyles",(function(t,o,n){let s=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];s&&(0,H.registerStyle)((0,H.hashAndStringify)(o),o);let r=(0,W.cc)(!1,o,{id:t},n);e.props.onChangeStyle(r)})),Ne(this,"changeSymbolType",((e,t)=>{var o;this.updateStylesAndType(e,t,null===(o=this.props.defaultStyles.POINT)||void 0===o?void 0:o[t])})),Ne(this,"updateStylesAndType",((e,t,o)=>{const n=Z()(this.props.style),s=U()(n,{id:e});if(-1!==s){let e=n.map(((e,t)=>t===s?{...o,id:e.id,title:e.title,geometry:e.geometry,filtering:e.filtering}:e));this.props.onChangeStyle(e)}})),Ne(this,"checkSymbolUrl",(e=>{let{style:t,symbolErrors:o,onLoadingError:n=this.props.onSetErrorSymbol}=e;M().get(t.symbolUrl).then((()=>{if(!(0,C.ZA)(this.props.symbolErrors,"loading_symbol"+t.shape)){const e=N()(o,(e=>e!=="loading_symbol"+t.shape));n(e)}})).catch((()=>{(0,C.ZA)(this.props.symbolErrors,"loading_symbol"+t.shape)||n(o.concat(["loading_symbol"+t.shape]))}))}))}UNSAFE_componentWillMount(){const e=Z()(this.props.style),t=e.map(((e,t)=>0===t||e.filtering)),o=e.map(((e,t)=>0===t));this.setState({expanded:t,locked:o}),e.filter((e=>{let{type:t}=e;return"Point"===t})).forEach((e=>{this.checkSymbolUrl({...this.props,style:e})}))}render(){const e=Z()(this.props.style);return s().createElement("div",{className:"ms-style-manager"},e.map(((t,o)=>this.renderPanelStyle({...t,id:t.id||z()()},{expanded:this.state.expanded[o],locked:this.state.locked[o],onSwitch:()=>{this.setState((()=>({expanded:this.state.expanded.map(((e,t)=>o===t?!this.state.expanded[o]:this.state.expanded[t]))})));let t=e.map(((e,t)=>t===o?{...e,filtering:!this.state.expanded[o]}:e));this.props.onChangeStyle(t)},title:t.title||(0,H.getStylerTitle)(t)+" Style"},o))))}}Ne(Ie,"propTypes",{style:l().object,switchPanelOptions:l().array,lineDashOptions:l().array,onChangeStyle:l().func,pointType:l().string,onUpdateSymbols:l().func,onSetErrorSymbol:l().func,width:l().number,symbolsPath:l().string,defaultShape:l().string,defaultShapeSize:l().number,defaultShapeFillColor:l().string,defaultShapeStrokeColor:l().string,defaultStyles:l().object,symbolList:l().array,symbolErrors:l().array,defaultSymbol:l().object,defaultMarker:l().object,markersOptions:l().object,textRotationStep:l().number}),Ne(Ie,"defaultProps",{style:{},defaultShape:C.xw,symbolsPath:C.Fi,defaultShapeSize:64,defaultShapeFillColor:"#000000",defaultShapeStrokeColor:"#000000",symbolErrors:[],onChangeStyle:()=>{},onUpdateSymbols:()=>{},defaultStyles:{},switchPanelOptions:[]});const Ae=Ie;var Ge=o(798132);const Ue=Ge.Z.markers.extra.icons[0],De=Ge.Z.markers.extra.getGrid(),Be={fields:[{name:"title",type:"text",validator:e=>e,validateError:"annotations.mandatory",showLabel:!0,editable:!0},{name:"description",type:"html",showLabel:!0,editable:!0}],markers:De,markerIcon:Ue,markersConfig:Ge.Z.markers.extra,multiGeometry:!1,glyphs:Object.keys(Ge.Z.getGlyphs("fontawesome")),getGlyphClassName:e=>"fa fa-"+e.iconGlyph,getMarkerFromStyle:e=>De.filter((t=>t.name===e.iconShape))[0].markers.filter((t=>t.name===e.iconColor))[0]};var Re=o(813292),Ve=o.n(Re),Le=o(401811),ze=o(294184),We=o.n(ze),He=o(227361),_e=o.n(He);function Ye(){return Ye=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},Ye.apply(this,arguments)}const $e=e=>{var t,o,n,r;const{editing:a,onAddGeometry:i,onSetStyle:l,onStartDrawing:p,onAddText:d,onStyleGeometry:c,setTabValue:h,isMeasureEditDisabled:m,onSetAnnotationMeasurement:u,showPopupWarning:g,setPopupWarning:y,geodesic:f,defaultStyles:b,defaultPointType:v,onValidateFeature:S,validateFeatures:w}=e,{features:x=[]}=a||{},P=_e()(e,"selected.properties.isValidFeature",!0),O=w(),M=(e,t)=>{c(!1),i(e),"Text"===e&&d(),l(t),p({geodesic:f}),h("coordinates"),S()},F="symbol"===v?null===(t=b.POINT)||void 0===t?void 0:t[v]:C.z4.Point,Z="symbol"===v?[{...null===(o=b.POINT)||void 0===o?void 0:o[v],highlight:!0,iconAnchor:[.5,.5],type:"Point",title:"StartPoint Style",geometry:"startPoint",filtering:!1,id:z()()},{...null===(n=b.POINT)||void 0===n?void 0:n[v],highlight:!0,iconAnchor:[.5,.5],type:"Point",title:"EndPoint Style",geometry:"endPoint",filtering:!1,id:z()()}]:(0,C.N_)();return s().createElement(s().Fragment,null,s().createElement("div",{className:"geometries-toolbar"},s().createElement(E.ControlLabel,null,s().createElement(T.Z,{msgId:"annotations.geometries"})),s().createElement(k.Z,{btnDefaultProps:{className:"square-button-md no-border"},buttons:[{glyph:null==a||null===(r=a.properties)||void 0===r?void 0:r.iconGlyph,visible:!m,disabled:!P,onClick:()=>{g?y(!0):u()},tooltip:s().createElement(T.Z,{msgId:"annotations.editMeasurement"})},{glyph:"point-plus",visible:m,disabled:!P,onClick:()=>{var e;const t=[{...null===(e=b.POINT)||void 0===e?void 0:e[v],highlight:!0,id:z()()}];M("Point",t)},tooltip:s().createElement(T.Z,{msgId:"annotations.titles.marker"})},{glyph:"polyline-plus",visible:m,disabled:!P,onClick:()=>{const e=[{...C.z4.LineString,highlight:!0,id:z()()}].concat(Z);M("LineString",e)},tooltip:s().createElement(T.Z,{msgId:"annotations.titles.line"})},{glyph:"polygon-plus",visible:m,disabled:!P,onClick:()=>{const e=[{...C.z4.Polygon,highlight:!0,id:z()()}];M("Polygon",e)},tooltip:s().createElement(T.Z,{msgId:"annotations.titles.polygon"})},{glyph:"font-add",visible:m,disabled:!P,onClick:()=>{const e=[{...C.z4.Text,highlight:!0,type:"Text",title:"Text Style",id:z()()}];M("Text",e)},tooltip:s().createElement(T.Z,{msgId:"annotations.titles.text"})},{glyph:"1-circle-add",visible:m,disabled:!P,onClick:()=>{const e=[{...C.z4.Circle,highlight:!0,type:"Circle",title:"Circle Style",id:z()()},{...F,highlight:!0,iconAnchor:[.5,.5],type:"Point",title:"Center Style",filtering:!1,geometry:"centerPoint",id:z()()}];M("Circle",e)},tooltip:s().createElement(T.Z,{msgId:"annotations.titles.circle"})}]})),x&&0===x.length&&s().createElement("div",{style:{textAlign:"center"}},s().createElement(T.Z,{msgId:"annotations.addGeometry"})),null==x?void 0:x.map(((t,o)=>s().createElement(qe,Ye({disabled:!O,onValidateFeature:S,feature:t,key:o},e)))))},qe=e=>{var t;let{feature:o,selected:n,disabled:r,onDeleteGeometry:a,onZoom:i,maxZoom:l,onSelectFeature:p,onUnselectFeature:d,setTabValue:c,isMeasureEditDisabled:h,onStyleGeometry:m,onGeometryHighlight:u,onValidateFeature:g}=e;const y=(0,C.q9)(o),{properties:f}=o,{glyph:b,label:v}=(0,C.XL)(y),S=(null==n||null===(t=n.properties)||void 0===t?void 0:t.id)===(null==f?void 0:f.id),w=_e()(n,"properties.isValidFeature",!0),x=null==f?void 0:f.isValidFeature,P=!S&&w,O=s().createElement("div",{className:We()("geometry-card",{"ms-selected":S,"ms-disabled":r&&!S}),onMouseEnter:()=>P&&u(f.id),onMouseLeave:()=>P&&u(f.id,!1),onClick:()=>{S&&x?(d(),u(f.id)):r||(p([o]),c(h?"coordinates":"style"),m(!h)),g()}},s().createElement("div",{className:"geometry-card-preview"},s().createElement(E.Glyphicon,{glyph:b})),s().createElement("div",{className:"geometry-card-label"},s().createElement("div",null,(null==f?void 0:f.geometryTitle)||v||(null==f?void 0:f.id))),s().createElement(k.Z,{btnDefaultProps:{className:"square-button-md no-border"},buttons:[{glyph:"zoom-to",visible:x,className:We()({inactive:r&&!S,"square-button-md no-border":!0}),tooltip:s().createElement(T.Z,{msgId:"annotations.zoomToGeometry"}),onClick:e=>{e.stopPropagation();const t=Ve()(o);i(t,"EPSG:4326",l)}},{glyph:"trash",className:We()({inactive:r&&!S,"square-button-md no-border":!0}),tooltip:s().createElement(T.Z,{msgId:"annotations.removeGeometry"}),onClick:e=>{e.stopPropagation(),a(null==f?void 0:f.id)}}]}));return r&&!S?(e=>s().createElement(Le.Z,{placement:"left",overlay:s().createElement(E.Tooltip,null,s().createElement(T.Z,{msgId:"annotations.resolveAllErrors"}))},e))(O):O};$e.defaultProps={onAddGeometry:()=>{},onSetStyle:()=>{},onStartDrawing:()=>{},onAddText:()=>{},onStyleGeometry:()=>{},onSetAnnotationMeasurement:()=>{},onSelectFeature:()=>{},setTabValue:()=>{},isMeasureEditDisabled:!0,defaultPointType:"marker",defaultStyles:{},onValidateFeature:()=>{},validateFeatures:()=>!0};const Qe=$e;var Xe=o(100845);function Je(){return Je=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},Je.apply(this,arguments)}function Ke(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}class et extends s().Component{render(){return s().createElement(Xe.Z,Je({},this.props.options,{items:[],isDraggable:!0,type:this.props.featureType,components:this.props.selected&&this.props.selected.geometry&&this.props.selected.geometry.coordinates&&this.props.selected.geometry.coordinates.length?(0,C.OQ)(this.props.selected.geometry):[],properties:this.props.selected&&this.props.selected.properties||{},onComplete:()=>{},onChangeRadius:this.props.onChangeRadius,aeronauticalOptions:this.props.aeronauticalOptions,onChangeFormat:this.props.onChangeFormat,format:this.props.format,mapProjection:this.props.mapProjection,onHighlightPoint:this.props.onHighlightPoint,onSetInvalidSelected:this.props.onSetInvalidSelected,onChangeText:this.props.onChangeText,renderer:this.props.renderer,onValidateFeature:this.props.onValidateFeature,onChange:(e,t,o,n)=>{let s=e.map((e=>[e.lon,e.lat]));this.props.onChange(s,t,o,n),this.props.onValidateFeature()}}))}}Ke(et,"propTypes",{components:l().array,options:l().object,onRemove:l().func,onChange:l().func,transitionProps:l().object,selected:l().object,featureType:l().string,format:l().string,mapProjection:l().string,onComplete:l().func,onHighlightPoint:l().func,onChangeFormat:l().func,onChangeRadius:l().func,onSetInvalidSelected:l().func,aeronauticalOptions:l().object,onChangeText:l().func,renderer:l().string,onValidateFeature:l().func}),Ke(et,"defaultProps",{selected:{},options:{},components:[],onRemove:null,onChange:()=>{},onComplete:()=>{},onChangeRadius:()=>{},onHighlightPoint:()=>{},onChangeFormat:()=>{},onSetInvalidSelected:()=>{},onChangeText:()=>{},transitionProps:{transitionName:"switch-panel-transition",transitionEnterTimeout:300,transitionLeaveTimeout:300},onValidateFeature:()=>{}});const tt=et;var ot=o(272124);function nt(){return nt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},nt.apply(this,arguments)}function st(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}class rt extends s().Component{constructor(){var e;super(...arguments),e=this,st(this,"state",{editedFields:{},removing:null,textValue:"",tabValue:"coordinates",showPopupWarning:!1}),st(this,"getConfig",(()=>({...Be,...this.props.config,onFilterMarker:this.props.onFilterMarker}))),st(this,"getBodyItems",(e=>this.getConfig().fields.filter((t=>!e||t.editable)).map((t=>{const o=e&&this.props.errors[t.name],n=o?"field-error":"";return s().createElement("div",{key:t.name,className:"mapstore-annotations-info-viewer-item mapstore-annotations-info-viewer-"+t.name+" "+n},t.showLabel?s().createElement("label",null,s().createElement(T.Z,{msgId:"annotations.field."+t.name})):null,o?this.renderErrorOn(t.name):"",this.renderProperty(t,this.props[t.name]||t.value,e))})))),st(this,"getValidator",(e=>f()(e)?e:(0,h.CU)({},{},"{(function(value) {return "+e+";})}"))),st(this,"renderViewButtons",(()=>s().createElement(E.Grid,{fluid:!0,style:this.props.styling?{width:"100%",boxShadow:"none"}:{width:"100%"}},s().createElement(E.Row,{className:"noTopMargin"},s().createElement(E.Col,{xs:12,className:"text-center"},s().createElement(k.Z,{btnDefaultProps:{className:"square-button-md",bsStyle:"primary"},buttons:[{glyph:"arrow-left",tooltipId:"annotations.back",visible:this.props.showBack,onClick:()=>{var e,t;this.props.onCancelEdit(null===(e=this.props)||void 0===e||null===(t=e.feature)||void 0===t?void 0:t.properties),this.props.onCancel(),this.props.onCleanHighlight()}},{glyph:"pencil",tooltipId:"annotations.edit",visible:this.props.showEdit,multiGeometry:this.props.config.multiGeometry,onClick:()=>{this.props.onEdit(this.props.id)},disabled:!this.props.config.multiGeometry&&this.props.editing&&this.props.editing.features&&this.props.editing.features.length,bsStyle:this.props.drawing?"success":"primary"},{glyph:"trash",tooltipId:"annotations.remove",visible:!0,onClick:()=>{this.setState({removing:this.props.id})}},{glyph:"download",tooltip:s().createElement(T.Z,{msgId:"annotations.downloadcurrenttooltip"}),visible:!0,onClick:()=>{this.props.onDownload(this.props.features)}}]})))))),st(this,"renderEditingCoordButtons",(()=>{var e,t,o,n,r;const a=this.validateFeatures();return s().createElement(E.Grid,{className:"mapstore-annotations-info-viewer-buttons",fluid:!0},s().createElement(E.Row,{className:"text-center noTopMargin"},s().createElement(E.Col,{xs:12},s().createElement(k.Z,{btnDefaultProps:{className:"square-button-md",bsStyle:"primary"},buttons:[{glyph:"arrow-left",tooltipId:"annotations.back",tooltipPosition:"bottom",visible:!0,disabled:(null===(e=this.props)||void 0===e||null===(t=e.selected)||void 0===t?void 0:t.properties)&&!(null!==(o=this.props)&&void 0!==o&&null!==(n=o.selected)&&void 0!==n&&null!==(r=n.properties)&&void 0!==r&&r.isValidFeature)||!1,onClick:()=>{if(this.props.styling&&this.isMeasureEditDisabled())this.props.unsavedStyle?this.props.onToggleUnsavedStyleModal():this.props.onCancelStyle();else if(this.props.unsavedGeometry)this.props.onToggleUnsavedGeometryModal();else if(this.props.unsavedChanges)this.props.onToggleUnsavedChangesModal();else{var e;this.props.onResetCoordEditor(),this.props.onCancelEdit(null===(e=this.props.editing)||void 0===e?void 0:e.properties),this.setState({...this.state,tabValue:"coordinates"})}}},{glyph:"trash",tooltipId:"annotations.remove",tooltipPosition:"bottom",disabled:!this.props.annotations.length,visible:!this.props.selected,onClick:()=>{this.setState({removing:this.props.id})}},{glyph:"floppy-disk",tooltipPosition:"bottom",tooltipId:a?c()(this.props.selected)?"annotations.save":"annotations.saveGeometry":"annotations.annotationSaveGeometryError",disabled:this.props.selected&&this.props.selected.properties&&!this.props.selected.properties.isValidFeature||!a,onClick:()=>this.save()},{glyph:"download",tooltip:s().createElement(T.Z,{msgId:"annotations.downloadcurrenttooltip"}),tooltipPosition:"bottom",disabled:0!==Object.keys(this.validate()).length||this.props.unsavedChanges,visible:!this.props.selected,onClick:()=>{const{newFeature:e,...t}=this.props.editing;this.props.onDownload(t)}}]}))))})),st(this,"renderButtons",(e=>{let t;return t=e?this.renderEditingCoordButtons():this.renderViewButtons(),s().createElement("div",{className:"mapstore-annotations-info-viewer-buttons"},t)})),st(this,"renderProperty",((e,t,o)=>{const n=void 0===this.props.editedFields[e.name]?t:this.props.editedFields[e.name];if(o)switch(e.type){case"html":return s().createElement(S.Z,{value:n||"",onChange:t=>{this.change(e.name,t),this.props.unsavedChanges||this.props.onSetUnsavedChanges(!0)}});case"component":const t=n;return s().createElement("prop",{editing:!0,value:s().createElement(t,{annotation:this.props.feature}),onChange:t=>{this.change(e.name,t.target.value),this.props.unsavedChanges||this.props.onSetUnsavedChanges(!0)}});default:return s().createElement(E.FormControl,{value:n||"",onChange:t=>{this.change(e.name,t.target.value),this.props.unsavedChanges||this.props.onSetUnsavedChanges(!0)}})}switch(e.type){case"html":return s().createElement("span",{dangerouslySetInnerHTML:{__html:n}});case"component":const e=n;return s().createElement(e,{annotation:this.props.feature});default:return s().createElement("p",null,n)}})),st(this,"renderErrorOn",(e=>s().createElement("div",{className:"annotations-edit-error"},s().createElement(T.Z,{msgId:this.props.errors[e]})))),st(this,"renderMarkers",(function(t){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return t.map((t=>t.markers?s().createElement("div",{className:"mapstore-annotations-info-viewer-marker-group mapstore-annotations-info-viewer-marker-"+o+t.name},e.renderMarkers(t.markers,t.name+"-")):s().createElement("div",{onClick:()=>e.selectStyle(t),className:"mapstore-annotations-info-viewer-marker mapstore-annotations-info-viewer-marker-"+o+t.name+(e.isCurrentStyle(t)?" mapstore-annotations-info-viewer-marker-selected":""),style:t.thumbnailStyle})))})),st(this,"renderBody",(e=>{const t=this.getBodyItems(e);return 0===t.length?null:s().createElement("div",{className:"mapstore-annotations-info-viewer-items"+(this.props.styling?" mapstore-annotations-info-viewer-styler":"")},s().createElement("div",null,t,e&&s().createElement(Qe,{editing:this.props.editing,selected:this.props.selected,onAddGeometry:this.props.onAddGeometry,onSetStyle:this.props.onSetStyle,onStartDrawing:this.props.onStartDrawing,onAddText:this.props.onAddText,onDeleteGeometry:this.props.onDeleteGeometry,onZoom:this.props.onZoom,maxZoom:this.props.maxZoom,setTabValue:this.setTabValue,styling:this.props.styling,onStyleGeometry:this.props.onStyleGeometry,onSelectFeature:this.props.onSelectFeature,drawing:this.props.drawing,onUnselectFeature:this.props.onUnSelectFeature,onGeometryHighlight:this.props.onGeometryHighlight,isMeasureEditDisabled:this.isMeasureEditDisabled(),onSetAnnotationMeasurement:this.setAnnotationMeasurement,setPopupWarning:this.setPopupWarning,showPopupWarning:this.props.showPopupWarning,geodesic:this.props.geodesic,defaultPointType:this.getConfig().defaultPointType,defaultStyles:this.props.defaultStyles,onValidateFeature:this.props.onValidateFeature,validateFeatures:this.validateFeatures})))})),st(this,"renderError",(e=>e?Object.keys(this.props.errors).filter((e=>0===this.getConfig().fields.filter((t=>t.name===e)).length)).map((e=>this.renderErrorOn(e))):null)),st(this,"renderModals",(()=>{return this.props.closing?s().createElement(P.Z,null,s().createElement(x.Z,{show:!0,modal:!0,onClose:this.props.onCancelClose,onConfirm:()=>{var e;return this.props.onConfirmClose(null===(e=this.props.editing)||void 0===e?void 0:e.properties)},confirmButtonBSStyle:"default",closeGlyph:"1-close",confirmButtonContent:s().createElement(T.Z,{msgId:"annotations.confirm"}),closeText:s().createElement(T.Z,{msgId:"annotations.cancel"})},s().createElement(T.Z,{msgId:"annotations.undo"}))):this.props.showUnsavedChangesModal?s().createElement(P.Z,null,s().createElement(x.Z,{show:!0,modal:!0,onClose:this.props.onToggleUnsavedChangesModal,onConfirm:()=>{var e;this.props.selected&&this.props.onResetCoordEditor(),this.props.onCancelEdit(null===(e=this.props.editing)||void 0===e?void 0:e.properties),this.props.onToggleUnsavedChangesModal()},confirmButtonBSStyle:"default",closeGlyph:"1-close",confirmButtonContent:s().createElement(T.Z,{msgId:"annotations.confirm"}),closeText:s().createElement(T.Z,{msgId:"annotations.cancel"})},s().createElement(T.Z,{msgId:"annotations.undo"}))):this.props.showUnsavedGeometryModal?s().createElement(P.Z,null,s().createElement(x.Z,{show:!0,modal:!0,onClose:this.props.onToggleUnsavedGeometryModal,onConfirm:()=>{var e;this.props.onResetCoordEditor(),this.props.onCancelEdit(null===(e=this.props.editing)||void 0===e?void 0:e.properties)},confirmButtonBSStyle:"default",closeGlyph:"1-close",title:s().createElement(T.Z,{msgId:"annotations.titleUndoGeom"}),confirmButtonContent:s().createElement(T.Z,{msgId:"annotations.confirmGeom"}),closeText:s().createElement(T.Z,{msgId:"annotations.cancelModalGeom"})},s().createElement(T.Z,{msgId:"annotations.undoGeom"}))):this.props.showUnsavedStyleModal?s().createElement(P.Z,null,s().createElement(x.Z,{show:!0,modal:!0,onClose:this.props.onToggleUnsavedStyleModal,onConfirm:()=>{this.props.onCancelStyle(),this.props.onToggleUnsavedStyleModal(),this.isMeasureEditDisabled()?this.setTabValue("coordinates"):this.setTabValue("style")},confirmButtonBSStyle:"default",closeGlyph:"1-close",confirmButtonContent:s().createElement(T.Z,{msgId:"annotations.confirm"}),closeText:s().createElement(T.Z,{msgId:"annotations.cancel"})},s().createElement(T.Z,{msgId:"annotations.undo"}))):this.props.showDeleteFeatureModal?s().createElement(P.Z,null,s().createElement(x.Z,{show:!0,modal:!0,onClose:this.props.onToggleDeleteFtModal,onConfirm:()=>{this.props.onConfirmDeleteFeature(),this.props.onToggleDeleteFtModal()},confirmButtonBSStyle:"default",closeGlyph:"1-close",confirmButtonContent:s().createElement(T.Z,{msgId:"annotations.confirm"}),closeText:s().createElement(T.Z,{msgId:"annotations.cancel"})},s().createElement(T.Z,{msgId:"annotations.undoDeleteFeature"}))):this.state.removing||this.props.removing?s().createElement(P.Z,null,s().createElement(x.Z,{show:!0,modal:!0,onClose:()=>{this.state.removing&&this.setState({removing:null}),this.props.onCancelRemove()},focusConfirm:this.props.removing,onConfirm:()=>{this.state.removing?(this.setState({removing:null}),this.props.onConfirmRemove(this.state.removing,"features")):this.props.onConfirmRemove(this.props.removing,"geometry")},confirmButtonBSStyle:"default",closeGlyph:"1-close",confirmButtonContent:s().createElement(T.Z,{msgId:"annotations.confirm"}),closeText:s().createElement(T.Z,{msgId:"annotations.cancel"})},"editing"===this.props.mode?s().createElement(T.Z,{msgId:"annotations.removegeometry"}):s().createElement(T.Z,{msgId:"annotations.removeannotation",msgParams:{title:null===(e=this.props)||void 0===e||null===(t=e.feature)||void 0===t||null===(o=t.properties)||void 0===o?void 0:o.title}}))):this.state.showPopupWarning&&this.props.showPopupWarning?s().createElement(P.Z,null,s().createElement(x.Z,{show:!0,modal:!0,title:s().createElement(T.Z,{msgId:"annotations.warning"}),onClose:this.hideWarning,onConfirm:this.setAnnotationMeasurement,confirmButtonBSStyle:"default",closeGlyph:"1-close",confirmButtonContent:s().createElement(T.Z,{msgId:"annotations.confirm"}),closeText:s().createElement(T.Z,{msgId:"annotations.cancel"})},s().createElement("span",null,s().createElement("p",null,s().createElement(T.Z,{msgId:"annotations.measureWarningText"})),s().createElement("p",null,s().createElement(E.Checkbox,{checked:this.props.showAgain,onClick:this.props.onToggleShowAgain},s().createElement(T.Z,{msgId:"annotations.notShowAgain"})))))):null;var e,t,o})),st(this,"validateFeatures",(()=>{var e,t;let o=!0;return Array.isArray(null===(e=this.props)||void 0===e||null===(t=e.editing)||void 0===t?void 0:t.features)&&(o=this.props.editing.features.every((e=>{var t;return null==e||null===(t=e.properties)||void 0===t?void 0:t.isValidFeature}))),o})),st(this,"change",((e,t)=>{this.props.onChangeProperties(e,t)})),st(this,"isCurrentStyle",(e=>this.getConfig().markersConfig.matches(this.props.editing.style.MultiPoint,e.style))),st(this,"selectStyle",(e=>this.props.onSetStyle(a()({},{Point:{...this.getConfig().markersConfig.getStyle(e.style),iconGlyph:this.props.editing.style.Point&&this.props.editing.style.Point.iconGlyph},MultiPoint:{...this.getConfig().markersConfig.getStyle(e.style),iconGlyph:this.props.editing.style.MultiPoint&&this.props.editing.style.MultiPoint.iconGlyph}})))),st(this,"selectGlyph",(e=>this.props.onSetStyle(a()({},this.props.editing.style,{Point:{...this.props.editing.style.Point,iconGlyph:e&&e.value||""},MultiPoint:{...this.props.editing.style.MultiPoint,iconGlyph:e&&e.value||""}})))),st(this,"validate",(()=>a()(this.getConfig().fields.filter((e=>e.editable)).reduce(((e,t)=>{const o=void 0===this.props.editedFields[t.name]?this.props[t.name]:this.props.editedFields[t.name];return t.validator&&!this.getValidator(t.validator)(o)?a()(e,{[t.name]:t.validateError}):e}),{}),this.props.editing.features&&this.props.editing.features.length?{}:{geometry:"annotations.emptygeometry"}))),st(this,"validateText",((e,t)=>{if(e&&e.length){const o=g()(e);return!!t&&(0,C.Tl)(o)}return!1})),st(this,"save",(()=>{if(c()(this.props.selected)){const e=this.validate();0===Object.keys(e).length?(this.props.onError({}),this.props.onSave(this.props.id,a()({},this.props.editedFields),this.props.editing.features,this.props.editing.style,this.props.editing.newFeature||!1,{...this.props.editing.properties,visibility:v()(this.props.editing.properties.visibility)?this.props.editing.visibility:this.props.editing.properties.visibility})):this.props.onError(e)}else this.props.onAddNewFeature()})),st(this,"setTabValue",(e=>{this.state.tabValue!==e&&this.setState({...this.state,tabValue:e})})),st(this,"setPopupWarning",(e=>{this.setState({...this.state,showPopupWarning:e})})),st(this,"isMeasureEditDisabled",(()=>{var e,t;const o=(null===(e=this.props.editing)||void 0===e||null===(t=e.properties)||void 0===t?void 0:t.type)===w.zE||!1;return!this.props.measurementAnnotationEdit||!o})),st(this,"setAnnotationMeasurement",(()=>{var e;this.props.onSetAnnotationMeasurement(this.props.editing.features.filter((e=>"Point"!==e.geometry.type&&!e.properties.isCircle)),null===(e=this.props.editing)||void 0===e?void 0:e.properties),this.hideWarning()})),st(this,"hideWarning",(()=>{if(this.props.showAgain){try{(0,ot.ac)().setItem("showPopupWarning",!1)}catch(e){console.error(e)}this.props.onHideMeasureWarning()}this.setPopupWarning(!1)}))}componentDidMount(){this.props.onInitPlugin()}render(){var e,t,o,n,r,a,i,l,p;const d=this.props.editing&&this.props.editing.properties.id===this.props.id;let h=this.props.mouseHoverEvents?{onMouseEnter:()=>{this.props.onHighlight(this.props.id)},onMouseLeave:()=>{this.props.onCleanHighlight()}}:{};const m=this.props.selected?(0,C.q9)(this.props.selected):"",{glyph:u="",label:g=""}=c()(m)?{}:(0,C.XL)(m);return s().createElement("div",nt({style:{display:"flex"},className:"mapstore-annotations-info-viewer"+(this.props.mouseHoverEvents?" hover-background":"")},h),s().createElement("div",{style:{flex:1}},this.renderButtons(d),this.renderError(d),this.renderModals(),this.renderBody(d)),!c()(this.props.selected)&&s().createElement("div",{className:"mapstore-annotations-info-viewer-expanded"},s().createElement("div",{style:{padding:8,display:"flex",alignItems:"center"}},s().createElement(E.Glyphicon,{glyph:u,style:{fontSize:20,paddingRight:8}}),s().createElement("div",{style:{flex:1}},s().createElement(E.FormControl,{value:(null===(e=this.props.selected)||void 0===e||null===(t=e.properties)||void 0===t?void 0:t.geometryTitle)||g||(null===(o=this.props.selected)||void 0===o||null===(n=o.properties)||void 0===n?void 0:n.id),name:"text",placeholder:"Enter geometry title",onChange:e=>{const t=e.target.value.trim();this.props.onChangeGeometryTitle(t||g)},type:"text"}))),(null===(r=this.props.selected)||void 0===r||null===(a=r.properties)||void 0===a?void 0:a.isText)&&s().createElement("div",{style:{padding:8}},s().createElement(E.FormGroup,null,s().createElement(E.FormGroup,{validationState:null!==(i=this.props.selected)&&void 0!==i&&i.properties.valueText?null:"error"},s().createElement(E.ControlLabel,null,s().createElement(T.Z,{msgId:"annotations.editor.text"})),s().createElement(E.FormControl,{value:(null===(l=this.props.selected)||void 0===l||null===(p=l.properties)||void 0===p?void 0:p.valueText)||"",name:"text",placeholder:"text value",onChange:e=>{var t,o,n,s;const r=e.target.value,a=null!==(t=this.props)&&void 0!==t&&null!==(o=t.selected)&&void 0!==o&&null!==(n=o.geometry)&&void 0!==n&&null!==(s=n.coordinates)&&void 0!==s&&s.length?(0,C.OQ)(this.props.selected.geometry):[];this.validateText(a,r)||""!==r?this.props.onChangeText(r,a.map(C.bh)):(this.props.onChangeText("",a.map(C.bh)),this.props.onSetInvalidSelected("text",a.map(C.bh)))},type:"text"})))),s().createElement(E.Nav,{bsStyle:"tabs",activeKey:this.state.tabValue,justified:!0},this.isMeasureEditDisabled()&&s().createElement(E.NavItem,{key:"coordinates",eventKey:"coordinates",onClick:()=>{this.setTabValue("coordinates"),this.props.onStyleGeometry(!1)}},s().createElement(T.Z,{msgId:"annotations.tabCoordinates"})),s().createElement(E.NavItem,{key:"style",eventKey:"style",onClick:()=>{this.setTabValue("style"),this.props.onStyleGeometry(!0)}},s().createElement(T.Z,{msgId:"annotations.tabStyle"}))),s().createElement("div",{className:"tab-container"},"coordinates"===this.state.tabValue&&s().createElement(tt,{options:this.props.config&&this.props.config.geometryEditorOptions,drawing:this.props.drawing,aeronauticalOptions:this.props.aeronauticalOptions,selected:this.props.selected,featureType:this.props.featureType,format:this.props.format,mapProjection:this.props.mapProjection,onChange:this.props.onChangeSelected,onChangeRadius:this.props.onChangeRadius,onChangeFormat:this.props.onChangeFormat,onHighlightPoint:this.props.onHighlightPoint,onSetInvalidSelected:this.props.onSetInvalidSelected,onChangeText:this.props.onChangeText,renderer:"annotations",onValidateFeature:this.props.onValidateFeature}),"style"===this.state.tabValue&&s().createElement(Ae,{onChangeStyle:e=>{this.props.onSetStyle(e),this.props.onSetUnsavedStyle(!0),this.props.onSetUnsavedChanges(!0)},pointType:this.props.pointType,style:this.props.selected&&this.props.selected.style||this.props.editing.style,width:this.props.width,symbolsPath:this.props.symbolsPath,onSetErrorSymbol:this.props.onSetErrorSymbol,symbolErrors:this.props.symbolErrors,onUpdateSymbols:this.props.onUpdateSymbols,symbolList:this.props.symbolList,defaultShape:this.props.defaultShape,defaultShapeSize:this.props.defaultShapeSize,defaultShapeFillColor:this.props.defaultShapeFillColor,defaultShapeStrokeColor:this.props.defaultShapeStrokeColor,defaultStyles:this.props.defaultStyles,lineDashOptions:this.props.lineDashOptions,markersOptions:this.getConfig(),textRotationStep:this.props.textRotationStep}))))}}st(rt,"displayName","AnnotationsEditor"),st(rt,"propTypes",{id:l().string,onEdit:l().func,onCancelEdit:l().func,onCancelStyle:l().func,onCleanHighlight:l().func,onHighlight:l().func,onAddText:l().func,onCancel:l().func,onConfirmDeleteFeature:l().func,onRemove:l().func,onSave:l().func,onSaveStyle:l().func,onError:l().func,onAddGeometry:l().func,onToggleUnsavedChangesModal:l().func,onToggleUnsavedGeometryModal:l().func,onToggleUnsavedStyleModal:l().func,onToggleDeleteFtModal:l().func,onSetUnsavedChanges:l().func,onSetUnsavedStyle:l().func,onChangeProperties:l().func,onChangeSelected:l().func,onConfirmClose:l().func,onCancelRemove:l().func,onConfirmRemove:l().func,onChangeRadius:l().func,onChangeText:l().func,onChangeGeometryTitle:l().func,onCancelClose:l().func,onSetInvalidSelected:l().func,onDeleteGeometry:l().func,onAddNewFeature:l().func,onStyleGeometry:l().func,onResetCoordEditor:l().func,onHighlightPoint:l().func,onSetStyle:l().func,onStartDrawing:l().func,onZoom:l().func,editing:l().object,editedFields:l().object,drawingText:l().object,drawing:l().bool,unsavedChanges:l().bool,unsavedGeometry:l().bool,unsavedStyle:l().bool,mouseHoverEvents:l().bool,coordinateEditorEnabled:l().bool,styling:l().bool,closing:l().bool,removing:l().bool,errors:l().object,stylerType:l().string,featureType:l().string,showBack:l().bool,showEdit:l().bool,showUnsavedChangesModal:l().bool,showUnsavedStyleModal:l().bool,showDeleteFeatureModal:l().bool,showUnsavedGeometryModal:l().bool,config:l().object,feature:l().object,features:l().object,selected:l().object,mode:l().string,maxZoom:l().number,width:l().number,onDownload:l().func,onChangeFormat:l().func,onSelectFeature:l().func,mapProjection:l().string,format:l().string,aeronauticalOptions:l().object,onDeleteFeature:l().func,pointType:l().string,symbolsPath:l().string,onUpdateSymbols:l().func,onSetErrorSymbol:l().func,symbolErrors:l().array,lineDashOptions:l().array,symbolList:l().array,defaultShape:l().string,defaultShapeSize:l().number,defaultShapeFillColor:l().string,defaultShapeStrokeColor:l().string,defaultStyles:l().object,textRotationStep:l().number,onSetAnnotationMeasurement:l().func,onFilterMarker:l().func,annotations:l().array,measurementAnnotationEdit:l().bool,geodesic:l().bool,onHideMeasureWarning:l().func,showAgain:l().bool,showPopupWarning:l().bool,onToggleShowAgain:l().func,onInitPlugin:l().func,onGeometryHighlight:l().func,onUnSelectFeature:l().func,onValidateFeature:l().func}),st(rt,"defaultProps",{config:Be,errors:{},selected:null,editedFields:{},showBack:!1,showEdit:!0,coordinateEditorEnabled:!1,feature:{},maxZoom:18,format:"decimal",pointType:"marker",stylerType:"marker",annotations:[],measurementAnnotationEdit:!1,geodesic:!0,onInitPlugin:()=>{}});const at=rt;var it=o(549995),lt=o.n(it),pt=o(3674),dt=o.n(pt),ct=o(252628),ht=o.n(ct),mt=o(756435),ut=o(768977),gt=o(89518),yt=o(882702),ft=o(855033),bt=o.n(ft),vt=o(472986),Et=o.n(vt),St=o(685476),Ct=o(283604);function wt(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}class Tt extends s().Component{constructor(){super(...arguments),wt(this,"state",{override:!1,loading:!1}),wt(this,"renderError",(()=>s().createElement("div",{className:"ms-alert-center text-center"},s().createElement("div",{className:"alert alert-danger",role:"alert",style:{margin:15,flex:1}},s().createElement(T.Z,{msgId:this.state.error}))))),wt(this,"setError",(()=>{this.setState((()=>({error:this.props.errorMessage,loading:!1})))})),wt(this,"checkfile",(e=>{this.setState((()=>({loading:!0}))),yt.Promise.all(e.map((e=>(0,St.UC)(e)))).then((e=>{this.state.error&&this.setState((()=>({error:null})));const t=e.filter((e=>{let{geoJSON:t,errors:o=[]}=e;return 0===o.length||t.type===C.Mc})).reduce(((e,t)=>{let{geoJSON:o}=t;return e.concat(o.features||o)}),[]);if(0===t.length)throw new Error;this.props.onFileChoosen(t,this.state.override),this.setState((()=>({loading:!1}))),this.props.onClose()})).catch((()=>{this.setError()}))}))}render(){return s().createElement(Ct.Z,{title:this.props.title,bodyClassName:"ms-flex",show:this.props.show,showClose:!0,onClose:this.props.onClose,size:"sm"},s().createElement("div",{className:"",style:{flexDirection:"column"}},this.state.error&&this.renderError(),s().createElement(bt(),{onDropRejected:this.checkfile,rejectClassName:"ms-alert ms-alert-center text-center alert-danger",className:"ms-alert ms-alert-center text-center",onDrop:this.checkfile},s().createElement("div",{className:"alert alert-info",role:"alert",style:{margin:15,flex:1}},this.state.loading&&s().createElement(Et(),{spinnerName:"circle",overrideSpinnerClassName:"spinner"}),this.props.text)),s().createElement("div",{style:{margin:15,flex:1}},s().createElement(E.Checkbox,{disabled:this.props.disableOvveride,checked:this.state.override,onChange:()=>this.setState((()=>({override:!this.state.override})))},s().createElement(T.Z,{msgId:"annotations.loadoverride"})))))}}wt(Tt,"propTypes",{show:l().bool,text:l().oneOfType([l().string,l().element]),onFileChoosen:l().func,error:l().oneOfType([l().string,l().element]),errorMessage:l().string,onClose:l().func,title:l().node,closeGlyph:l().string,disableOvveride:l().bool}),wt(Tt,"contextTypes",{messages:l().object}),wt(Tt,"defaultProps",{show:!1,text:s().createElement(T.Z,{msgId:"annotations.selectfiletext"}),onFileChoosen:()=>{},onClose:()=>{},closeGlyph:"",errorMessage:"annotations.loaderror",title:s().createElement(T.Z,{msgId:"annotations.loadtitle"}),disableOvveride:!1});const xt=Tt;var Pt=o(23888);function kt(){return kt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},kt.apply(this,arguments)}function Ot(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}class Mt extends s().Component{constructor(){super(...arguments),Ot(this,"state",{selectFile:!1}),Ot(this,"getConfig",(()=>a()({},Be,this.props.config))),Ot(this,"renderField",((e,t)=>s().createElement("div",{className:"mapstore-annotations-panel-card-"+e.name},this.renderFieldValue(e,t)))),Ot(this,"renderFieldValue",((e,t)=>{const o=t.properties[e.name]||"";var n,s;return"html"===e.type?(null===(n=(new DOMParser).parseFromString(o,"text/html").documentElement.lastElementChild)||void 0===n||null===(s=n.firstChild)||void 0===s?void 0:s.textContent)||"":o})),Ot(this,"renderThumbnail",(e=>{let{featureType:t,geometry:o,properties:n={}}=e;return"Measure"===(null==n?void 0:n.type)?s().createElement("span",{className:"mapstore-annotations-panel-card"},s().createElement(E.Glyphicon,{glyph:"1-ruler"})):"LineString"===t||"MultiLineString"===t?s().createElement("span",{className:"mapstore-annotations-panel-card"},s().createElement(E.Glyphicon,{glyph:"polyline"}),";"):"Polygon"===t||"MultiPolygon"===t?s().createElement("span",{className:"mapstore-annotations-panel-card"},s().createElement(E.Glyphicon,{glyph:"polygon"}),";"):"Circle"===t?s().createElement("span",{className:"mapstore-annotations-panel-card"},s().createElement(E.Glyphicon,{glyph:"1-circle"}),";"):"GeometryCollection"===t||"FeatureCollection"===t?s().createElement("span",{className:"mapstore-annotations-panel-card"},(!!(o.geometries||o.features||[]).filter((e=>"MultiPoint"!==e.type)).length||n.textValues&&n.textValues.length)&&this.getGeomsThumbnail(o)):s().createElement("span",{className:"mapstore-annotations-panel-card"},s().createElement(E.Glyphicon,{glyph:"point"}),";")})),Ot(this,"renderItems",(e=>{const{features:t,properties:o}=e,n={onMouseEnter:()=>{this.props.onHighlight(o.id)},onMouseLeave:this.props.onCleanHighlight,onClick:()=>this.props.onEdit(o.id)},r=!(o&&!v()(o.visibility))||o.visibility;return{...this.getConfig().fields.reduce(((t,o)=>a()({},t,{[o.name]:this.renderField(o,e)})),{}),preview:this.renderThumbnail({featureType:"FeatureCollection",geometry:{features:t},properties:o}),tools:s().createElement(k.Z,{btnDefaultProps:{className:"square-button-md no-border"},btnGroupProps:{style:{margin:10,whiteSpace:"nowrap"}},buttons:[{glyph:"zoom-to",tooltipId:"annotations.zoomTo",onClick:t=>{t.stopPropagation();const o=Ve()(e);this.props.onZoom(o,"EPSG:4326",this.props.maxZoom)}},{glyph:r?"eye-open":"eye-close",tooltipId:r?"annotations.hide":"annotations.show",onClick:e=>{e.stopPropagation(),this.props.onToggleVisibility(null==o?void 0:o.id)}}]}),...n}})),Ot(this,"renderCards",(()=>{if(this.props.loading)return s().createElement("div",{style:{display:"flex",height:"100%",justifyContent:"center",alignItems:"center"}},s().createElement(gt.Z,{size:250}));if("list"===this.props.mode){const e=!!this.props.annotations.length;return s().createElement(s().Fragment,null,s().createElement("div",{style:{display:"flex",margin:"auto",justifyContent:"center"},className:"text-center"},s().createElement(k.Z,{btnDefaultProps:{className:"square-button-md",bsStyle:"primary"},buttons:[{glyph:"upload",tooltip:s().createElement(T.Z,{msgId:"annotations.loadtooltip"}),visible:"list"===this.props.mode,onClick:()=>{this.setState((()=>({selectFile:!0})))}},{glyph:"plus",tooltip:s().createElement(T.Z,{msgId:"annotations.add"}),visible:"list"===this.props.mode,onClick:()=>{this.props.onAdd()}},{glyph:"download",disabled:!e,tooltip:s().createElement(T.Z,{msgId:"annotations.downloadtooltip"}),visible:"list"===this.props.mode,onClick:()=>{this.props.onDownload()}}]})),s().createElement("div",{style:{padding:"0 8px",margin:"10px 0 0"}},s().createElement(te.Z,{filterPlaceholder:(0,Oe.S$)(this.context.messages,"annotations.filter"),filterText:this.props.filter,onFilter:this.props.onFilter})),s().createElement("div",{id:"ms-annotations-panel-card",className:!e&&"annotations-empty-panel"},!e&&s().createElement(T.Z,{msgId:"annotations.empty"}),e&&s().createElement(ut.Z,{size:"sm",items:this.props.annotations&&this.props.annotations.filter(this.applyFilter).map((e=>this.renderItems(e)))})))}const e=this.props.annotations&&g()(this.props.annotations.filter((e=>e.properties.id===this.props.current))),t=this.props.editor;return"detail"===this.props.mode?s().createElement(t,kt({feature:e,geodesic:this.props.geodesic,showBack:!0,id:this.props.current,config:this.props.config,width:this.props.width},e.properties)):this.props.editing&&s().createElement(t,kt({feature:e,id:this.props.editing.properties&&this.props.editing.properties.id||z()(),width:this.props.width,config:this.props.config},this.props.editing.properties,{lineDashOptions:this.props.lineDashOptions,symbolsPath:this.props.symbolsPath,onUpdateSymbols:this.props.onUpdateSymbols,onSetErrorSymbol:this.props.onSetErrorSymbol,symbolErrors:this.props.symbolErrors,symbolList:this.props.symbolList,defaultShape:this.props.defaultShape,defaultShapeSize:this.props.defaultShapeSize,defaultShapeFillColor:this.props.defaultShapeFillColor,defaultShapeStrokeColor:this.props.defaultShapeStrokeColor,defaultStyles:this.props.defaultStyles,textRotationStep:this.props.textRotationStep,annotations:this.props.annotations,measurementAnnotationEdit:this.props.measurementAnnotationEdit,geodesic:this.props.geodesic}))})),Ot(this,"applyFilter",(e=>!this.props.filter||this.getConfig().fields.reduce(((t,o)=>-1!==(e.properties[o.name]||"").toUpperCase().indexOf(this.props.filter.toUpperCase())||t),!1)))}componentDidMount(){this.props.onLoadDefaultStyles(this.props.defaultShape,this.props.defaultShapeSize,this.props.defaultShapeFillColor,this.props.defaultShapeStrokeColor,this.props.symbolsPath)}getGeomsThumbnail(e){var t;let o;const n=null==e?void 0:e.features.reduce(((e,t)=>t.properties&&t.properties.isCircle?{...e,Circle:!0}:t.properties&&t.properties.isText?{...e,Text:!0}:{...e,[t.geometry.type]:!0}),{Circle:!1,Text:!1});if((null===(t=lt()(ht()(n)))||void 0===t?void 0:t.true)>1)o="geometry-collection";else{var r;const e=dt()(n).find((e=>!0===n[e]));o=null===(r=(0,C.XL)(e))||void 0===r?void 0:r.glyph}return s().createElement(E.Glyphicon,{glyph:o})}renderHeader(){return s().createElement("div",{style:this.props.styling||{width:"100%"}},s().createElement("div",{style:{display:"flex",alignItems:"center"}},s().createElement("div",null,s().createElement(Pt.Z,{className:"square-button no-border",onClick:this.props.toggleControl},s().createElement(E.Glyphicon,{glyph:"1-close"}))),s().createElement("div",{style:{flex:"1 1 0%",padding:8,textAlign:"center"}},s().createElement("h4",null,s().createElement(T.Z,{msgId:"annotations.title"}))),s().createElement("div",null,s().createElement(Pt.Z,{className:"square-button no-events"},s().createElement(E.Glyphicon,{glyph:"comment"})))))}render(){let e;return e=this.state.selectFile?s().createElement(xt,{text:s().createElement(T.Z,{msgId:"annotations.selectfiletext"}),onFileChoosen:this.props.onLoadAnnotations,show:this.state.selectFile,disableOvveride:!(this.props.annotations&&this.props.annotations.length>0),onClose:()=>this.setState((()=>({selectFile:!1})))}):s().createElement("span",null," ",this.renderCards()," "),s().createElement(mt.Z,{id:this.props.id,header:this.renderHeader()},e)}}Ot(Mt,"propTypes",{id:l().string,styling:l().bool,toggleControl:l().func,loading:l().bool,closing:l().bool,showUnsavedChangesModal:l().bool,showUnsavedStyleModal:l().bool,editing:l().object,removing:l().object,onCancelRemove:l().func,onConfirmRemove:l().func,onCancelClose:l().func,onToggleUnsavedChangesModal:l().func,onToggleUnsavedStyleModal:l().func,onResetCoordEditor:l().func,onAddNewFeature:l().func,onToggleUnsavedGeometryModal:l().func,onConfirmClose:l().func,onCancelEdit:l().func,onCancelStyle:l().func,onAdd:l().func,onZoom:l().func,onHighlight:l().func,onCleanHighlight:l().func,onDetail:l().func,mode:l().string,editor:l().func,annotations:l().array,current:l().string,config:l().object,filter:l().string,onFilter:l().func,classNameSelector:l().func,width:l().number,onDownload:l().func,onLoadAnnotations:l().func,onUpdateSymbols:l().func,onSetErrorSymbol:l().func,onToggleVisibility:l().func,onEdit:l().func,symbolErrors:l().array,lineDashOptions:l().array,symbolList:l().array,defaultShape:l().string,symbolsPath:l().string,maxZoom:l().number,defaultShapeSize:l().number,defaultShapeFillColor:l().string,defaultShapeStrokeColor:l().string,defaultStyles:l().object,onLoadDefaultStyles:l().func,textRotationStep:l().number,measurementAnnotationEdit:l().bool,geodesic:l().bool}),Ot(Mt,"contextTypes",{messages:l().object}),Ot(Mt,"defaultProps",{mode:"list",config:Be,classNameSelector:()=>"",toggleControl:()=>{},onUpdateSymbols:()=>{},onSetErrorSymbol:()=>{},onLoadAnnotations:()=>{},annotations:[],maxZoom:18,onLoadDefaultStyles:()=>{}});const Ft=Mt;var Zt=o(712535),jt=o(172768),Nt=o(49977),It=o.n(Nt),At=o(178598),Gt=o(926854),Ut=o(333101),Dt=o(976719),Bt=o(504518),Rt=o(917450),Vt=o(296252),Lt=o(351546),zt=o(30206),Wt=o(274363),Ht=o(612912),_t=o(546821),Yt=o.n(_t),$t=o(502422);const qt=e=>{let t=e.features.map((e=>{let t=[];return e.geometry?("LineString"===e.geometry.type||"MultiPoint"===e.geometry.type?t=e.geometry.coordinates.filter(C.qs):"Polygon"===e.geometry.type?t=e.geometry.coordinates[0]?[e.geometry.coordinates[0].filter(C.qs)]:[[]]:(t=[e.geometry.coordinates].filter(C.qs),t=t.length?t[0]:[]),(0,W.t8)("geometry.coordinates",t,e)):e}));return(0,W.t8)("features",t,e)},Qt=e=>_e()(e.annotations,"config.geodesic",!1),Xt=e=>{let t=e.annotations.editing;const o={featureProjection:"EPSG:4326",stopAfterDrawing:!(0,zt._o)(e),editEnabled:!1,selectEnabled:!0,drawEnabled:!1,translateEnabled:!1,transformToFeatureCollection:!0,geodesic:Qt(e)};return t=qt(t),(0,Vt.Yf)("drawOrEdit",e.draw.drawMethod,C.jB,[t],o,a()({},t.style,{highlight:!1}))},Jt=e=>{let t=e.annotations.editing;const o={featureProjection:"EPSG:4326",stopAfterDrawing:!(0,zt._o)(e),editEnabled:!1,selectEnabled:!1,translateEnabled:!1,drawEnabled:!1,transformToFeatureCollection:!0,geodesic:Qt(e)};return t=qt(t),(0,Vt.Yf)("drawOrEdit",e.draw.drawMethod,C.jB,[t],o,t.style)},Kt=e=>{let t=e.annotations.editing;const o={featureProjection:"EPSG:4326",stopAfterDrawing:!(0,zt._o)(e),editEnabled:!0,selectEnabled:!1,drawEnabled:!1,editFilter:e=>e.getProperties().canEdit,translateEnabled:!1,addClickCallback:!0,useSelectedStyle:!0,transformToFeatureCollection:!0,geodesic:Qt(e)};return t=qt(t),(0,Vt.Yf)("drawOrEdit",e.draw.drawMethod,C.jB,[t],o,t.style)},eo=e=>"FeatureCollection"===e[0].type?e[0]:e.reduce(((e,t)=>"Empty"===e.type?"FeatureCollection"===t.type?eo(t.features):t.geometry:"Point"===e.type?{type:"MultiPoint",coordinates:[e.coordinates,t.geometry.coordinates]}:{type:"MultiPoint",coordinates:e.coordinates.concat([t.geometry.coordinates])}),{type:"Empty"}),to=e=>({type:"FeatureCollection",properties:a()({},e.properties,e.fields,{id:e.id},{visibility:!0}),features:e.geometry,style:a()({},e.style,{highlight:!1})}),oo={addAnnotationsLayerEpic:(e,t)=>e.ofType(Gt.ok).switchMap((()=>{const e=(0,zt.sB)(t.getState());if(e){const{visibility:t=!1,features:o=[]}=e;let n=o.map((e=>({...e,style:{},features:(e.features||[]).map((t=>{let o=(t.properties.isCircle?"Circle":t.properties.isText&&"Text")||t.geometry.type,n=[];return"Circle"===o&&n.push({...C.z4.Point,iconAnchor:[.5,.5],type:"Point",title:"Center Style",filtering:!1,geometry:"centerPoint"}),"LineString"===o&&n.push((0,C.N_)()),{...t,style:me()(t.style)?t.style.map((e=>{const{symbolUrlCustomized:t,...o}=e;return o})):[{...e.style[o],id:e.style[o].id||z()(),symbolUrlCustomized:void 0}].concat(n)}}))})));return It().Observable.of((0,Ut.tV)(C.jB,"layer",{features:n,style:{},visibility:t}))}return It().Observable.empty()})),editAnnotationEpic:(e,t)=>e.ofType(jt.A1).switchMap((()=>{var e,o;const n=t.getState(),s=n.annotations.editing,r=n.annotations.featureType,i={featureProjection:"EPSG:4326",stopAfterDrawing:!(0,zt._o)(n),editEnabled:!1,selectEnabled:!0,drawEnabled:!1,transformToFeatureCollection:!0,geodesic:Qt(n)},l=(null===(e=s.properties)||void 0===e?void 0:e.type)===w.zE||!1;let p=[(0,jt.r1)(null==s||null===(o=s.properties)||void 0===o?void 0:o.id,!1),(0,Vt.Yf)("drawOrEdit",r,C.jB,[s],i,a()({},s.style,{highlight:!1})),(0,Rt.aN)()];return p=l?p.concat((0,Dt.Bd)({geomType:null})):p,It().Observable.from(p)})),newAnnotationEpic:e=>e.ofType(jt.CD).switchMap((()=>It().Observable.from([(0,Rt.aN)()]))),addAnnotationEpic:(e,t)=>e.ofType(jt.NV).switchMap((()=>{var e;const o=t.getState().annotations.editing;return It().Observable.from([(0,jt.r1)(null==o||null===(e=o.properties)||void 0===e?void 0:e.id,!1),Xt(t.getState()),(0,Rt.aN)()])})),setEditingFeatureEpic:(e,t)=>e.ofType(jt.Ns).switchMap((e=>{const{properties:o,visibility:n}=e.feature||{};return It().Observable.of((0,jt.r1)(o.id,n),Xt(t.getState()),(0,Rt.aN)())})),disableInteractionsEpic:(e,t)=>e.ofType(jt.Ge).switchMap((()=>{const e=t.getState()&&t.getState().annotations&&t.getState().annotations.styling;return It().Observable.from([e?Jt(t.getState()):Kt(t.getState())])})),removeAnnotationEpic:(e,t)=>e.ofType(jt.c4).switchMap((e=>{if("geometry"===e.attribute){let e=t.getState(),{editing:o}=(0,C.HG)(e.annotations.selected,e.annotations.editing);const n=e.annotations.featureType,s={featureProjection:"EPSG:4326",stopAfterDrawing:!(0,zt._o)(e),editEnabled:!0,drawEnabled:!1,selectEnabled:!0,editFilter:e=>e.getProperties().canEdit,useSelectedStyle:!0,transformToFeatureCollection:!0,addClickCallback:!0,geodesic:Qt(e)};return It().Observable.from([(0,Vt.Yf)("replace",n,C.jB,[o],{}),(0,Vt.Yf)("drawOrEdit",n,C.jB,[o],s,a()({},o.style,{highlight:!1}))])}const o=(0,zt.sB)(t.getState()).features.filter((t=>t.properties.id!==e.id));return It().Observable.from([(0,Ut.tV)(C.jB,"layer",{features:o}),(0,Rt.aN)(),(0,Rt.g)(),(0,Rt.Mc)()].concat(0===o.length?[(0,Ut.$o)(C.jB)]:[]))})),openEditorEpic:e=>e.ofType(jt.Mf).switchMap((e=>It().Observable.from([(0,Rt.Mc)(),(0,m.Xg)(C.jB,"enabled",!0),(0,jt.MQ)(e.id),(0,jt.VR)(e.id)]))),saveAnnotationEpic:(e,t)=>e.ofType(jt.Lv).switchMap((e=>{var o;const n=g()(t.getState().layers.flat.filter((e=>e.id===C.jB))),s=e.geometry;return It().Observable.from((n?[(0,Ut.tV)(C.jB,"layer",{features:(0,zt.sB)(t.getState()).features.map((t=>a()({},t,{properties:t.properties.id===e.id?a()({},t.properties,e.properties,e.fields):t.properties,features:t.properties.id===e.id?s:t.features,style:t.properties.id===e.id?e.style:t.style}))).concat(e.newFeature?[to(e)]:[]),visibility:!v()(null==e||null===(o=e.properties)||void 0===o?void 0:o.visibility)&&e.properties.visibility})]:[(0,Ut.A4)({type:"vector",visibility:!0,id:C.jB,name:"Annotations",hideLoading:!0,style:e.style,features:[to(e)],handleClickOnLayer:!0})]).concat([(0,Vt.Yf)("clean",t.getState().annotations.featureType||"",C.jB,[],{}),...e.newFeature?[(0,jt.r1)(e.id,!0)]:[]]))})),cancelEditAnnotationEpic:(e,t)=>e.ofType(jt.hv).switchMap((e=>{const{id:o,visibility:n}=(null==e?void 0:e.properties)||{};return It().Observable.from([(0,Vt.Yf)("clean",t.getState().annotations.featureType||"",C.jB,[],{}),(0,jt.r1)(o,n)])})),purgeMapInfoEpic:(e,t)=>e.ofType(Rt.DZ).filter((()=>_e()(t.getState(),"draw.drawOwner","")===C.jB)).switchMap((()=>It().Observable.from([(0,Vt.Yf)("clean",t.getState().annotations.featureType||"",C.jB,[],{})]))),startDrawingMultiGeomEpic:(e,t)=>e.ofType(jt.Np).filter((()=>t.getState().annotations.editing.features&&!!t.getState().annotations.editing.features.length||"Circle"===t.getState().annotations.featureType)).switchMap((()=>{const e=t.getState(),o=e.annotations.editing,n=e.annotations.featureType,s=e.annotations.defaultTextAnnotation,r={featureProjection:"EPSG:4326",stopAfterDrawing:!zt._o,editEnabled:"Circle"!==n,translateEnabled:!1,drawEnabled:"Circle"===n,useSelectedStyle:!0,editFilter:e=>e.getProperties().canEdit,defaultTextAnnotation:s,transformToFeatureCollection:!0,addClickCallback:!0,geodesic:Qt(e)};return It().Observable.of((0,Vt.Yf)("drawOrEdit",n,C.jB,[o],r,a()({},o.style,{highlight:!1})))})),endDrawGeomEpic:(e,t)=>e.ofType(Vt.DI).filter((e=>e.owner===C.jB)).switchMap((e=>It().Observable.from([(0,jt.nY)(eo(e.features),e.textChanged,e.circleChanged)].concat(!(0,zt._o)(t.getState())&&t.getState().annotations.drawing?[(0,jt.kg)()]:[])))),setAnnotationStyleEpic:(e,t)=>e.ofType(jt.sL).switchMap((()=>{const e=qt(t.getState().annotations.editing).features,o=t.getState().annotations.selected;let n=A()(e,(e=>e.properties.id===o.properties.id)),s=(0,Lt.reprojectGeoJson)(n,"EPSG:4326","EPSG:3857");return It().Observable.from([(0,Vt.Yf)("updateStyle",t.getState().annotations.featureType,C.jB,[s],{},a()({},o.style,{highlight:!1}))])})),restoreStyleEpic:(e,t)=>e.ofType(jt.B6).switchMap((()=>{const{styling:e,editing:o}=t.getState().annotations,{style:n,...s}=o;return It().Observable.from([(0,Vt.Yf)("replace",t.getState().annotations.featureType,C.jB,[s],{},n),(0,jt.A_)(t.getState().annotations.originalStyle),Xt(t.getState()),(0,jt.ob)(!e)])})),highlightAnnotationEpic:(e,t)=>e.ofType(jt.X2).switchMap((e=>It().Observable.of((0,Ut.tV)(C.jB,"layer",{features:(0,zt.sB)(t.getState()).features.map((t=>t.properties.id===e.id?a()({},t,{features:t.features&&t.features.length&&t.features.map((e=>a()({},e,{style:Z()(e.style).map((e=>a()({},e,{highlight:!0})))})))||[]}):t))})))),showHideAnnotationEpic:(e,t)=>e.ofType(jt.cM,Ut.yS).filter((e=>e.type===Ut.yS&&e.layer===C.jB&&!v()(e.newProperties.visibility)||e.type===jt.cM)).switchMap((e=>{const o=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return a()({},e,{properties:{...e.properties,visibility:t}})},n=t.getState();let s=e.layer===C.jB;const r=(0,zt.sB)(n),i=!c()((0,zt.cM)(n));if(!c()(r)){var l,p;let t=(r.features||[]).map((e=>({...e,properties:{...e.properties,visibility:!!v()(e.properties.visibility)||e.properties.visibility}})));t=t.map((t=>{var n;return s?o(t,null==e||null===(n=e.newProperties)||void 0===n?void 0:n.visibility):t.properties.id===e.id?o(t,v()(e.visibility)?!t.properties.visibility:e.visibility):t}));const n=!(null===(l=t)||void 0===l||null===(p=l.filter((e=>e.properties.visibility)))||void 0===p||!p.length);return It().Observable.of((0,Ut.tV)(C.jB,"layer",{features:t,...!i&&{visibility:n}}))}return It().Observable.empty()})),hideAnnotationGroupEpic:(e,t)=>e.ofType(Ut.ms).filter((e=>{const o=g()(((0,Ht.Bt)(t.getState())||[]).filter((t=>t.id===e.group)));return-1!==U()(o.nodes,(e=>e.id===C.jB))&&!v()(e.newProperties.visibility)})).switchMap((e=>{const o=t.getState(),n=(0,zt.sB)(o);if(!c()(n)&&!c()(n.features)){const t=n.features.map((t=>({...t,properties:{...t.properties,visibility:e.newProperties.visibility}})));return It().Observable.of((0,Ut.tV)(C.jB,"layer",{features:t}))}return It().Observable.empty()})),cleanHighlightAnnotationEpic:(e,t)=>e.ofType(jt.dC).switchMap((()=>{const e=(0,zt.sB)(t.getState());return e&&e.features&&e.features.length?It().Observable.of((0,Ut.tV)(C.jB,"layer",{features:e.features.map((e=>a()({},e,{features:e.features&&e.features.length&&e.features.map((e=>a()({},e,{style:Z()(e.style).map((e=>a()({},e,{highlight:!1})))})))||[]})))})):It().Observable.empty()})),tearDownByDrawingToolsEpic:(e,t)=>(0,$t.U)(e,t,"annotations",(()=>It().Observable.of((0,Rt.g)()))),closeAnnotationsEpic:(e,t)=>e.ofType(m.kM).filter((e=>e.control===C.jB&&!t.getState().controls.annotations.enabled)).switchMap((()=>{var e;return It().Observable.from([(0,jt.Rx)(),(0,Vt.Yf)("clean",(null===(e=t.getState().annotations)||void 0===e?void 0:e.featureType)||"",C.jB,[],{})])})),confirmCloseAnnotationsEpic:(e,t)=>e.ofType(jt.bI).switchMap((e=>{const{id:o,visibility:n}=(null==e?void 0:e.properties)||{};return It().Observable.from((t.getState().controls.annotations&&t.getState().controls.annotations.enabled?[(0,m.Xi)(C.jB),(0,jt.r1)(o,n)]:[]).concat([(0,Rt.g)()]))})),downloadAnnotations:(e,t)=>{let{getState:o}=t;return e.ofType(jt.HN).switchMap((e=>{let{annotation:t}=e;try{const e=t&&[t]||(0,zt.sB)(o()).features,n=(0,Wt.Zs)(o());return(0,At.saveAs)(new Blob([JSON.stringify({features:e,type:C.Mc})],{type:"application/json;charset=utf-8"}),`${n.length>0&&n||"Annotations"}.json`),It().Observable.empty()}catch(e){return It().Observable.of((0,Bt.vU)({title:"annotations.title",message:"annotations.downloadError",autoDismiss:5,position:"tr"}))}}))},onLoadAnnotations:(e,t)=>{let{getState:o}=t;return e.ofType(jt.Bm).switchMap((e=>{let{features:t,override:n}=e;const s=(0,zt.sB)(o()),{messages:r={}}=o().locale||{},a=s&&s.features||[],i=t.map((e=>(0,C.TW)(e,r))),l=n?i:a.concat(i),p=s?(0,Ut.tV)(C.jB,"layer",{features:(0,C.be)(l)}):(0,Ut.A4)({type:"vector",visibility:!0,id:C.jB,name:"Annotations",hideLoading:!0,features:l,handleClickOnLayer:!0});return It().Observable.of(p)}))},onChangedSelectedFeatureEpic:(e,t)=>{let{getState:o}=t;return e.ofType(jt.Kz).switchMap((e=>{var t,n;let{}=e;const s=o();let{selected:r,editing:i}=(0,C.HG)(s.annotations.selected,s.annotations.editing),l=r.geometry.type;null!==(t=r.properties)&&void 0!==t&&t.isCircle&&(l="Circle"),null!==(n=r.properties)&&void 0!==n&&n.isText&&(l="Text");const p=(0,zt._o)(s),d=i.style,c=(0,Vt.Yf)("drawOrEdit",l,C.jB,[i],{featureProjection:"EPSG:4326",stopAfterDrawing:!p,editEnabled:!0,translateEnabled:!1,editFilter:e=>e.getProperties().canEdit,useSelectedStyle:!0,drawEnabled:!1,transformToFeatureCollection:!0,addClickCallback:!0,geodesic:Qt(s)},a()({},d,{highlight:!1}));return It().Observable.of(c)}))},onBackToEditingFeatureEpic:(e,t)=>{let{getState:o}=t;return e.ofType(jt.gT,jt.op,jt.cv).switchMap((e=>{let{}=e;const t=o(),n=t.annotations.editing,s=(0,zt._o)(t),r=n.style,i=(0,Vt.Yf)("drawOrEdit","",C.jB,[n],{featureProjection:"EPSG:4326",stopAfterDrawing:!s,editEnabled:!1,drawEnabled:!1,selectEnabled:!0,transformToFeatureCollection:!0},a()({},r,{highlight:!1}));return It().Observable.of(i)}))},redrawOnChangeTextEpic:(e,t)=>{let{getState:o}=t;return e.ofType(jt.CO).switchMap((()=>{const e=o();let t=e.annotations.editing,n=e.annotations.selected;const s=(0,zt._o)(e),r=t.style;n=(0,W.t8)("geometry.coordinates",[n.geometry.coordinates].filter(C.qs)[0]||[],n),n=(0,W.t8)("geometry.type","Point",n);let i=U()(t.features,(e=>e.properties.id===n.properties.id));(0,C.qs)(n.geometry.coordinates)?t=-1===i?(0,W.t8)("features",t.features.concat([n]),t):(0,W.t8)(`features[${i}]`,n,t):(n=(0,W.t8)("geometry",null,n),t=-1!==i?(0,W.t8)(`features[${i}]`,n,t):(0,W.t8)("features",t.features.concat([n]),t));const l=(0,Vt.Yf)("drawOrEdit","Text",C.jB,[t],{featureProjection:"EPSG:4326",stopAfterDrawing:!s,editEnabled:!0,translateEnabled:!1,editFilter:e=>e.getProperties().canEdit,drawEnabled:!1,useSelectedStyle:!0,transformToFeatureCollection:!0,addClickCallback:!0},a()({},r,{highlight:!1}));return It().Observable.of(l)}))},redrawOnChangeRadiusEpic:(e,t)=>{let{getState:o}=t;return e.ofType(jt.JT).switchMap((()=>{const e=o();let t=e.annotations.editing,n=e.annotations.selected;const s=(0,zt._o)(e),r=t.style;let i=U()(t.features,(e=>e.properties.id===n.properties.id));n=n.properties.isValidFeature?(0,W.t8)("geometry",n.properties.polygonGeom,n):(0,W.t8)("geometry",{type:"Polygon",coordinates:[[]]},n),t=-1===i?(0,W.t8)("features",t.features.concat([n]),t):(0,W.t8)(`features[${i}]`,n,t);const l=(0,Vt.Yf)("drawOrEdit","Circle",C.jB,[t],{featureProjection:"EPSG:4326",stopAfterDrawing:!s,editEnabled:!0,translateEnabled:!1,editFilter:e=>e.getProperties().canEdit,drawEnabled:!1,useSelectedStyle:!0,transformToFeatureCollection:!0,addClickCallback:!0,geodesic:Qt(e)},a()({},r,{highlight:!1}));return It().Observable.of(l)}))},editSelectedFeatureEpic:(e,t)=>{let{getState:o}=t;return e.ofType(Vt.iU).switchMap((()=>{const e=o(),t=e.annotations.editing,n=e.annotations.selected,s=(0,zt._o)(e),r=t.style;let i=n.geometry.type;n.properties.isCircle&&(i="Circle"),n.properties.isText&&(i="Text");const l=(0,Vt.Yf)("drawOrEdit",i,C.jB,[t],{featureProjection:"EPSG:4326",stopAfterDrawing:!s,editEnabled:!0,translateEnabled:!1,editFilter:e=>e.getProperties().canEdit,drawEnabled:!1,useSelectedStyle:!0,transformToFeatureCollection:!0,addClickCallback:!0,geodesic:Qt(e)},a()({},r,{highlight:!1}));return It().Observable.of((0,Vt.Yf)("clean"),l)}))},highlightGeometryEpic:(e,t)=>{let{getState:o}=t;return e.ofType(jt.qX).switchMap((e=>{let{id:t="",state:n=!0}=e;const s=o(),{editing:r,featureType:i}=s.annotations,l=U()(r.features,(e=>e.properties.id===t)),p=r.features[l],d=Z()(p.style).map((e=>({...e,highlight:n}))),c=(0,Vt.Yf)("updateStyle",i,C.jB,[(0,W.t8)(`features[${l}]`,(0,W.t8)("style",d,p),r)],{transformToFeatureCollection:!0},a()({},r.style,{highlight:!1}));return It().Observable.of((0,Vt.Yf)("clean"),c)}))},editCircleFeatureEpic:(e,t)=>{let{getState:o}=t;return e.ofType(Vt.W7).filter((e=>e.features[0].properties&&e.features[0].properties.isCircle)).delay(300).switchMap((()=>{const e=o(),t=e.annotations.editing,n=(0,zt._o)(e),s=t.style,r=(0,Vt.Yf)("drawOrEdit","Circle",C.jB,[t],{featureProjection:"EPSG:4326",stopAfterDrawing:!n,editEnabled:!0,translateEnabled:!1,editFilter:e=>e.getProperties().canEdit,drawEnabled:!1,useSelectedStyle:!0,transformToFeatureCollection:!0,addClickCallback:!0,geodesic:Qt(e)},a()({},s,{highlight:!1}));return It().Observable.of(r)}))},loadDefaultAnnotationsStylesEpic:(e,t)=>e.ofType(jt.it).switchMap((e=>{let{shape:o=C.xw,size:n=64,fillColor:s="#000000",strokeColor:r="#000000",symbolsPath:a=C.Fi}=e;const i=(0,zt.Cq)(t.getState())||[],l={symbol:()=>{const e={...C.j5,shape:o,size:n,fillColor:s,color:r,symbolUrl:a+o+".svg"};return It().Observable.defer((()=>M().get(e.symbolUrl).then((()=>(0,H.createSvgUrl)(e,e.symbolUrlCustomized||e.symbolUrl))))).map((t=>(0,jt.WB)("POINT.symbol",{...e,symbolUrlCustomized:t}))).catch((()=>It().Observable.of((0,jt.Y5)(i.concat(["loading_symbol"+o])),(0,jt.WB)("POINT.symbol",{...e,symbolUrlCustomized:Yt(),symbolUrl:a+o+".svg",shape:o}))))},marker:()=>It().Observable.of((0,jt.WB)("POINT.marker",C.bi))};return It().Observable.merge(...ht()(l).map((e=>e()))).startWith((0,jt.V_)(!0)).concat(It().Observable.of((0,jt.V_)(!1)))}))};var no=o(859518),so=o(350126),ro=o(726598),ao=o(908316);function io(){return io=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},io.apply(this,arguments)}function lo(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}const po={onUpdateSymbols:jt.z_,onSetErrorSymbol:jt.Y5,onEdit:jt.VR,onCancelEdit:jt.QD,onChangeFormat:jt.Zw,onConfirmDeleteFeature:jt.pv,onCleanHighlight:jt.Rx,onHighlightPoint:jt.aS,onHighlight:jt.CH,onError:jt.Bp,onSave:jt.xD,onRemove:jt._x,onAddGeometry:jt.kg,onAddText:jt.F4,onSetUnsavedChanges:jt.if,onSetUnsavedStyle:jt.tp,onChangeProperties:jt.Om,onToggleDeleteFtModal:jt.Ay,onToggleUnsavedChangesModal:jt.ts,onToggleUnsavedGeometryModal:jt.UJ,onToggleUnsavedStyleModal:jt.yw,onAddNewFeature:jt.TA,onResetCoordEditor:jt.nz,onStyleGeometry:jt.ob,onCancelStyle:jt.nk,onChangeSelected:jt.i9,onSaveStyle:jt.ob,onSetStyle:jt.A_,onStartDrawing:jt.y$,onDeleteGeometry:jt.dT,onZoom:no.Px,onSelectFeature:Vt.KD,onChangeRadius:jt.om,onSetInvalidSelected:jt.$f,onChangeText:jt.XW,onChangeGeometryTitle:jt.Dd,onCancelRemove:jt.iY,onCancelClose:jt.Hl,onConfirmClose:jt.L0,onConfirmRemove:jt.jw,onDownload:jt.LR,onFilterMarker:jt.TW,onGeometryHighlight:jt.$,onSetAnnotationMeasurement:Dt.pO,onHideMeasureWarning:jt.Y_,onToggleShowAgain:jt.Ib,onInitPlugin:jt.QT,onUnSelectFeature:jt.RC,onValidateFeature:jt._n},co=(0,h.$j)(zt.cQ,{onCancel:jt.l7,...po})(at),ho=(0,h.$j)(zt.cQ,{...po,onEdit:jt.bM})(at),mo=(0,p.P1)([zt.dm],(e=>({...e,editor:co}))),uo=(0,h.$j)(mo,{onCancelRemove:jt.iY,onCancelStyle:jt.nk,onCancelEdit:jt.QD,onToggleUnsavedChangesModal:jt.ts,onToggleUnsavedStyleModal:jt.yw,onToggleUnsavedGeometryModal:jt.UJ,onConfirmRemove:jt.jw,onToggleVisibility:jt.r1,onCancelClose:jt.Hl,onConfirmClose:jt.L0,onAdd:jt.A9,onEdit:jt.VR,onHighlight:jt.CH,onCleanHighlight:jt.Rx,onDetail:jt.MQ,onFilter:jt.VP,onDownload:jt.LR,onZoom:no.Px,onLoadAnnotations:jt.wP,onLoadDefaultStyles:jt.pI})(Ft);class go extends s().Component{componentDidMount(){(0,ro.j9)(C.jB,ho)}componentWillUnmount(){(0,ro.j9)(C.jB,void 0)}render(){return this.props.active?s().createElement(ao.Z,io({containerId:"annotations-panel",className:"ms-annotations-panel",containerStyle:this.props.dockStyle,hideHeader:!0,style:this.props.dockStyle,open:this.props.active,size:this.props.width},this.props.dockProps),s().createElement(uo,io({},this.props,{width:this.props.width}))):null}}lo(go,"propTypes",{id:l().string,active:l().bool,wrap:l().bool,wrapWithPanel:l().bool,panelStyle:l().object,panelClassName:l().string,toggleControl:l().func,closeGlyph:l().string,buttonStyle:l().object,style:l().object,dockProps:l().object,dockStyle:l().object,width:l().number}),lo(go,"defaultProps",{id:"mapstore-annotations-panel",active:!1,wrap:!1,modal:!0,wrapWithPanel:!1,panelStyle:{zIndex:100,overflow:"hidden",height:"100%"},panelClassName:"annotations-panel",toggleControl:()=>{},closeGlyph:"1-close",width:300,dockProps:{dimMode:"none",position:"left",zIndex:1030},dockStyle:{}});const yo=m.on.bind(null,(0,m.Xi)("annotations",null),(e=>!(e.controls&&e.controls.annotations&&e.controls.annotations.enabled&&e.annotations&&e.annotations.editing)),jt.g),fo=(0,p.P1)([e=>e.controls&&e.controls.annotations&&e.controls.annotations.enabled||e.annotations&&e.annotations.closing||!1,e=>(0,so.ic)(e,{height:!0}),zt.dm],((e,t,o)=>({active:e,dockStyle:t,width:c()(null==o?void 0:o.selected)?300:600}))),bo=(0,h.$j)(fo,{toggleControl:yo})(go),vo=(0,h.rx)("Annotations",{component:a()(bo,{disablePluginIf:"{state('mapType') === 'cesium' || state('mapType') === 'leaflet' }"}),containers:{TOC:{doNotHide:!0,name:"Annotations",target:"toolbar",selector:()=>!0,Component:(0,h.$j)((()=>{}),{onClick:yo})((e=>{var t;let{onClick:o,layers:n,selectedLayers:r,status:a}=e;return"DESELECT"===a&&0===n.filter((e=>"annotations"===e.id)).length?s().createElement(Le.Z,{key:"annotations",placement:"top",overlay:s().createElement(E.Tooltip,{id:"legend-tooltip-annotations"},s().createElement(T.Z,{msgId:"toc.addAnnotations"}))},s().createElement(Pt.Z,{key:"annotations",bsStyle:"primary",className:"square-button-md",onClick:o},s().createElement(E.Glyphicon,{glyph:"comment"}))):"annotations"===(null===(t=r[0])||void 0===t?void 0:t.id)&&s().createElement(Le.Z,{key:"annotations-edit",placement:"top",overlay:s().createElement(E.Tooltip,{id:"legend-tooltip-annotations-edit"},s().createElement(T.Z,{msgId:"toc.editAnnotations"}))},s().createElement(Pt.Z,{key:"annotations",bsStyle:"primary",className:"square-button-md",onClick:o},s().createElement(E.Glyphicon,{glyph:"pencil"})))}))},BurgerMenu:{name:"annotations",position:40,text:s().createElement(T.Z,{msgId:"annotationsbutton"}),tooltip:"annotations.tooltip",icon:s().createElement(E.Glyphicon,{glyph:"comment"}),action:yo,priority:2,doNotHide:!0}},reducers:{annotations:Zt.Z},epics:oo})},30206:(e,t,o)=>{"use strict";o.d(t,{sB:()=>g,_o:()=>y,cM:()=>x,Cq:()=>V,cQ:()=>H,dm:()=>_});var n=o(22222),s=o(612912),r=o(274363),a=o(101092),i=o(975872),l=o(91175),p=o.n(l),d=o(227361),c=o.n(d),h=o(727418),m=o.n(h),u=o(234228);const g=(0,n.P1)([s.l2],(e=>p()(e.filter((e=>"annotations"===e.id))))),y=e=>c()(e,"annotations.config.multiGeometry",!1),f=e=>c()(e,"annotations.removing"),b=e=>c()(e,"annotations.format"),v=e=>c()(e,"annotations.aeronauticalOptions"),E=e=>c()(e,"annotations.showUnsavedChangesModal",!1),S=e=>c()(e,"annotations.showUnsavedStyleModal",!1),C=e=>c()(e,"annotations.showUnsavedGeometryModal",!1),w=e=>c()(e,"annotations.showDeleteFeatureModal",!1),T=e=>!!c()(e,"annotations.closing"),x=e=>c()(e,"annotations.editing"),P=e=>c()(e,"annotations.editGeometry",!0),k=e=>c()(e,"annotations.featureType"),O=e=>c()(e,"annotations.coordinateEditorEnabled"),M=e=>!!c()(e,"annotations.drawing"),F=e=>c()(e,"annotations.stylerType"),Z=e=>c()(e,"annotations.drawingText"),j=e=>c()(e,"annotations.editedFields",{}),N=e=>!!c()(e,"annotations.styling"),I=e=>c()(e,"annotations.selected",null),A=e=>c()(e,"annotations.unsavedChanges",!1),G=e=>c()(e,"annotations.unsavedGeometry",!1),U=e=>c()(e,"annotations.unsavedStyle",!1),D=e=>c()(e,"annotations.validationErrors",{}),B=e=>c()(e,"annotations.config",{}),R=e=>c()(e,"annotations.symbolList",[]),V=e=>c()(e,"annotations.symbolErrors",[]),L=e=>(x(e)?"editing":g(e)&&(e=>c()(e,"annotations.current"))(e)&&"detail")||"list",z=e=>c()(e,"annotations.showAgain",!1),W=e=>c()(e,"annotations.showPopupWarning",!0),H=e=>m()({},{symbolErrors:V(e),showEdit:(0,a.m6)(e),canEdit:P(e),mouseHoverEvents:(0,i.Qp)(e),closing:T(e),format:b(e)||(0,u.u8)("defaultCoordinateFormat"),aeronauticalOptions:v(e),config:B(e),drawing:M(e),drawingText:Z(e),errors:D(e),editing:x(e),coordinateEditorEnabled:O(e),editedFields:j(e),mode:L(e),selected:I(e),featureType:k(e),removing:f(e),mapProjection:(0,r.uy)(e),showUnsavedChangesModal:E(e),showDeleteFeatureModal:w(e),showUnsavedGeometryModal:C(e),showUnsavedStyleModal:S(e),stylerType:F(e),styling:N(e),unsavedChanges:A(e),unsavedGeometry:G(e),unsavedStyle:U(e),symbolList:R(e),showAgain:z(e),showPopupWarning:W(e)}),_=(0,n.P1)([H,e=>({...e.annotations||{}}),g,L],((e,t,o,n)=>m()({},{format:t.format,aeronauticalOptions:t.aeronauticalOptions,removing:t.removing,showUnsavedChangesModal:t.showUnsavedChangesModal,showUnsavedGeometryModal:t.showUnsavedGeometryModal,showUnsavedStyleModal:t.showUnsavedStyleModal,showDeleteFeatureModal:t.showDeleteFeatureModal,closing:!!t.closing,mode:n,annotations:o&&o.features||[],current:t.current||null,editing:e.editing,selected:e.selected,filter:t.filter||"",defaultStyles:t.defaultStyles,loading:t.loading},e.config?{config:e.config}:{})));(0,n.P1)([_],(e=>{const t=e.current;return{annotation:p()(e.annotations.filter((e=>e.properties.id===t)))}}))},844174:e=>{e.exports=function(e,t,o,n){for(var s=-1,r=null==e?0:e.length;++s<r;){var a=e[s];t(n,a,o(a),e)}return n}},481119:(e,t,o)=>{var n=o(989881);e.exports=function(e,t,o,s){return n(e,(function(e,n,r){t(s,e,o(e),r)})),s}},555189:(e,t,o)=>{var n=o(844174),s=o(481119),r=o(267206),a=o(701469);e.exports=function(e,t){return function(o,i){var l=a(o)?n:s,p=t?t():{};return l(o,e,r(i,2),p)}}},549995:(e,t,o)=>{var n=o(789465),s=o(555189),r=Object.prototype.hasOwnProperty,a=s((function(e,t,o){r.call(e,o)?++e[o]:n(e,o,1)}));e.exports=a},264372:(e,t,o)=>{e.exports=o.p+"web/client/components/style/vector/iconNotFound.png"}}]);