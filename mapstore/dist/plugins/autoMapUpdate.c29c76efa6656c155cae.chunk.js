(self.webpackChunkmapstore2=self.webpackChunkmapstore2||[]).push([[1299],{718341:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>P});var o=t(124852),s=t.n(o),r=t(45697),a=t.n(r),i=t(171703),l=t(49977),p=t.n(l),c=t(333101),u=t(926854),g=t(504518),d=t(687753),m=t(859518),h=t(274363);const f=(0,t(22222).P1)([e=>e.layers&&e.layers.flat&&e.layers.flat.filter((e=>"wms"===e.type&&"background"!==e.group))||[],e=>e.layers&&e.layers.refreshing||[]],((e,n)=>({loading:!!(n&&n.length>0),length:e.length||0,count:e.length-n.length+1||0})));var b=t(630294),y=t(472986),v=t.n(y),w=t(804504),E=t(893379),x=t.n(E),k=t(467062);function U(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}x()(k.Z,{insert:"head",singleton:!1}),k.Z.locals;class C extends s().Component{render(){return this.props.loading?s().createElement("div",{className:"overlay-spinner-container"},s().createElement("div",null,s().createElement(b.Row,null,s().createElement(b.Col,{xs:12,className:"text-center overlay-spinner-label"},s().createElement("h3",null,s().createElement(w.Z,{msgId:this.props.label})))),s().createElement(b.Row,null,s().createElement(b.Col,{xs:12},this.props.spinner?s().createElement(v(),{noFadeIn:!0,overrideSpinnerClassName:"spinner",spinnerName:this.props.spinner}):s().createElement(b.ProgressBar,{active:!0,now:100*this.props.count/this.props.length}))),s().createElement(b.Row,null,s().createElement(b.Col,{xs:12,className:"text-center overlay-spinner-label"},s().createElement("h3",null,this.props.count+" "," ",s().createElement(w.Z,{msgId:"autorefresh.of"})," "+this.props.length+" ",s().createElement(w.Z,{msgId:this.props.unit})))))):null}}U(C,"propTypes",{loading:a().bool,count:a().number,length:a().number,label:a().string,unit:a().string,spinner:a().string}),U(C,"defaultProps",{loading:!1,count:0,length:0,label:"autorefresh.updating",unit:"autorefresh.layers"});const O=C;var M=t(152543);function Z(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}class S extends s().Component{UNSAFE_componentWillMount(){this.props.onUpdateOptions(this.props.options)}render(){return s().createElement(O,{loading:this.props.loading,count:this.props.count,length:this.props.length,label:this.props.label,unit:this.props.unit,spinner:this.props.spinner})}}Z(S,"propTypes",{options:a().object,loading:a().bool,count:a().number,length:a().number,label:a().string,unit:a().string,onUpdateOptions:a().func,spinner:a().string}),Z(S,"defaultProps",{loading:!1,count:0,length:0,label:"autorefresh.updating",unit:"autorefresh.layers",options:{bbox:!0,search:!0,dimensions:!0,title:!1},onUpdateOptions:()=>{}});const N=(0,i.connect)(f,{onUpdateOptions:d.Xg.bind(null,"mapUpdate","options")})(S),P=(0,M.rx)("AutoMapUpdate",{component:N,reducers:{},epics:{manageAutoMapUpdate:(e,n)=>e.ofType(u.ok).switchMap((t=>e.ofType(u.KS).take(1).switchMap((o=>{const s=(0,h.Zr)(n.getState()),r=o.info&&o.info.canEdit||!1;let a=t.config&&t.config.map&&t.config.map.layers&&t.config.map.layers.filter((e=>"wms"===e.type&&"background"!==e.group))||[];const i=(l=n.getState()).controls&&l.controls.mapUpdate&&l.controls.mapUpdate.options||{bbox:!0,search:!0,dimensions:!0,title:!1};var l;return s<2&&r?p().Observable.of((0,g.Kp)({title:"notification.warning",message:"notification.updateOldMap",action:{label:"notification.update",dispatch:(0,c.oZ)(a,i)},autoDismiss:12,position:"tc"})).concat(e.ofType(c.k3,c.CQ).bufferCount(a.length).switchMap((e=>{const n=e.filter((e=>e.type===c.CQ)).length>0?(0,g.Kp)({title:"notification.warning",message:"notification.warningSaveUpdatedMap",autoDismiss:6,position:"tc"}):(0,g.Vp)({title:"notification.success",message:"notification.saveUpdatedMap",autoDismiss:6,position:"tc"});return p().Observable.of(n,(0,d.Xi)("save"),(0,m.SL)(2))}))):p().Observable.empty()}))))}})},467062:(e,n,t)=>{"use strict";t.d(n,{Z:()=>r});var o=t(923645),s=t.n(o)()((function(e){return e[1]}));s.push([e.id,".ms2 .overlay-spinner-container  {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    z-index: 9998;\n    background-color: rgba(0, 0, 0, 0.5);\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n\n.ms2 .overlay-spinner-container > div {\n    width: 80%;\n}\n\n.ms2 .overlay-spinner-label {\n    color: #fff;\n}\n\n.ms2 .overlay-spinner-container .spinner {\n    float: none;\n    clear: both;\n    margin: auto;\n    width: 52px;\n    height: 52px;\n}\n\n.ms2 .overlay-spinner-container .spinner .sk-circle:before {\n    background-color: #fff;\n}\n",""]);const r=s}}]);