(self.webpackChunkmapstore2=self.webpackChunkmapstore2||[]).push([[913],{778081:(e,t,s)=>{"use strict";s.d(t,{Z:()=>h});var a=s(124852),r=s.n(a),o=s(630294),n=s(802728),c=s(270250),l=s(859653),i=s(312471);const h=e=>{let{className:t,splitTools:s,isSearchClickable:a=!0,hideOnBlur:h,typeAhead:p,placeholderMsgId:u,removeIcon:d="1-close",searchIcon:m="search",searchText:g="",searchOptions:x,maxResults:b,onSearch:f,onSearchReset:S,onSearchTextChange:T}=e;const v=(0,i.f)({searchText:g,searchOptions:x,maxResults:b,onSearch:f,onSearchReset:S});return r().createElement(n.Z,{className:t},r().createElement(o.FormGroup,null,r().createElement("div",{className:"input-group"},r().createElement(c.Z,{show:!0,hideOnBlur:h,typeAhead:p,placeholderMsgId:u,searchText:g,onSearch:v,onSearchTextChange:T}),r().createElement(l.Z,{splitTools:!1,toolbarButtons:[{glyph:d,className:"square-button-md no-border",bsStyle:"default",pullRight:!0,visible:""!==g,onClick:()=>S()},{glyph:m,className:"square-button-md no-border "+(a?"magnifying-glass clickable":"magnifying-glass"),bsStyle:"default",pullRight:!0,visible:""===g||!s,onClick:()=>v()}]}))))}},802728:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var a=s(124852),r=s.n(a);const o=e=>{let{className:t,style:s,children:a}=e;return r().createElement("div",{id:"map-search-bar",style:s,className:"MapSearchBar"+(t?" "+t:"")},a)}},270250:(e,t,s)=>{"use strict";s.d(t,{Z:()=>h});var a=s(124852),r=s.n(a),o=s(45697),n=s.n(o),c=s(630294),l=s(719648);const i=(e,t)=>{let{show:s,autoFocusOnSelect:a=!0,selectedItems:o=[],className:n,style:i={textOverflow:"ellipsis"},placeholder:h,placeholderMsgId:p,hideOnBlur:u=!0,searchText:d="",typeAhead:m=!0,delay:g=1e3,blurResetDelay:x=300,onSearch:b=(()=>{}),onSearchTextChange:f=(()=>{}),onCancelSelectedItem:S=(()=>{}),onPurgeResults:T=(()=>{})}=e;const v=r().useRef(),y=r().useRef(),[O,C]=r().useState(),[E,M]=r().useState(),[w,R]=r().useState(!1);r().useEffect((()=>{const e=y.current;if(a&&o&&(e<o.length||!e&&1===o.length)){const e=v.current;e&&e.focus instanceof Function&&setTimeout((()=>e.focus()),200)}y.current=o&&o.length})),r().useEffect((()=>{w&&(b(),R(!1))}),[w,b]);let N="search.addressSearch";if(!h&&t.messages){const e=(0,l.S$)(t.messages,p||N);e&&(N=e)}else N=h;return s&&r().createElement(c.FormControl,{className:"searchInput"+(n?` ${n}`:""),key:"search-input",placeholder:N,type:"text",inputRef:e=>{v.current=e},style:i,value:d,onKeyDown:e=>{switch(e.keyCode){case 13:b();break;case 8:!d&&o&&o.length>0&&S(o[o.length-1])}},onBlur:()=>{u&&(O&&clearTimeout(O),C(setTimeout((()=>{T()}),x)))},onFocus:()=>{m&&d&&b()},onChange:e=>{let t=e.target.value;f(t),m&&(E&&clearTimeout(E),M(setTimeout((()=>{R(!0)}),g)))}})};i.contextTypes={messages:n().object};const h=i},859653:(e,t,s)=>{"use strict";s.d(t,{Z:()=>p});var a=s(124852),r=s.n(a),o=s(727418),n=s.n(o),c=s(472986),l=s.n(c),i=s(8204);function h(){return h=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},h.apply(this,arguments)}const p=e=>{let{loading:t,splitTools:s,toolbarProps:a={},toolbarButtons:o=[],children:c}=e;return r().createElement("span",{className:"search-toolbar-options"},t&&r().createElement(l(),{style:n()({},{position:"absolute"},{right:"69px",zIndex:1,top:"13px"}),spinnerName:"pulse",noFadeIn:!0}),r().createElement(i.Z,h({btnGroupProps:{className:"btn-group-menu-options"},transitionProps:null,btnDefaultProps:{className:"square-button-md",bsStyle:"primary"}},a,{buttons:o})),c)}},312471:(e,t,s)=>{"use strict";s.d(t,{f:()=>a});const a=e=>{let{searchText:t,selectedItems:s,searchOptions:a,maxResults:r,onSearch:o=(()=>{}),onSearchReset:n=(()=>{})}=e;return()=>{const e=t,c=function(){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15;return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).reduce((function(t,s){var a;return t+((null==s||null===(a=s.options)||void 0===a?void 0:a.maxFeatures)||e)}),0)||e}(null==a?void 0:a.services,r);void 0!==e&&""!==e||s&&0!==s.length?void 0!==e&&""!==e&&o(e,a,c):n()}}},99866:(e,t,s)=>{"use strict";s.r(t),s.d(t,{contextManagerSearchContextsEpic:()=>m,editContext:()=>g,contextManagerDeleteContextEpic:()=>x,resetContextSearch:()=>b,contextManagerReloadOnContexts:()=>f});var a=s(49977),r=s.n(a),o=s(275982),n=s(288287),c=s(426529),l=s(504518),i=s(679426),h=s(853),p=s(371714),u=s(622901),d=s(372492);const m=e=>e.ofType(d.Ut).map((e=>{let{text:t,options:s}=e;return{text:t,options:s||{params:{start:0,limit:12}}}})).switchMap((e=>{let{text:t,options:s}=e;return r().Observable.defer((()=>n.Z.getResourcesByCategory("CONTEXT",t,s))).map((e=>(0,d.g_)(e,t,s))).let((0,c.hP)((0,d.as)(!0,"loading"),(0,d.as)(!1,"loading"),(()=>r().Observable.of((0,l.vU)({title:"notification.error",message:"resources.contexts.errorLoadingContexts",autoDismiss:6,position:"tc"})))))})),g=e=>e.ofType(d.y8).switchMap((e=>{let{resource:t}=e;return t?r().Observable.of((0,u.kb)(),(0,o.VF)(`/context-creator/${t.id}`)):r().Observable.empty()})),x=e=>e.ofType(d.v8).switchMap((e=>(0,i.fg)(e).map((()=>(0,d.zr)(e))))).let((0,c.hP)((0,d.as)(!0,"loading"),(0,d.as)(!1,"loading"),(()=>r().Observable.of((0,l.vU)({title:"notification.error",message:"resources.contexts.deleteError",autoDismiss:6,position:"tc"}))))),b=e=>e.ofType(d.x_).switchMap((()=>r().Observable.of((0,d.H6)("",{params:{start:0,limit:12}})))),f=(e,t)=>e.ofType(d.Ej,d.fJ,p.vY,u.Ps).delay(1e3).switchMap((()=>r().Observable.of((0,d.H6)((0,h.e8)(t.getState()),(e=>{const t=(0,h._y)(e),s=(0,h.bA)(e)||{},{start:a,limit:r,...o}=s.params;return a===t-1?{start:Math.max(0,a-r),limit:r}:{...s,params:{...o,start:a,limit:r}}})(t.getState())))))},505261:(e,t,s)=>{"use strict";s.d(t,{Z:()=>c});var a=s(867076),r=s(328062),o=s(770165),n=s(249461);const c=(0,a.compose)((0,a.withHandlers)({onSaveSuccess:e=>()=>{e.reloadContexts&&e.reloadContexts(),e.invalidateFeaturedMaps&&e.invalidateFeaturedMaps(),e.onShowSuccessNotification&&e.onShowSuccessNotification()}}),(0,a.defaultProps)({category:"CONTEXT"}),r.Z,(0,a.compose)((0,a.defaultProps)({shareOptions:{embedOptions:{showTOCToggle:!1},advancedSettingsVisibility:{bbox:!0}}}),o.Z))(n.Z)},542934:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>P});var a=s(124852),r=s.n(a),o=s(45697),n=s.n(o),c=s(171703),l=s(22222),i=s(630294),h=s(778081),p=s(804504),u=s(23888),d=s(152543),m=s(510644),g=s(853),x=s(372492),b=s(371714),f=s(505261),S=s(867076),T=s(706558);const v=(0,S.compose)((0,c.connect)((0,l.P1)(g.e8,g.Qq,g.Mz,g._y,g.VO,(()=>!1),(function(e){let{start:t=0,limit:s=12}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;const n=Math.min(r||0,s||0),c=a&&n&&Math.ceil(t/n)||0;return{page:c,pageSize:s,items:a,total:r,searchText:e,loading:o}})),{searchContexts:x.H6}),(0,S.renameProp)("searchContexts","loadPage"),(0,S.withHandlers)({onSelect:e=>{let{loadPage:t=(()=>{}),searchText:s,pageSize:a}=e;return e=>{t(s,{params:{start:a*e,limit:a}})}}}))(T.Z);var y=s(99866),O=s(521923),C=s(984596),E=s.n(C);function M(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const w=(0,c.connect)((0,l.zB)({user:m.np}),{onDelete:x.D0,reloadContexts:x.mE,onUpdateAttribute:b.tC})(f.Z);class R extends r().Component{componentDidMount(){this.props.onSearch(this.props.searchText,this.props.searchOptions)}render(){return r().createElement(r().Fragment,null,r().createElement(h.Z,{className:this.props.className,splitTools:this.props.splitTools,showOptions:this.props.showOptions,searchOptions:this.props.searchOptions,isSearchClickable:this.props.isSearchClickable,hideOnBlur:this.props.hideOnBlur,placeholderMsgId:this.props.placeholderMsgId,onSearch:this.props.onSearch,onSearchReset:this.props.onSearchReset,onSearchTextChange:this.props.onSearchTextChange,typeAhead:this.props.typeAhead,searchText:this.props.searchText}),r().createElement(i.Grid,{style:{marginBottom:"10px"},fluid:!0},r().createElement("h1",{className:"usermanager-title"},r().createElement(p.Z,{msgId:"contextManager.gridTitle"})),r().createElement(u.Z,{style:{marginRight:"10px"},bsStyle:"success",onClick:()=>this.context.router.history.push("/context-creator/new")},"Â ",r().createElement("span",null,r().createElement(p.Z,{msgId:"contextManager.newContext"})))),r().createElement(w,{resources:this.props.resources,fluid:this.props.fluid,colProps:this.props.colProps,viewerUrl:e=>this.context.router.history.push(`/context/${e.name}`),getShareUrl:e=>`context/${e.name}`,editDataEnabled:this.props.editDataEnabled,onEditData:this.props.onEditData,nameFieldFilter:e=>e.replace(/[^a-zA-Z0-9\-_]/,""),cardTooltips:{deleteResource:"resources.resource.deleteResource",editResource:"resources.resource.editResource",editResourceData:"contextManager.editContextTooltip",shareResource:"share.title",addToFeatured:"resources.resource.addToFeatured",showDetails:"resources.resource.showDetails",removeFromFeatured:"resources.resource.removeFromFeatured"},bottom:r().createElement(v,null)}))}}M(R,"propTypes",{className:n().string,splitTools:n().bool,showOptions:n().bool,searchOptions:n().object,isSearchClickable:n().bool,hideOnBlur:n().bool,placeholderMsgId:n().string,typeAhead:n().bool,searchText:n().string,onSearch:n().func,onSearchReset:n().func,onSearchTextChange:n().func,resources:n().array,colProps:n().object,fluid:n().bool,editDataEnabled:n().bool}),M(R,"contextTypes",{router:n().object}),M(R,"defaultProps",{className:"user-search",hideOnBlur:!1,isSearchClickable:!0,showOptions:!1,splitTools:!1,placeholderMsgId:"contextManager.searchPlaceholder",typeAhead:!1,searchText:"",searchOptions:{params:{start:0,limit:12}},resources:[],colProps:{xs:12,sm:6,lg:3,md:4,className:"ms-map-card-col"},fluid:!0,editDataEnabled:!0,onSearch:()=>{},onSearchReset:()=>{},onSearchTextChange:()=>{},onEditData:()=>{}});const N=(0,l.zB)({searchText:g.e8,searchOptions:g.bA,resources:g.Mz}),P=(0,d.rx)("ContextManager",{component:(0,c.connect)(N,{onSearch:x.H6,onSearchReset:x.vE,onSearchTextChange:x.k9,onEditData:x.ix})(R),reducers:{contextmanager:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{searchOptions:{params:{start:0,limit:12}},searchText:""},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case x.lg:return(0,O.t8)("searchText",t.searchText,e);case x.gx:return{...e,results:""!==t.results?E()(t.results):[],success:t.success,totalCount:t.totalCount,searchText:t.searchText,searchOptions:t.searchOptions};case x.br:return(0,O.t8)("loading"===t.name?"loading":`loadFlags.${t.name}`,t.value,(0,O.t8)("loading",t.value,e));default:return e}}},epics:y})},853:(e,t,s)=>{"use strict";s.d(t,{e8:()=>r,bA:()=>o,Qq:()=>n,Mz:()=>c,_y:()=>l,VO:()=>i});var a=s(22222);const r=e=>e&&e.contextmanager&&e.contextmanager.searchText,o=e=>e&&e.contextmanager&&e.contextmanager.searchOptions,n=(0,a.P1)(o,(e=>e&&e.params)),c=e=>e&&e.contextmanager&&e.contextmanager.results,l=e=>e&&e.contextmanager&&e.contextmanager.totalCount,i=e=>e&&e.contextmanager&&e.contextmanager.loading}}]);