(self.webpackChunkmapstore2=self.webpackChunkmapstore2||[]).push([[6764],{768977:(e,t,i)=>{"use strict";i.d(t,{Z:()=>c});var s=i(45697),n=i.n(s),o=i(124852),r=i.n(o),l=i(630294),a=i(222777);function p(){return p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},p.apply(this,arguments)}function h(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class d extends r().Component{render(){const{cardComponent:e,items:t,colProps:i,onItemClick:s,size:n}=this.props,o=e||a.Z;return r().createElement("div",{className:"msSideGrid"+(this.props.className?" "+this.props.className:"")},r().createElement(l.Row,{className:"items-list"},t.map(((e,t)=>r().createElement(l.Col,p({key:e.id||t},i),r().createElement(o,p({onClick:function(){for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];return s(e,...i)},size:n},e)))))))}}h(d,"propTypes",{size:n().string,onItemClick:n().func,colProps:n().object,items:n().array,cardComponent:n().oneOfType([n().string,n().func]),className:n().string}),h(d,"defaultProps",{size:"",onItemClick:()=>{},colProps:{xs:12},className:"",items:[]});const c=d},122910:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>Y});var s=i(227361),n=i.n(s),o=i(91175),r=i.n(o),l=i(531351),a=i.n(l),p=i(727418),h=i.n(p),d=i(45697),c=i.n(d),g=i(124852),m=i.n(g),u=i(171703),y=i(22222);const f="FLOATINGLEGEND:RESIZE_LEGEND",b="FLOATINGLEGEND:EXPAND_LEGEND";var E=i(333101),x=i(180307),v=i.n(x),w=i(618446),O=i.n(w),z=i(98066),H=i.n(z),N=i(630294),P=i(496259),C=i(101706),L=i(23888),j=i(36549),T=i(768977),G=i(908956),I=i(134006);function R(){return R=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},R.apply(this,arguments)}function Z(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const k=(0,j.Z)(L.Z);class D extends m().Component{constructor(){super(...arguments),Z(this,"state",{}),Z(this,"findListHeight",(()=>{const e=this.list&&v().findDOMNode(this.list),t=e&&e.clientHeight&&e.clientHeight+this.props.deltaHeight||9999;return this.setState({listHeight:t}),t}))}componentDidMount(){this.props.onExpand(this.props.expandedOnMount)}componentDidUpdate(e){H()((()=>{if(!O()(this.props.layers,e.layers)||this.props.maxHeight!==e.maxHeight||this.props.disabled!==e.disabled){const e=this.findListHeight();this.props.maxHeight<this.props.height?this.props.onResize({height:this.props.maxHeight}):e&&e<this.props.height&&this.props.onResize({height:e})}if(this.props.layers.length!==e.layers.length||this.props.expanded&&!e.expanded){const e=this.findListHeight();this.props.onResize({height:e<this.props.maxHeight?e:this.props.maxHeight})}}),100)}render(){const e=this.props.expanded&&this.props.layers&&this.props.layers.length>0;return this.props.layers&&0===this.props.layers.length&&!this.props.title&&m().createElement("div",{id:"ms-legend-action",className:"ms-legend-action"},this.props.toggleButton)||!this.props.disabled&&m().createElement(P.Z,null,(t=>{let{height:i}=t;return m().createElement(C.Resizable,{height:this.props.height,axis:"y",minConstraints:[this.props.width,this.props.minHeight],maxConstraints:[this.props.width,this.state.listHeight&&this.state.listHeight<this.props.maxHeight&&this.state.listHeight||i&&i<this.props.maxHeight&&i||this.props.maxHeight],onResize:(e,t)=>this.props.onResize({height:t.size&&t.size.height})},m().createElement(N.Panel,{id:"ms-legend-action",className:"ms-legend-action",collapsible:!0,header:m().createElement(N.Grid,{fluid:!0},m().createElement(N.Row,null,m().createElement(N.Col,{xs:12,className:"ms-legend-header"},this.props.toggleButton,m().createElement("div",null,m().createElement("h5",null,this.props.title)),this.props.layers&&this.props.layers.length>0&&m().createElement(k,{tooltipId:this.props.expanded?"floatinglegend.hideLegend":"floatinglegend.showLegend",tooltipPosition:"bottom",className:"no-border square-button-md",onClick:()=>this.props.onExpand(!this.props.expanded)},m().createElement(N.Glyphicon,{glyph:this.props.expanded?"chevron-down":"chevron-left"}))))),expanded:e,footer:e&&m().createElement(N.Grid,{fluid:!0}),style:{width:this.props.width,...this.props.height&&e?{height:this.props.minHeight>this.props.height?this.props.minHeight:this.props.height}:{}}},m().createElement(T.Z,{ref:e=>{this.list=e},size:"sm",items:this.props.layers.map((e=>({title:e.title&&""!==e.title?e.title:e.name,preview:m().createElement(N.Glyphicon,{className:"text-primary",glyph:e.visibility?"eye-open":"eye-close",onClick:()=>this.props.onChange(e.id,"layers",{visibility:!e.visibility})}),style:{opacity:e.visibility?1:.4},body:e.visibility?m().createElement("div",null,m().createElement(N.Grid,{fluid:!0},m().createElement(N.Row,null,m().createElement(N.Col,{xs:12,className:"ms-legend-container"},m().createElement(I.Z,R({node:{...e},currentZoomLvl:this.props.currentZoomLvl,scales:this.props.scales},this.props.legendProps))))),!this.props.disableOpacitySlider&&m().createElement(G.Z,{opacity:e.opacity,disabled:!e.visibility,hideTooltip:this.props.hideOpacityTooltip,onChange:t=>this.props.onChange(e.id,"layers",{opacity:t})})):null})))})))}))}}Z(D,"propTypes",{layers:c().array,expanded:c().bool,width:c().number,height:c().number,title:c().string,legendProps:c().object,onChange:c().func,onResize:c().func,onExpand:c().func,toggleButton:c().node,minHeight:c().number,maxHeight:c().number,disabled:c().bool,currentZoomLvl:c().number,scales:c().array,disableOpacitySlider:c().bool,deltaHeight:c().number,expandedOnMount:c().bool,hideOpacityTooltip:c().bool}),Z(D,"defaultProps",{layers:[],expanded:!0,width:300,height:900,title:"",legendProps:{},onChange:()=>{},onResize:()=>{},onExpand:()=>{},toggleButton:m().createElement(N.Glyphicon,{glyph:"1-map",style:{margin:"0 8px"}}),minHeight:150,maxHeight:9999,deltaHeight:110,expandedOnMount:!0});const B=D;var S=i(521923);var M=i(820709),A=i(612912),F=i(707366),V=i(274363),_=i(350126),q=i(719648),U=i(835516);function X(){return X=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},X.apply(this,arguments)}function J(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class K extends m().Component{renderPanel(){const e=this.props.items&&r()(this.props.items.filter((e=>e&&e.name===this.props.pluginName)));return e&&e.plugin&&m().createElement(e.plugin,X({},e.cfg||{},{items:e.items||[],menuButtonStyle:{display:"none"}}))}renderToggleButton(){const e=this.props.items&&r()(this.props.items.filter((e=>e&&e.name===this.props.pluginName)));return e&&e.button&&m().createElement(e.button,X({},e.cfg||{},{tooltipId:this.props.tooltipId}))}render(){return m().createElement("div",{className:this.props.className,style:this.props.style},m().createElement(B,X({},this.props,{toggleButton:this.renderToggleButton()})),this.renderPanel())}}J(K,"propTypes",{items:c().array,pluginName:c().string,tooltipId:c().string,className:c().string,style:c().object}),J(K,"defaultProps",{items:[],pluginName:"drawer-menu",tooltipId:"floatinglegend.showTOC",className:"ms-floatinglegend-container",style:{top:0,left:0,position:"absolute",height:"100%"}});const Q=(0,y.P1)([A.l2,F.Pz,e=>e.floatinglegend&&e.floatinglegend.size||{width:0,height:0},e=>!(!e.floatinglegend||!e.floatinglegend.expanded),e=>n()(e,"controls.drawer.enabled"),V.Od,_.Nr,M.Rd],((e,t,i,s,n,o,r,l)=>({layers:l&&[]||e&&a()([...e.filter((e=>e&&"background"!==e.group&&!e.loadingError)).map((e=>{let{title:i,...s}=e;return{...s,title:(0,q.MZ)(t,i)}}))])||[],title:o&&o.info&&o.info.name||"",height:i.height||300,expanded:s,disabled:!!n,maxHeight:o&&o.size&&o.size.height-134-(r&&r.bottom&&(0,U.parseLayoutValue)(r.bottom,o&&o.size&&o.size.height)||0)||9999,currentZoomLvl:o&&o.zoom,scales:(0,U.getScales)(o&&o.projection||"EPSG:3857",o&&o.mapOptions&&o.mapOptions.view&&o.mapOptions.view.DPI||null)}))),W=(0,u.connect)(Q,{onChange:E.tV,onResize:function(e){return{type:f,size:e}},onExpand:function(e){return{type:b,expanded:e}}})(K),Y={FloatingLegendPlugin:h()(W,{disablePluginIf:"{state('featuregridmode') === 'EDIT'}"}),reducers:{floatinglegend:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case f:return(0,S.t8)("size",{width:t.size&&t.size.width,height:t.size&&t.size.height},e);case b:return{...e,expanded:t.expanded};default:return e}}}}},138845:e=>{e.exports=function(e,t,i){if("function"!=typeof e)throw new TypeError("Expected a function");return setTimeout((function(){e.apply(void 0,i)}),t)}},98066:(e,t,i)=>{var s=i(138845),n=i(105976),o=i(14841),r=n((function(e,t,i){return s(e,o(t)||0,i)}));e.exports=r}}]);