(self.webpackChunkmapstore2=self.webpackChunkmapstore2||[]).push([[794],{956611:(e,t,r)=>{"use strict";r.d(t,{Z:()=>c});var n=r(747037),o=r.n(n),a=r(45697),s=r.n(a),l=r(124852),i=r.n(l),p=r(630294),u=r(719648);function m(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class d extends i().Component{constructor(){super(...arguments),m(this,"onMouseOver",(()=>{const e=o()(this.props.helpText)?this.props.helpText:(0,u.S$)(this.context.messages,this.props.helpText.props.msgId);this.props.changeHelpText(e),this.props.changeHelpwinVisibility(!0)}))}render(){return i().createElement(p.Badge,{id:this.props.id,onMouseOver:this.onMouseOver,className:(this.props.isVisible?"":"hidden ")+(this.props.className?this.props.className:"")},"?")}}m(d,"propTypes",{id:s().string,helpText:s().oneOfType([s().string,s().element]),isVisible:s().bool,changeHelpText:s().func,changeHelpwinVisibility:s().func,className:s().string}),m(d,"contextTypes",{messages:s().object}),m(d,"defaultProps",{helpText:"",isVisible:!1});const c=d},129125:(e,t,r)=>{"use strict";r.d(t,{ZP:()=>v});var n=r(49977),o=r.n(n),a=r(423570),s=r.n(a),l=r(454295),i=r(556233),p=r(976719),u=r(333101),m=r(363082),d=r(687753),c=r(917450),g=r(119008),h=r(870820),b=r(859518),y=r(172768),f=r(789683),E=r(502422);const v={addAnnotationFromMeasureEpic:(e,t)=>e.ofType(p.XX).switchMap((e=>{const{features:r,textLabels:n,uom:a,save:i,properties:u}=e,{id:c=s()(),visibility:h=!0}=u||{},b={...(0,l.tL)(r,n,a,c,"Annotations created from measurements",m.Eo),newFeature:i,visibility:h};return o().Observable.from([...(0,g.Yq)("annotations")(t.getState())?[]:[(0,d.Xg)("annotations","enabled",!0)],(0,y.A9)(),(0,p.el)("exportToAnnotation",!1),(0,y.yg)(b)])})),addAsLayerEpic:e=>e.ofType(p.Wt).switchMap((e=>{let{features:t,textLabels:r,uom:n}=e;const a=(0,l.tL)(t,r,n,s()());return o().Observable.of((0,u.A4)({type:"vector",id:s()(),name:"Measurements",hideLoading:!0,features:[a],visibility:!0}))})),openMeasureEpic:(e,t)=>e.ofType(d.At,d.kM).filter((e=>"measure"===e.control&&(0,h.JF)(t.getState()))).switchMap((()=>{var e,r;const n=[(0,c.g)(),(0,c.aN)(),(0,b.H0)("click","measure")],{showCoordinateEditor:a}=(null===(e=t.getState())||void 0===e||null===(r=e.controls)||void 0===r?void 0:r.measure)||{};return a&&n.push((0,f.Vd)("measure","add","right")),o().Observable.from(n)})),closeMeasureEpics:(e,t)=>e.ofType(d.At,d.kM).filter((e=>"measure"===e.control&&!(0,g.QF)(t.getState()))).switchMap((()=>{var e,r;const n=[(0,p.Bd)({lineMeasureEnabled:!1,areaMeasureEnabled:!1,bearingMeasureEnabled:!1,geomType:null,len:0,area:0,bearing:0}),(0,y.Rx)(),(0,b.$X)("click","measure")],{showCoordinateEditor:a}=(null===(e=t.getState())||void 0===e||null===(r=e.controls)||void 0===r?void 0:r.measure)||{};return a&&n.push((0,f.Vd)("measure","remove","right")),o().Observable.from(n)})),setMeasureStateFromAnnotationEpic:(e,t)=>e.ofType(p.ES).switchMap((e=>{var r,n;let{features:a,properties:s}=e;const i=(0,h.on)(t.getState())===(null===(r=(0,l.k2)(a))||void 0===r?void 0:r[0]);return o().Observable.of(!i&&(0,p.Bd)({geomType:null===(n=(0,l.k2)(a))||void 0===n?void 0:n[0]}),(0,d.Xg)("measure","enabled",!0),(0,d.Xg)("annotations","enabled",!1),(0,y.r1)(s.id,!1))})),addCoordinatesEpic:(e,t)=>{let{getState:r=(()=>{})}=t;return e.ofType(b.TR).filter((()=>{var e,t;const{showCoordinateEditor:n,enabled:o}=(null===(e=r())||void 0===e||null===(t=e.controls)||void 0===t?void 0:t.measure)||{};return n&&o})).switchMap((e=>{var t,n,a;let{point:s}=e;const{currentFeature:l,features:u=[],geomType:m}=(null===(t=r())||void 0===t?void 0:t.measurement)||{},{lng:d,lat:c}=(null==s?void 0:s.latlng)||{};let g=(null===(n=u[l])||void 0===n||null===(a=n.geometry)||void 0===a?void 0:a.coordinates)||[];g="Polygon"===m?g[0]:g;const h=void 0!==g?g.findIndex((e=>!(0,i.wd)(e))):-1;return-1!==h?(g=g.map((e=>({lon:e[0],lat:e[1]}))),g[h]={lon:d,lat:c},o().Observable.of((0,p.dD)(g))):o().Observable.empty()}))},tearDownMeasureOnDrawToolActive:(e,t)=>(0,E.U)(e,t,"measure")}},303028:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>m});var n=r(45697),o=r.n(n),a=r(124852),s=r.n(a),l=r(630294),i=r(638510);function p(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class u extends s().Component{constructor(){super(...arguments),p(this,"getPanels",(()=>this.props.items.filter((e=>e.tools)).reduce(((e,t)=>e.concat(t.tools.map(((e,r)=>({name:t.name+r,panel:e,cfg:t.cfg.toolsCfg?t.cfg.toolsCfg[r]:{}}))))),[]))),p(this,"getTools",(()=>this.props.items.sort(((e,t)=>e.position-t.position))))}render(){return s().createElement(i.Z,{id:this.props.id,style:this.props.style,className:this.props.className,mapType:this.props.mapType,container:e=>s().createElement(l.Grid,{fluid:!0},s().createElement(l.Row,null,e.children.map(((e,t)=>s().createElement(l.Col,{key:t,xs:12,xsOffset:0,sm:6,smOffset:3},e))))),toolStyle:"primary",activeStyle:"default",stateSelector:"omnibar",tool:e=>s().createElement("div",null,e.children),tools:this.getTools(),panels:this.getPanels()})}}p(u,"propTypes",{className:o().string,style:o().object,items:o().array,id:o().string,mapType:o().string}),p(u,"defaultProps",{items:[],className:"grid-home-container",style:{},id:"mapstore-grid-home",mapType:"leaflet"});const m={GridContainerPlugin:u,reducers:{}}},522019:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>_});var n=r(727418),o=r.n(n),a=r(124852),s=r.n(a),l=r(630294),i=r(171703),p=r(22222),u=r(172768),m=r(687753),d=r(976719),c=r(119008),g=r(101092),h=r(870820),b=r(234228),y=r(488400),f=r(843624),E=r.n(f),v=r(227361),T=r.n(v),C=r(618446),M=r.n(C),w=r(59854),L=r.n(w),S=r(45697),x=r.n(S),A=r(200020),P=r(423570),k=r.n(P),O=r(685476),Z=r(719648),B=r(454295),F=r(556233),I=r(804504),G=r(913186),j=r(756435),N=r(8204),R=r(100845);function D(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r.e(6510).then(r.bind(r,735604));class V extends s().Component{constructor(){var e;super(...arguments),e=this,D(this,"onGeomClick",(e=>{this.props.geomType!==e&&this.props.toggleMeasure({geomType:e})})),D(this,"onResetClick",(()=>{this.props.toggleMeasure({geomType:null})})),D(this,"getToolTips",(()=>({lineToolTip:s().createElement(l.Tooltip,{id:"tooltip-button.line"},this.props.lengthLabel),areaToolTip:s().createElement(l.Tooltip,{id:"tooltip-button.area"},this.props.areaLabel),bearingToolTip:s().createElement(l.Tooltip,{id:"tooltip-button.bearing"},this.isTrueBearing()?this.props.trueBearingLabel:this.props.bearingLabel)}))),D(this,"renderMeasurements",(function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r={style:"decimal",minimumIntegerDigits:1,maximumFractionDigits:2,minimumFractionDigits:2};return s().createElement(l.Grid,{fluid:!0,style:{maxHeight:400}},e.props.lineMeasureEnabled&&s().createElement(l.Row,null,s().createElement(l.FormGroup,{style:{display:"flex",alignItems:"center"}},e.props.lineMeasureValueEnabled&&s().createElement(l.Col,{xs:6},s().createElement("span",null,e.props.lengthLabel,": "),s().createElement("span",{id:"measure-len-res",className:"measure-value"},s().createElement("h3",null,s().createElement("strong",null,s().createElement(G.Z,{key:"len",numberParams:r,value:e.props.formatLength(e.props.uom.length.unit,e.props.measurement.len)})," ",e.props.uom.length.label)))),s().createElement(l.Col,{xs:6},s().createElement(A.DropdownList,{disabled:t,value:e.props.uom.length.label,onChange:t=>{e.props.onChangeUom("length",t,e.props.uom)},data:e.props.uomLengthValues,textField:"label",valueField:"value"})))),e.props.areaMeasureEnabled&&s().createElement(l.Row,null,s().createElement(l.FormGroup,{style:{display:"flex",alignItems:"center"}},e.props.areaMeasureValueEnabled&&s().createElement(l.Col,{xs:6},s().createElement("span",null,e.props.areaLabel,": "),s().createElement("span",{id:"measure-area-res",className:"measure-value"},s().createElement("h3",null,s().createElement("strong",null,s().createElement(G.Z,{key:"area",numberParams:r,value:e.props.formatArea(e.props.uom.area.unit,e.props.measurement.area)})," ",e.props.uom.area.label)))),s().createElement(l.Col,{xs:6},s().createElement(A.DropdownList,{disabled:t,value:e.props.uom.area.label,onChange:t=>{e.props.onChangeUom("area",t,e.props.uom)},data:e.props.uomAreaValues,textField:"label",valueField:"value"})))),e.props.bearingMeasureEnabled&&e.props.bearingMeasureValueEnabled&&s().createElement(l.Row,null,s().createElement(l.FormGroup,{style:{display:"flex",alignItems:"center",minHeight:34}},s().createElement(l.Col,{xs:6},s().createElement("span",null,e.isTrueBearing()?e.props.trueBearingLabel:e.props.bearingLabel,": "),s().createElement("span",{id:"measure-bearing-res",className:"measure-value"},s().createElement("h3",null,s().createElement("strong",null,e.props.formatBearing(e.props.measurement.bearing||0,e.isTrueBearing()&&e.props.measurement.trueBearing))))))))})),D(this,"renderPanel",(e=>this.props.showResults?this.renderMeasurements(e):null)),D(this,"renderLabel",(e=>this.props.showButtonsLabels?s().createElement("span",{className:"option-text"},(0,Z.S$)(this.context.messages,e)):null)),D(this,"renderText",((e,t)=>e?s().createElement("span",null,s().createElement("span",{className:"option-icon"},s().createElement(l.Glyphicon,{glyph:e})),this.renderLabel(t)):this.renderLabel(t))),D(this,"isTrueBearing",(()=>this.props.measurement&&this.props.measurement.trueBearing&&this.props.measurement.trueBearing.measureTrueBearing))}UNSAFE_componentWillReceiveProps(e){e.geomType||this.props.toggleMeasure({geomType:"LineString"})}shouldComponentUpdate(e){return!M()(e,this.props)}render(){var e;let t,r;const n=T()(this.props.measurement,"features",[])[this.props.measurement.currentFeature||0],o=(null==n||null===(e=n.properties)||void 0===e?void 0:e.disabled)||!1,a=0===(this.props.measurement.features||[]).length||o;this.props.useSingleFeature?(t=(T()(this.props.measurement,"feature.geometry.type")||"").toLowerCase(),r=(T()(this.props.measurement,-1!==t.indexOf("polygon")?"feature.geometry.coordinates[0]":"feature.geometry.coordinates")||[]).map((e=>({lon:e[0],lat:e[1]})))):(t=T()(n,"geometry.type","").toLowerCase(),r=(T()(n,-1!==t.indexOf("polygon")?"geometry.coordinates[0]":"geometry.coordinates")||[]).map((e=>({lon:e[0],lat:e[1]}))));const{exportToAnnotation:i=!1}=this.props.measurement||{};return s().createElement(j.Z,{id:this.props.id,style:{overflow:"visible"},header:s().createElement("div",null,s().createElement(l.ButtonToolbar,{style:{width:"100%",marginBottom:15,marginTop:8,display:"flex",justifyContent:"center"}},s().createElement(N.Z,{btnDefaultProps:{className:"square-button-md",bsStyle:"primary"},buttons:[{glyph:this.props.lineGlyph,active:!!this.props.lineMeasureEnabled,bsStyle:this.props.lineMeasureEnabled?"success":"primary",tooltip:this.renderText(this.props.inlineGlyph&&this.props.lineGlyph,"measureComponent.MeasureLength"),onClick:()=>this.onGeomClick("LineString"),disabled:!this.props.lineMeasureEnabled&&o},{active:!!this.props.areaMeasureEnabled,bsStyle:this.props.areaMeasureEnabled?"success":"primary",glyph:this.props.areaGlyph,tooltip:this.renderText(this.props.inlineGlyph&&this.props.areaGlyph,"measureComponent.MeasureArea"),onClick:()=>this.onGeomClick("Polygon"),disabled:!this.props.areaMeasureEnabled&&o},{visible:!this.props.disableBearing,active:!!this.props.bearingMeasureEnabled,bsStyle:this.props.bearingMeasureEnabled?"success":"primary",glyph:this.props.bearingGlyph,tooltip:this.renderText(this.props.inlineGlyph&&this.props.bearingGlyph,this.isTrueBearing()?"measureComponent.MeasureTrueBearing":"measureComponent.MeasureBearing"),onClick:()=>this.onGeomClick("Bearing"),disabled:!this.props.bearingMeasureEnabled&&o}]}),s().createElement(N.Z,{btnDefaultProps:{className:"square-button-md",bsStyle:"primary"},buttons:[{glyph:"remove",visible:!!this.props.withReset,tooltip:s().createElement(I.Z,{msgId:"measureComponent.resetTooltip"}),onClick:()=>this.onResetClick()}]}),s().createElement(N.Z,{btnDefaultProps:{className:"square-button-md",bsStyle:"primary"},buttons:[{glyph:"ext-json",disabled:a,visible:!!(this.props.bearingMeasureEnabled||this.props.areaMeasureEnabled||this.props.lineMeasureEnabled)&&this.props.showExportToGeoJSON,tooltip:s().createElement(I.Z,{msgId:"measureComponent.exportToGeoJSON"}),onClick:()=>{(0,O.LR)(JSON.stringify((0,B.tL)(this.props.measurement.features,this.props.measurement.textLabels,this.props.uom,k()(),"MapStore Measurements")),"measurements.json","application/geo+json")}},{glyph:"1-layer",visible:!!(this.props.bearingMeasureEnabled||this.props.areaMeasureEnabled||this.props.lineMeasureEnabled)&&this.props.showAddAsLayer,disabled:a||i,tooltip:s().createElement(I.Z,{msgId:"measureComponent.addAsLayer"}),onClick:()=>this.props.onAddAsLayer(this.props.measurement.features,this.props.measurement.textLabels,this.props.uom)},{glyph:i?"floppy-disk":"comment",tooltip:s().createElement(I.Z,{msgId:i?"measureComponent.saveMeasure":"measureComponent.addAsAnnotation"}),onClick:()=>{this.props.onAddAnnotation(this.props.measurement.features,this.props.measurement.textLabels,this.props.uom,!i,{id:this.props.measurement.id,visibility:this.props.measurement.visibility})},disabled:a,visible:!!(this.props.bearingMeasureEnabled||this.props.areaMeasureEnabled||this.props.lineMeasureEnabled)&&this.props.showAddAsAnnotation}]})),this.renderPanel(o))},this.props.showCoordinateEditor&&s().createElement(l.Grid,{fluid:!0,style:{maxHeight:400,borderTop:"1px solid #ddd"}},this.props.bearingMeasureEnabled||this.props.areaMeasureEnabled||this.props.lineMeasureEnabled?s().createElement(l.Row,{style:this.props.isCoordinateEditorEnabled?{}:{pointerEvents:"none",opacity:.5}},s().createElement(R.Z,{key:"measureEditor",isMouseEnterEnabled:!0,isMouseLeaveEnabled:!0,format:this.props.format,currentFeature:this.props.measurement.currentFeature,features:this.props.measurement.features,mapProjection:this.props.mapProjection,onChangeFormat:this.props.onChangeFormat,onHighlightPoint:this.props.onHighlightPoint,onChange:this.props.onChangeCoordinates,onChangeCurrentFeature:this.props.onChangeCurrentFeature,showFeatureSelector:this.props.showFeatureSelector,items:[],isDraggable:!0,type:this.props.geomType,showLengthAndBearingLabel:this.props.showLengthAndBearingLabel,components:this.props.useSingleFeature||-1===t.indexOf("polygon")?r:E()(r),properties:(null==n?void 0:n.properties)||{}})):s().createElement(l.Row,null,s().createElement(l.Col,{xs:12,className:"text-center",style:{padding:15}},s().createElement("i",null,s().createElement(I.Z,{msgId:"measureComponent.selectTool"}))))))}}D(V,"propTypes",{id:x().string,name:x().string,columnProperties:x().object,propertiesChangeHandler:x().func,lengthButtonText:x().oneOfType([x().string,x().element]),areaButtonText:x().oneOfType([x().string,x().element]),resetButtonText:x().oneOfType([x().string,x().element]),lengthLabel:x().oneOfType([x().string,x().element]),areaLabel:x().oneOfType([x().string,x().element]),bearingLabel:x().oneOfType([x().string,x().element]),trueBearingLabel:x().oneOfType([x().string,x().element]),uom:x().shape({length:x().shape({unit:x().string.isRequired,label:x().string.isRequired}),area:x().shape({unit:x().string.isRequired,label:x().string.isRequired})}),toggleMeasure:x().func,measurement:x().object,lineMeasureEnabled:x().bool,lineMeasureValueEnabled:x().bool,areaMeasureEnabled:x().bool,areaMeasureValueEnabled:x().bool,bearingMeasureEnabled:x().bool,bearingMeasureValueEnabled:x().bool,showButtons:x().bool,showResults:x().bool,mapProjection:x().string,lineGlyph:x().string,areaGlyph:x().string,bearingGlyph:x().string,withReset:x().bool,showButtonsLabels:x().bool,inlineGlyph:x().bool,formatLength:x().func,formatArea:x().func,formatBearing:x().func,onChangeUom:x().func,uomLengthValues:x().array,uomAreaValues:x().array,format:x().string,onChangeFormat:x().func,onChangeCoordinates:x().func,onChangeCurrentFeature:x().func,onAddAsLayer:x().func,onHighlightPoint:x().func,geomType:x().string,defaultOptions:x().object,onAddAnnotation:x().func,showAddAsAnnotation:x().bool,showLengthAndBearingLabel:x().bool,showAddAsLayer:x().bool,showFeatureSelector:x().bool,useSingleFeature:x().bool,showExportToGeoJSON:x().bool,disableBearing:x().bool,trueBearing:x().object,onMount:x().func,onUpdateOptions:x().func,showCoordinateEditor:x().bool,isCoordinateEditorEnabled:x().bool}),D(V,"contextTypes",{messages:x().object}),D(V,"defaultProps",{mapProjection:"EPSG:3857",columnProperties:{xs:4,sm:4,md:4},uomLengthValues:[{value:"ft",label:"ft"},{value:"m",label:"m"},{value:"km",label:"km"},{value:"mi",label:"mi"},{value:"nm",label:"nm"}],uomAreaValues:[{value:"sqft",label:"ft²"},{value:"sqm",label:"m²"},{value:"sqkm",label:"km²"},{value:"sqmi",label:"mi²"},{value:"sqnm",label:"nm²"}],id:"measure-result-panel",uom:{length:{unit:"m",label:"m"},area:{unit:"sqm",label:"m²"}},geomType:"LineString",defaultOptions:{geomType:"LineString"},showResults:!0,showAddAsAnnotation:!1,showAddAsLayer:!0,showExportToGeoJSON:!0,showCoordinateEditor:!1,isCoordinateEditorEnabled:!0,showLengthAndBearingLabel:!1,withReset:!0,lineGlyph:"1-measure-length",areaGlyph:"1-measure-area",bearingGlyph:"1-measure-bearing",showButtonsLabels:!0,lengthLabel:s().createElement(I.Z,{msgId:"measureComponent.lengthLabel"}),areaLabel:s().createElement(I.Z,{msgId:"measureComponent.areaLabel"}),bearingLabel:s().createElement(I.Z,{msgId:"measureComponent.bearingLabel"}),trueBearingLabel:s().createElement(I.Z,{msgId:"measureComponent.trueBearingLabel"}),formatLength:(e,t)=>(0,F.Ov)(t,"m",e),formatArea:(e,t)=>(0,F.Ov)(t,"sqm",e),formatBearing:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,F.rp)(L()(e||0,6),t)},onChangeUom:()=>{},onChangeFormat:()=>{},onMount:()=>{},onUpdateOptions:()=>{},onAddAsLayer:()=>{}});const U=V;var q=r(590504),H=r(908316);function X(){return X=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},X.apply(this,arguments)}function z(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class J extends s().Component{constructor(){super(...arguments),z(this,"onClose",(()=>{this.props.onClose(!1)})),z(this,"initDefaultOptions",(e=>{const{showCoordinateEditor:t,...r}=e;this.props.onMount(t||this.props.showCoordinateEditor),this.props.toggleMeasure({geomType:r.geomType||"LineString"}),this.props.onInit(r)}))}UNSAFE_componentWillMount(){this.initDefaultOptions(this.props.defaultOptions)}componentDidUpdate(e){M()(e.defaultOptions,this.props.defaultOptions)||this.initDefaultOptions(this.props.defaultOptions)}render(){return this.props.show?this.props.showCoordinateEditor?s().createElement(H.Z,{dock:!0,containerId:"measure-container",containerStyle:this.props.dockStyle,bsStyle:"primary",position:"right",title:s().createElement(I.Z,{key:"title",msgId:"measureComponent.Measure"}),glyph:"1-ruler",size:this.props.size,open:this.props.show,onClose:this.onClose,style:this.props.dockStyle},s().createElement(U,X({id:"measure-panel"},this.props))):s().createElement(q.Z,{id:"measure-dialog"},s().createElement("div",{key:"header",role:"header"},s().createElement(l.Glyphicon,{glyph:"1-ruler"})," ",s().createElement(I.Z,{key:"title",msgId:"measureComponent.Measure"}),s().createElement("button",{key:"close",onClick:this.onClose,className:"close"},this.props.closeGlyph?s().createElement(l.Glyphicon,{glyph:this.props.closeGlyph}):s().createElement("span",null,"×"))),s().createElement("div",{key:"body",role:"body"},s().createElement(U,X({id:"measure-panel",style:{minWidth:"500px"}},this.props)))):null}}z(J,"propTypes",{show:x().bool,closeGlyph:x().string,onClose:x().func,onMount:x().func,onInit:x().func,showCoordinateEditor:x().bool,defaultOptions:x().object,style:x().object,dockStyle:x().object,size:x().number}),z(J,"contextTypes",{messages:x().object}),z(J,"defaultProps",{show:!1,defaultOptions:{},onMount:()=>{},onInit:()=>{},toggleMeasure:()=>{},showCoordinateEditor:!1,showAddAsAnnotation:!1,closeGlyph:"1-close",dockStyle:{},size:550});const W=J;var Q=r(350126);const K=m.Xi.bind(null,"measure",null),$=(0,i.connect)((0,p.P1)([e=>({measurement:e.measurement||{},uom:e.measurement&&e.measurement.uom||{length:{unit:"m",label:"m"},area:{unit:"sqm",label:"m²"}},lineMeasureEnabled:e.measurement&&e.measurement.lineMeasureEnabled,lineMeasureValueEnabled:!(0,g.m6)(e),areaMeasureEnabled:e.measurement&&e.measurement.areaMeasureEnabled,areaMeasureValueEnabled:!(0,g.m6)(e),bearingMeasureEnabled:e.measurement&&e.measurement.bearingMeasureEnabled,showLengthAndBearingLabel:e.measurement&&e.measurement.showLengthAndBearingLabel,bearingMeasureValueEnabled:!(0,g.m6)(e),isCoordinateEditorEnabled:(0,h.iL)(e),showCoordinateEditor:(0,c.Iz)(e),showFeatureSelector:(0,g.m6)(e),useSingleFeature:!(0,g.m6)(e),withReset:(0,g.m6)(e),showExportToGeoJSON:(0,g.m6)(e),showAddAsAnnotation:(0,h.cD)(e)&&(0,g.m6)(e),trueBearing:(0,h.jM)(e),showAddAsLayer:(0,g.m6)(e),isCoordEditorEnabled:e.measurement&&!e.measurement.isDrawing,geomType:e.measurement&&e.measurement.geomType,format:e.measurement&&e.measurement.format,dockStyle:(0,Q.ic)(e,{height:!0,right:!0},!0)}),e=>(0,c.QF)(e)],((e,t)=>({...e,show:t,format:e.format||b.ZP.getConfigProp("defaultCoordinateFormat")||"decimal"}))),{toggleMeasure:d.Bd,onAddAnnotation:d.ud,onChangeUom:d.Gd,onHighlightPoint:u.aS,onChangeFormat:d.RM,onInit:d.S1,onChangeCoordinates:d.dD,onChangeCurrentFeature:d.h2,onClose:K,onMount:e=>(0,m.Xg)("measure","showCoordinateEditor",e),onAddAsLayer:d.NR},null,{pure:!1})(W),_={MeasurePlugin:o()($,{disablePluginIf:"{state('mapType') === 'cesium'}",BurgerMenu:{name:"measurement",position:9,panel:!1,help:s().createElement(y.Z,{msgId:"helptexts.measureComponent"}),tooltip:"measureComponent.tooltip",text:s().createElement(y.Z,{msgId:"measureComponent.Measure"}),icon:s().createElement(l.Glyphicon,{glyph:"1-ruler"}),action:()=>(0,m.Xg)("measure","enabled",!0),doNotHide:!0,priority:2},SidebarMenu:{name:"measurement",position:9,panel:!1,help:s().createElement(y.Z,{msgId:"helptexts.measureComponent"}),tooltip:"measureComponent.tooltip",text:s().createElement(y.Z,{msgId:"measureComponent.Measure"}),icon:s().createElement(l.Glyphicon,{glyph:"1-ruler"}),action:m.Xi.bind(null,"measure",null),toggle:!0,toggleControl:"measure",toggleProperty:"enabled",doNotHide:!0,priority:1}}),reducers:{measurement:r(7070).Z},epics:r(129125).ZP}},638510:(e,t,r)=>{"use strict";r.d(t,{Z:()=>w});var n=r(353131),o=r.n(n),a=r(727418),s=r.n(a),l=r(45697),i=r.n(l),p=r(124852),u=r.n(p),m=r(630294),d=r(171703),c=r(12838),g=r(687753),h=r(723813),b=r(956611),y=r(804504),f=r(401811),E=r(23888);function v(){return v=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},v.apply(this,arguments)}function T(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const C=(0,d.connect)((e=>({isVisible:e.controls&&e.controls.help&&e.controls.help.enabled})),{changeHelpText:h.n2,changeHelpwinVisibility:h.SA})(b.Z);class M extends u().Component{constructor(){super(...arguments),T(this,"getToolConfig",(e=>e.tool?{}:this.props.toolCfg)),T(this,"getTool",(e=>{if(e.tool)return!0===e.tool?e.plugin:e.tool;let t=()=>({});const r={};return e.exclusive?(t=t=>({active:t.controls&&t.controls[this.props.stateSelector]&&t.controls[this.props.stateSelector].active===e.name}),r[this.props.eventSelector]=g.Xg.bind(null,this.props.stateSelector,"active",e.name,!0)):e.toggle?(t=t=>({bsStyle:t.controls[e.toggleControl||e.name]&&t.controls[e.toggleControl||e.name][e.toggleProperty||"enabled"]?this.props.activeStyle:this.props.toolStyle,active:t.controls[e.toggleControl||e.name]&&t.controls[e.toggleControl||e.name][e.toggleProperty||"enabled"]||!1}),r[this.props.eventSelector]=g.Xi.bind(null,e.toggleControl||e.name,e.toggleProperty||null)):e.action&&(r[this.props.eventSelector]=o()(e.action,this.context),t=e.selector||t),(0,d.connect)(t,r,((e,t,r)=>this.mergeHandlers({...r,...e},t)))(this.props.tool)})),T(this,"renderTool",((e,t)=>{if(e.element)return e.element;const r=e.help?u().createElement(C,{className:"mapstore-helpbadge",helpText:e.help}):u().createElement("span",null),n=e.tooltip?u().createElement(y.Z,{msgId:e.tooltip}):null,o=this.getTool(e),a=this.getToolConfig(e),s=e.childTools||[];return this.addTooltip(u().createElement(o,v({},a,{pluginCfg:e.cfg,tooltip:n,style:e.style,btnSize:this.props.toolSize,bsStyle:this.props.toolStyle,help:r,key:e.name||"tool"+t,mapType:this.props.mapType},e.cfg,{items:e.items||[]}),e.cfg&&e.cfg.glyph?u().createElement(m.Glyphicon,{glyph:e.cfg.glyph}):e.icon,r," ",e.text,s.length>0&&u().createElement(M,v({},e.innerProps,{mapType:this.props.mapType,tools:s,panels:e.childPanels}))),e)})),T(this,"renderTools",(()=>this.props.tools.map(this.renderTool))),T(this,"renderPanels",(()=>this.props.panels.filter((e=>!e.panel.loadPlugin)).map((e=>{const t=e.panel,r=u().createElement(t,v({key:e.name,mapType:this.props.mapType},e.cfg,e.props||{},{items:e.items||[]})),n=e.title?u().createElement(y.Z,{msgId:e.title}):null;return e.wrap?u().createElement(m.Collapse,{key:"mapToolBar-item-collapse-"+e.name,in:this.props.activePanel===e.name},u().createElement(m.Panel,{header:n,style:this.props.panelStyle,className:this.props.panelClassName},r)):r})))),T(this,"mergeHandlers",((e,t)=>Object.keys(t).reduce(((r,n)=>s()(r,{[n]:e[n]?(0,c.qC)(e[n],t[n]):t[n]})),e))),T(this,"addTooltip",((e,t)=>{if(t.tooltip){let r=u().createElement(m.Tooltip,{id:this.props.id+"-"+t.name+"-tooltip"},u().createElement(y.Z,{msgId:t.tooltip}));return u().createElement(f.Z,{key:this.props.id+"-"+t.name+"-overlay",rootClose:!0,placement:"left",overlay:r},e)}return e}))}render(){const e=this.props.container;return u().createElement("span",{id:this.props.id,style:this.props.containerWrapperStyle},u().createElement(e,{id:this.props.id+"-container",style:this.props.style,className:this.props.className},this.renderTools()),this.renderPanels())}}T(M,"propTypes",{id:i().string.isRequired,container:i().func,containerWrapperStyle:i().object,tool:i().oneOfType([i().object,i().func]),className:i().string,style:i().object,tools:i().array,panels:i().array,mapType:i().string,toolStyle:i().string,activeStyle:i().string,toolSize:i().string,stateSelector:i().string.isRequired,eventSelector:i().string,panelStyle:i().object,panelClassName:i().string,activePanel:i().string,toolCfg:i().object}),T(M,"contextTypes",{messages:i().object,router:i().object}),T(M,"defaultProps",{container:m.Panel,className:"tools-container",style:{},toolStyle:"default",activeStyle:"primary",tools:[],panels:[],tool:E.Z,mapType:"leaflet",eventSelector:"onClick",panelStyle:{},panelClassName:"tools-container-panel",toolSize:null,toolCfg:{}});const w=M},488400:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var n=r(171703),o=r(804504);const a=(0,n.connect)((e=>({locale:e.locale&&e.locale.currentLocale,messages:e.locale&&e.locale.messages||[]})))(o.Z)},7070:(e,t,r)=>{"use strict";r.d(t,{Z:()=>v});var n=r(976719),o=r(687753),a=r(521923),s=r(454295),l=r(556233),i=r(782527),p=r(843624),u=r.n(p),m=r(441609),d=r.n(m),c=r(630998),g=r.n(c),h=r(281763),b=r.n(h),y=r(727418),f=r.n(y);const E={lineMeasureEnabled:!0,geomType:"LineString",areaMeasureEnabled:!1,bearingMeasureEnabled:!1,customStartEndPoint:{startPointOptions:{radius:3,fillColor:"green"},endPointOptions:{radius:3,fillColor:"red"}},uom:{length:{unit:"m",label:"m"},area:{unit:"sqm",label:"m²"}},lengthFormula:"haversine",showLabel:!0,showSegmentLengths:!0,currentFeature:0,features:[]},v=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case n.lD:{var r;const n=null!==t.geomType&&g()(e.features,(e=>{var r,n;return("bearing"===((null===(r=e.properties)||void 0===r||null===(n=r.values)||void 0===n?void 0:n[0])||{}).type?"Bearing":e.geometry.type)===t.geomType}));return f()({},e,{lineMeasureEnabled:t.geomType!==e.geomType&&"LineString"===t.geomType,areaMeasureEnabled:t.geomType!==e.geomType&&"Polygon"===t.geomType,bearingMeasureEnabled:t.geomType!==e.geomType&&"Bearing"===t.geomType,geomType:t.geomType===e.geomType?null:t.geomType,features:null===t.geomType?[]:e.features,textLabels:null===t.geomType?[]:e.textLabels,feature:{properties:{disabled:!0}},currentFeature:-1!==n?n:(null===(r=e.features)||void 0===r?void 0:r.length)||0,len:0,area:0,bearing:0})}case n.yK:{let r=t.feature;return(0,i.oU)(r)&&(r=(0,a.t8)("geometry.coordinates[0]",u()(r.geometry.coordinates[0]),r)),f()({},e,{lineMeasureEnabled:t.lineMeasureEnabled,areaMeasureEnabled:t.areaMeasureEnabled,bearingMeasureEnabled:t.bearingMeasureEnabled,geomType:t.geomType,values:t.values,feature:(0,a.t8)("properties.disabled",e.feature.properties.disabled,r),point:t.point,len:t.len,area:t.area,bearing:t.bearing,lenUnit:t.lenUnit,areaUnit:t.areaUnit})}case n.sc:{const{point:r,len:n,area:o,bearing:a}=t.measures;return{...e,point:r,len:n,area:o,bearing:a}}case n.Qw:return{...(0,a.t8)("feature.properties.disabled",!0,e),isDrawing:!0,updatedByUI:!1};case n.gf:{const r="length"===t.uom?"lenUnit":"lenArea",{value:n,label:o}=t.value;return f()({},e,{[r]:n,uom:f()({},t.previousUom,{[t.uom]:{unit:n,label:o}}),updatedByUI:!0})}case n.Qr:{var p;let{features:r=[]}=t;const n=(0,s.k2)(r),o=(null===(p=e.features)||void 0===p?void 0:p.length)===r.length?e.currentFeature:r.length?r.length-1:0;return{...e,features:r,currentFeature:o,geomTypeSelected:n,updatedByUI:!1,isDrawing:!1,...d()(r)&&{exportToAnnotation:!1}}}case n.Kf:{let{property:r,value:n}=t;return{...e,[r]:n}}case n.ES:{let{features:r,properties:n}=t;const o=(0,s.k2)(r);return{...e,features:r,geomTypeSelected:o,updatedByUI:!0,isDrawing:!1,exportToAnnotation:!0,id:n.id,visibility:n.visibility}}case n.Kx:return{...e,textLabels:t.textLabels};case n.V:return{...e,currentFeature:b()(t.featureIndex)?t.featureIndex:e.features.length};case o.kM:{const{id:r,...n}=e;return"info"===t.control?{...n,len:0,area:0,bearing:0,lineMeasureEnabled:!1,areaMeasureEnabled:!1,bearingMeasureEnabled:!1,feature:{properties:{disabled:!0}},geomType:""}:"measure"===t.control?{...n,geomType:"",lineMeasureEnabled:!1,areaMeasureEnabled:!1,bearingMeasureEnabled:!1}:e}case o.At:return"measure"===t.control&&!1===t.value?{...e,geomType:"",lineMeasureEnabled:!1,areaMeasureEnabled:!1,bearingMeasureEnabled:!1}:e;case o.l:return{...e,len:0,area:0,bearing:0,lineMeasureEnabled:!1,areaMeasureEnabled:!1,bearingMeasureEnabled:!1,feature:{properties:{disabled:!0}},geomType:"",features:[]};case n.GI:return{...e,format:t.format};case n.qg:return{...e,...t.defaultOptions};case n.MT:{var m;const r=t.coordinates.map((e=>[e.lon,e.lat])),n=e.features||[],o=n[e.currentFeature]||{},a=r.filter((e=>(0,l.wd)(e))).length!==r.length;return{...e,feature:{type:"Feature",properties:{disabled:r.filter((e=>(0,l.wd)(e))).length!==r.length},geometry:{type:e.bearingMeasureEnabled?"LineString":e.geomType,coordinates:e.areaMeasureEnabled?[u()(r)]:r}},features:[...n.slice(0,e.currentFeature),{...o,type:"Feature",properties:{...o.properties||{},disabled:a||e.bearingMeasureEnabled&&r.length<2},geometry:{type:e.bearingMeasureEnabled?"LineString":e.geomType,coordinates:e.areaMeasureEnabled?[[...r,r[0]]]:r,textLabels:(null==o||null===(m=o.geometry)||void 0===m?void 0:m.textLabels)||[]}},...n.slice(e.currentFeature+1,n.length)],updatedByUI:!0}}default:return e}}},870820:(e,t,r)=>{"use strict";r.d(t,{JF:()=>p,iL:()=>u,cD:()=>m,jM:()=>d,VH:()=>g,on:()=>h});var n=r(101092),o=r(119008),a=r(521923),s=r(556233),l=r(227361),i=r.n(l);const p=e=>i()(e,"controls.measure.enabled"),u=e=>(0,o.Iz)(e)&&!e.measurement.isDrawing&&(0,n.m6)(e),m=e=>e&&e.measurement&&e.measurement.showAddAsAnnotation,d=e=>e&&e.measurement&&e.measurement.trueBearing&&e.measurement.trueBearing.measureTrueBearing,c=e=>{let t=e.measurement.feature||{};return t.geometry&&(t=(0,a.t8)("geometry.coordinates",(0,s.L0)(t.geometry||{}),t)),t},g=e=>e.measurement&&{...e.measurement,feature:c(e)}||{},h=e=>{var t;return null==e||null===(t=e.measurement)||void 0===t?void 0:t.geomType}},782527:(e,t,r)=>{"use strict";r.d(t,{y7:()=>E,oU:()=>v,hH:()=>T});var n=r(573800),o=r(345801),a=r(386306),s=r(718369),l=r(878516),i=r(500052),p=r(848041),u=r(978653),m=r(497950),d=r(752043),c=r(944538),g=r(552329),h=r(525642),b=r(513987),y=r(869669),f=r(640353);const E=function(){let e,{type:t,coordinates:r,radius:n,center:o}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};switch(t){case"Point":e=new d.Z(r||[]);break;case"LineString":e=new c.Z(r||[]);break;case"MultiPoint":e=new g.Z(r||[]);break;case"MultiLineString":e=new h.Z(r||[]);break;case"MultiPolygon":e=new b.Z(r||[]);break;default:e=n&&o?(0,f.Bb)(new y.Z([o.x,o.y],n),100):new f.ZP(r||[])}return e},v=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e&&e.geometry&&"Polygon"===e.geometry.type},T={dragPan:{options:{kinetic:!1},Instance:n.Z},keyboardPan:{options:{kinetic:!1},Instance:o.Z},mouseWheelZoom:{options:{duration:0},Instance:a.Z},doubleClickZoom:{options:{duration:0},Instance:s.Z},shiftDragZoom:{options:{duration:0},Instance:l.Z},keyboardZoom:{options:{},Instance:i.Z},pinchZoom:{options:{duration:0},Instance:p.Z},pinchRotate:{options:{},Instance:u.Z},altShiftDragRotate:{options:{},Instance:m.Z}}},843624:(e,t,r)=>{var n=r(314259),o=r(640554);e.exports=function(e,t,r){var a=null==e?0:e.length;return a?(t=r||void 0===t?1:o(t),n(e,0,(t=a-t)<0?0:t)):[]}}}]);