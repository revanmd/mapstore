(self.webpackChunkmapstore2=self.webpackChunkmapstore2||[]).push([[3507],{507633:(e,t,o)=>{"use strict";o.d(t,{X:()=>n,e:()=>s});const n="SAVE:CHECK_PENDING_CHANGES",s=(e,t)=>({type:n,action:e,source:t})},267152:(e,t,o)=>{"use strict";o.d(t,{D:()=>C,Z:()=>f});var n=o(124852),s=o.n(n),a=o(23888),r=o(45697),i=o.n(r),l=o(630294),c=o(401811),p=o(804504),d=o(283604),h=o(227361),m=o.n(h),g=o(478718),u=o.n(g),b=o(234228);function v(){return v=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},v.apply(this,arguments)}function y(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}const C=()=>{const e=b.ZP.getConfigProp("miscSettings");return m()(e,["homePath"],"/")};class M extends s().Component{constructor(){super(...arguments),y(this,"checkUnsavedChanges",(()=>{this.props.renderUnsavedMapChangesDialog?this.props.onCheckMapChanges(this.goHome):(this.props.onCloseUnsavedDialog(),this.goHome())})),y(this,"goHome",(()=>{this.context.router.history.push(C())}))}render(){const{tooltipPosition:e,hidden:t,...o}=this.props;let n=s().createElement(l.Tooltip,{id:"toolbar-home-button"},s().createElement(p.Z,{msgId:"gohome"}));return!t&&s().createElement(s().Fragment,null,s().createElement(c.Z,{overlay:n,placement:e},s().createElement(a.Z,v({id:"home-button",className:"square-button",bsStyle:this.props.bsStyle,onClick:this.checkUnsavedChanges,tooltip:n},u()(o,["disabled","active","block","componentClass","href","children","icon","bsStyle","className"])),s().createElement(l.Glyphicon,{glyph:this.props.icon}))),s().createElement(d.Z,{ref:"unsavedMapModal",show:this.props.displayUnsavedDialog||!1,onClose:this.props.onCloseUnsavedDialog,title:s().createElement(p.Z,{msgId:"resources.maps.unsavedMapConfirmTitle"}),buttons:[{bsStyle:"primary",text:s().createElement(p.Z,{msgId:"resources.maps.unsavedMapConfirmButtonText"}),onClick:this.goHome},{text:s().createElement(p.Z,{msgId:"resources.maps.unsavedMapCancelButtonText"}),onClick:this.props.onCloseUnsavedDialog}],fitContent:!0},s().createElement("div",{className:"ms-detail-body"},s().createElement(p.Z,{msgId:"resources.maps.unsavedMapConfirmMessage"}))))}}y(M,"propTypes",{icon:i().string,onCheckMapChanges:i().func,onCloseUnsavedDialog:i().func,displayUnsavedDialog:i().bool,renderUnsavedMapChangesDialog:i().bool,tooltipPosition:i().string,bsStyle:i().string,hidden:i().bool}),y(M,"contextTypes",{router:i().object,messages:i().object}),y(M,"defaultProps",{icon:"home",onCheckMapChanges:()=>{},onCloseUnsavedDialog:()=>{},renderUnsavedMapChangesDialog:!0,tooltipPosition:"left",bsStyle:"primary",hidden:!1});const f=M},409442:(e,t,o)=>{"use strict";o.d(t,{c:()=>D});var n=o(49977),s=o.n(n),a=o(687753),r=o(945395),i=o(618446),l=o.n(i),c=o(500711),p=o.n(c),d=o(313311),h=o.n(d),m=o(957557),g=o.n(m),u=o(22222),b=o(952273),v=o(641259);const y=(0,u.P1)(v.NB,v.hS,b.hF,b.nA,((e,t,o,n)=>{const s=(null==t?void 0:t.widgets)||[],a=(null==t?void 0:t.layouts)||{};return!e||e.canEdit&&(!l()(a,n)||s.length!==o.length||!p()(o,(e=>{const t=h()(s,{id:e.id}),o=null==t?void 0:t.map,n=e.map,a=null==o?void 0:o.center,r=null==n?void 0:n.center;return!!t&&l()(g()(e,"dependenciesMap","map"),g()(t,"dependenciesMap","map"))&&(!n&&!o||l()(g()(n,"center","bbox","size"),g()(o,"center","bbox","size")))&&(!n&&!o||!a&&!r||!!a&&!!r&&a.crs===r.crs&&Math.abs(a.x-r.x)<1e-12&&Math.abs(a.y-r.y)<1e-12)})))}));var C=o(796205),M=o(943476),f=o(412961),E=o(507633),P=o(275982);const D=(e,t)=>{let{getState:o=(()=>{})}=t;return e.ofType(E.X).switchMap((t=>{let{action:n,source:i}=t;const l=o(),{currentPage:c}=(0,M.I)(l),p="viewer"===c&&(0,r.In)(l),d="geostory"===c&&(0,C.Pb)(l),h="dashboard"===c&&y(l);return p||d||h?s().Observable.of((0,a.Xg)("unsavedMap","enabled",!0),(0,a.Xg)("unsavedMap","source",i,!1)).merge(e.ofType(P.nk,f.Nv).take(1).switchMap((()=>s().Observable.of((0,a.Xg)("unsavedMap","enabled",!1),(0,a.Xg)("unsavedMap","source",void 0))))):n?s().Observable.of(n):s().Observable.empty()}))}},561253:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>M});var n=o(124852),s=o.n(n),a=o(727418),r=o.n(a);function i(e,t){return t&&t.history.push(e),{type:"GO_TO_PAGE",page:e}}var l=o(409442),c=o(488400),p=o(630294),d=o(267152),h=o(171703),m=o(507633),g=o(687753),u=o(119008),b=o(943476),v=o(234228),y=o(652700);const C=(0,h.connect)((e=>({renderUnsavedMapChangesDialog:v.ZP.getConfigProp("unsavedMapChangesDialog"),displayUnsavedDialog:(0,u.Eg)(e)&&"gohome"===(0,u.nS)(e)&&("viewer"===(0,b.I)(e).currentPage||"geostory"===(0,b.I)(e).currentPage||"dashboard"===(0,b.I)(e).currentPage)})),{onCheckMapChanges:e=>t=>{t((0,m.e)(e,"gohome"))},onCloseUnsavedDialog:g.Xg.bind(null,"unsavedMap","enabled",!1)})(d.Z),M={HomePlugin:r()(C,{Toolbar:{name:"home",position:1,tooltip:"gohome",icon:s().createElement(p.Glyphicon,{glyph:"home"}),help:s().createElement(c.Z,{msgId:"helptexts.gohome"}),action:e=>i((0,d.D)(),e.router),priority:1},BurgerMenu:{name:"home",position:1,text:s().createElement(c.Z,{msgId:"gohome"}),icon:s().createElement(p.Glyphicon,{glyph:"home"}),action:e=>i((0,d.D)(),e.router),priority:2},OmniBar:{name:"home",position:4,tool:(0,h.connect)((e=>({hidden:(0,y.z)(e),bsStyle:"primary",tooltipPosition:"bottom"})))(C),priority:3},SidebarMenu:{name:"home",position:1,tool:(0,h.connect)((()=>({bsStyle:"tray",tooltipPosition:"left",text:s().createElement(c.Z,{msgId:"gohome"})})))(C),selector:e=>({style:{display:(0,u.$)(e)?"none":null}}),priority:3}}),reducers:{},epics:{comparePendingChanges:l.c}}},488400:(e,t,o)=>{"use strict";o.d(t,{Z:()=>a});var n=o(171703),s=o(804504);const a=(0,n.connect)((e=>({locale:e.locale&&e.locale.currentLocale,messages:e.locale&&e.locale.messages||[]})))(s.Z)},652700:(e,t,o)=>{"use strict";o.d(t,{T:()=>a,z:()=>r});var n=o(227361),s=o.n(n);const a=e=>s()(e,"sidebarmenu.lastActiveItem",!1),r=e=>s()(e,"controls.sidebarMenu.enabled",!1)}}]);