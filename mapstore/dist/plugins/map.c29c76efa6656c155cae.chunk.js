(self.webpackChunkmapstore2=self.webpackChunkmapstore2||[]).push([[9392],{403410:(e,t,n)=>{"use strict";n.d(t,{hn:()=>o,yg:()=>r,vD:()=>s,jJ:()=>i,oy:()=>a,W:()=>l,B1:()=>p,fU:()=>u,cY:()=>d});const o="ADDITIONALLAYER:ADD_ADDITIONAL_LAYERS",r="ADDITIONALLAYER:REMOVE_ADDITIONAL_LAYER",s="ADDITIONALLAYER:REMOVE_ALL_ADDITIONAL_LAYERS",i="ADDITIONALLAYER:UPDATE_ADDITIONAL_LAYER",a="ADDITIONALLAYER:UPDATE_OPTIONS_BY_OWNER",l=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"override",o=arguments.length>3?arguments[3]:void 0;return{type:i,id:e,owner:t,actionType:n,options:o}},p=(e,t)=>({type:a,owner:e,options:t}),u=function(){let{id:e,owner:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:r,id:e,owner:t}},d=e=>({type:s,owner:e})},483058:(e,t,n)=>{"use strict";n.d(t,{fy:()=>o,gd:()=>r,zZ:()=>s,ZR:()=>i});const o="BOX_END",r="CHANGE_BOX_SELECTION_STATUS";function s(e){return{type:o,boxEndInfo:e}}function i(e){return{type:r,status:e}}},253816:(e,t,n)=>{"use strict";n.d(t,{F2:()=>o,fu:()=>r,NF:()=>s,WP:()=>i,_E:()=>a});const o="HIGHLIGHT_STATUS",r="UPDATE_HIGHLIGHTED",s="HIGHLIGHT:SET_HIGHLIGHT_FEATURES_PATH";function i(e){return{type:s,featuresPath:e}}function a(e,t){return{type:r,features:e,status:t}}},976719:(e,t,n)=>{"use strict";n.d(t,{lD:()=>o,yK:()=>r,gf:()=>s,Qr:()=>i,Kx:()=>a,V:()=>l,Wt:()=>p,Qw:()=>u,GI:()=>d,MT:()=>c,XX:()=>m,sc:()=>g,qg:()=>h,Kf:()=>y,ES:()=>f,ud:()=>E,Bd:()=>T,pO:()=>v,Gd:()=>b,$3:()=>L,el:()=>w,CG:()=>S,h2:()=>M,NR:()=>O,RM:()=>C,dD:()=>A,wB:()=>N,Y_:()=>x,nl:()=>_,S1:()=>I});const o="CHANGE_MEASUREMENT_TOOL",r="CHANGE_MEASUREMENT_STATE",s="MEASUREMENT:CHANGE_UOM",i="MEASUREMENT:CHANGED_GEOMETRY",a="MEASUREMENT:SET_TEXT_LABELS",l="MEASUREMENT:SET_CURRENT_FEATURE",p="MEASUREMENT:ADD_AS_LAYER",u="MEASUREMENT:RESET_GEOMETRY",d="MEASUREMENT:CHANGE_FORMAT",c="MEASUREMENT:CHANGE_COORDINATES",m="MEASUREMENT:ADD_MEASURE_AS_ANNOTATION",g="MEASUREMENT:UPDATE_MEASURES",h="MEASUREMENT:INIT",y="MEASUREMENT:SET_MEASUREMENT_CONFIG",f="MEASUREMENT:SET_ANNOTATION_MEASUREMENT";function E(e,t,n,o,r){return{type:m,features:e,textLabels:t,uom:n,save:o,properties:r}}function T(e){return t=>{t(function(e){return{type:o,...e}}(e))}}function v(e,t){return{type:f,features:e,properties:t}}function b(e,t,n){return{type:s,uom:e,value:t,previousUom:n}}function L(e){return{type:i,features:e}}function w(e,t){return{type:y,property:e,value:t}}function S(e){return{type:a,textLabels:e}}function M(e){return{type:l,featureIndex:e}}function O(e,t,n){return{type:p,features:e,textLabels:t,uom:n}}function C(e){return{type:d,format:e}}function A(e){return{type:c,coordinates:e}}function N(){return{type:u}}function x(e){return{type:g,measures:e}}function _(e){return{type:r,pointMeasureEnabled:e.pointMeasureEnabled,lineMeasureEnabled:e.lineMeasureEnabled,areaMeasureEnabled:e.areaMeasureEnabled,bearingMeasureEnabled:e.bearingMeasureEnabled,geomType:e.geomType,values:e.values,feature:e.feature,point:e.point,len:e.len,area:e.area,bearing:e.bearing,lenUnit:e.lenUnit,areaUnit:e.areaUnit}}function I(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:h,defaultOptions:e}}},882150:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>Re});var o=n(45697),r=n.n(o),s=n(124852),i=n.n(s),a=n(152543);const l=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0,s=e,i=o,a=r,l=s;if({NODE_ENV:"production"}.isTest){const e={},t=t=>(e[t]=e[t]||{rootCount:0,iframesCreated:!1,timedOut:!1,fontLoaded:!1,requiredExtraTimeout:!1},e[t]);window.reporter=window.reporter||{modifyRootCount(e,n){t(e).rootCount+=n},iframesCreated(e){t(e).iframesCreated=!0},timedOut(e){t(e).timedOut=!0},fontLoaded(e){t(e).fontLoaded=!0},requiredExtraTimeout(e){t(e).requiredExtraTimeout=!0},getTests:()=>e}}n.timeoutAfter&&setTimeout((()=>{i&&({NODE_ENV:"production"}.isTest&&window.reporter.modifyRootCount(l,-1),document.body.removeChild(i),i=0,n.onTimeout&&({NODE_ENV:"production"}.isTest&&window.reporter.timedOut(l),n.onTimeout()))}),n.timeoutAfter),a=()=>{i&&i.firstChild.clientWidth===i.lastChild.clientWidth&&({NODE_ENV:"production"}.isTest&&window.reporter.modifyRootCount(l,-1),document.body.removeChild(i),i=0,{NODE_ENV:"production"}.isTest&&window.reporter.fontLoaded(l),t())},{NODE_ENV:"production"}.isTest&&window.reporter.modifyRootCount(l,1),{NODE_ENV:"production"}.isLegacy||a(document.body.appendChild(i=document.createElement("div")).innerHTML='<div style="position:fixed;white-space:pre;bottom:999%;right:999%;font:999px '+(n.generic?"":"'")+s+(n.generic?"":"'")+',serif">'+(n.sampleText||" ")+'</div><div style="position:fixed;white-space:pre;bottom:999%;right:999%;font:999px '+(n.generic?"":"'")+s+(n.generic?"":"'")+',monospace">'+(n.sampleText||" ")+"</div>"),{NODE_ENV:"production"}.isLegacy&&a(document.body.appendChild(i=document.createElement("div")).innerHTML='<table style=position:absolute;bottom:999%;right:999%;width:auto><tr><td style=position:relative><tr><td style="font:999px monospace;white-space:pre">.<span style="font:999px '+(n.generic?"":"'")+s+(n.generic?"":"'")+',serif">'+(n.sampleText||" ")+'</span>.</table><table style=position:absolute;bottom:999%;right:999%;width:auto><tr><td style=position:relative><tr><td style="font:999px monospace;white-space:pre">.<span style="font:999px '+(n.generic?"":"'")+s+(n.generic?"":"'")+',monospace">'+(n.sampleText||" ")+"</span>.</table>"),i&&({NODE_ENV:"production"}.isTest&&window.reporter.iframesCreated(l),{NODE_ENV:"production"}.isLegacy||(i.firstChild.appendChild(s=document.createElement("iframe")).style.width="999%",s.contentWindow.onresize=a,i.lastChild.appendChild(s=document.createElement("iframe")).style.width="999%",s.contentWindow.onresize=a),{NODE_ENV:"production"}.isLegacy&&(i.firstChild.firstChild.firstChild.firstChild.appendChild(s=document.createElement("iframe")).style.cssText="position:absolute;bottom:999%;right:999%;width:999%",s.attachEvent?s.contentWindow.attachEvent("onresize",a):s.contentWindow.onresize=a,i.lastChild.firstChild.firstChild.firstChild.appendChild(s=document.createElement("iframe")).style.cssText="position:absolute;bottom:999%;right:999%;width:999%",s.attachEvent?s.contentWindow.attachEvent("onresize",a):s.contentWindow.onresize=a),{NODE_ENV:"production"}.isTest||(s=setTimeout(a)),{NODE_ENV:"production"}.isTest&&(s=setTimeout((function(){i&&(window.reporter.requiredExtraTimeout(l),a())}))))};var p=n(472986),u=n.n(p),d=n(893379),c=n.n(d),m=n(92623);c()(m.Z,{insert:"head",singleton:!1}),m.Z.locals;var g=n(804504),h=n(234228),y=n(859518),f=n(747037),E=n.n(f),T=n(22222),v=n(274363),b=n(101092),L=n(612912),w=n(227361),S=n.n(w),M=n(351546);const O=e=>S()(e,e&&e.featuregrid&&e.featuregrid.open&&e.featuregrid.showFilteredObject?"query.filterObj.spatialField":"emptyObject"),C=e=>O(e)&&O(e).geometry,A=(0,T.P1)([e=>C(e)&&C(e).coordinates||[],e=>C(e)&&C(e).type||"Polygon",e=>C(e)&&C(e).id||"spatial_object",e=>C(e)&&C(e).projection||"EPSG:3857"],((e,t,n,o)=>{let r={type:"FeatureCollection",features:[{type:"Feature",geometry:{type:t,coordinates:e},style:{fillColor:"#FFFFFF",fillOpacity:"0.2",color:"#ffcc33"},id:n}]};return e.length>0&&t?(0,M.reprojectGeoJson)(r,o,"EPSG:4326").features:[]})),N=(0,T.P1)([A,e=>S()(e,e&&e.highlight&&e.highlight.featuresPath||"highlight.emptyFeatures")||[]],((e,t)=>[...t,...e]));var x=n(510644),_=n(707366),I=n(665529);const D=(0,T.zB)({projectionDefs:v.pb,map:v.Od,mapType:b.$v,layers:L.Hi,features:N,loadingError:e=>e.mapInitialConfig&&e.mapInitialConfig.loadingError&&e.mapInitialConfig.loadingError.data,securityToken:x.y8,elevationEnabled:v.zT,shouldLoadFont:b.m6,isLocalizedLayerStylesEnabled:I.wk,localizedLayerStylesName:I.c3,currentLocaleLanguage:_.KV});var P=n(171703),k=n(630294);const R=(0,T.P1)(v.Od,b.$v,b.c0,((e,t,n)=>({map:e,mapType:t,isCesium:n}))),F={updateConfigAction:y.aN},q=(0,P.connect)(R,F)((e=>{let{map:t,mapType:n,isCesium:o,updateConfigAction:r,mapOptions:s}=e;const a={...s&&s[n]||h.ZP.getConfigProp("defaultMapOptions")&&h.ZP.getConfigProp("defaultMapOptions")[n]||{},...null==t?void 0:t.mapOptions},l=(e,t)=>{r({[t]:!e[t]})};return o?i().createElement("form",null,i().createElement(k.FormGroup,null,i().createElement(k.ControlLabel,null,i().createElement(g.Z,{msgId:"map.settings.title"}))),i().createElement(k.Checkbox,{checked:a.showSkyAtmosphere,onChange:()=>l(a,"showSkyAtmosphere")},i().createElement(g.Z,{msgId:"map.settings.skyAtmosphere"})),i().createElement(k.Checkbox,{checked:a.showGroundAtmosphere,onChange:()=>l(a,"showGroundAtmosphere")},i().createElement(g.Z,{msgId:"map.settings.groundAtmosphere"})),i().createElement(k.Checkbox,{checked:a.enableFog,onChange:()=>l(a,"enableFog")},i().createElement(g.Z,{msgId:"map.settings.fog"})),i().createElement(k.Checkbox,{checked:a.depthTestAgainstTerrain,onChange:()=>l(a,"depthTestAgainstTerrain")},i().createElement(g.Z,{msgId:"map.settings.depthTest"}))):null}));var U=n(146619),G=n(815179),j=n(296252),H=n(727418),Z=n.n(H);const z={drawStatus:null,drawOwner:null,drawMethod:null,options:{},features:[],tempFeatures:[],snapping:!1,snappingIsLoading:!1,snappingLayer:!1},B={edge:!0,vertex:!0,pixelTolerance:10,strategy:"bbox"};var V=n(483058);const W={status:null};var Y=n(253816);const K={status:"disabled",layer:"featureselector",features:[],highlighted:0,featuresPath:"highlight.emptyFeatures",emptyFeatures:[]};var X=n(962565),J=n(403410),$=n(91175),Q=n.n($),ee=n(535937),te=n.n(ee),ne=n(406557),oe=n.n(ne),re=n(513218),se=n.n(re),ie=n(701469),ae=n.n(ie);var le=n(49977),pe=n.n(le),ue=n(333101),de=n(926854),ce=n(412961),me=n(350126),ge=n(687753),he=n(399790),ye=n(835516),fe=n(504518),Ee=n(917450),Te=n(66604),ve=n.n(Te);const be={checkMapPermissions:(e,t)=>{let{getState:n=(()=>{})}=t;return e.ofType(ce.XP).filter((()=>(0,v.J9)(n()))).map((()=>{const e=(0,v.J9)(n());return(0,de.I6)(e)}))},handleCreationLayerError:(e,t)=>e.ofType(y.TF).delay(500).switchMap((e=>{const n=(0,b.$v)(t.getState()),o=(0,L.CA)(t.getState(),e.options.id);return o&&(0,he.yJ)(o,n)?pe().Observable.from([(0,ue.He)(e.options.id,{invalid:!0})]):pe().Observable.empty()})),handleCreationBackgroundError:(e,t)=>e.ofType(y.TF).delay(500).filter((e=>{const n=(0,L.x)(t.getState());return n&&e.options.id===n.id&&"background"===e.options.group})).switchMap((e=>{const n=(0,b.$v)(t.getState()),o=Q()((0,L.pV)(t.getState()).filter((t=>(0,he.yJ)(t,n)&&t.id!==e.options.id)));return o?pe().Observable.from([(0,ue.He)(o.id,{visibility:!0}),(0,ge.Xg)("backgroundSelector","currentLayer",o),(0,ge.Xg)("backgroundSelector","tempLayer",o),(0,fe.Kp)({title:"warning",message:"notification.backgroundLayerNotSupported",action:{label:"close"},position:"tc"})]):pe().Observable.of((0,fe.Kp)({title:"warning",message:"notification.noBackgroundLayerSupported",action:{label:"close"},position:"tc"}))})),resetMapOnInit:e=>e.ofType(y.Ec).switchMap((()=>pe().Observable.of((0,J.cY)(),(0,ge.fV)(),(0,ue.nN)(),(0,Ee.XP)()))),resetLimitsOnInit:(e,t)=>e.ofType(de.ok,y.Li).switchMap((()=>{const e=(0,v.A0)(t.getState()),n=(0,v.zj)(t.getState()),o=(0,v.S)(t.getState());return pe().Observable.of((0,y.BV)({restrictedExtent:n,crs:e,minZoom:o}))})),zoomToExtentEpic:(e,t)=>{let{getState:n=(()=>{})}=t;return e.ofType(y.Qy).switchMap((e=>{const t=(e=>{if(ae()(e))return e.map((e=>"string"==typeof e||e instanceof String?Number(e):e));if(se()(e)){const t=ve()(e,(e=>"string"==typeof e||e instanceof String?Number(e):e));return[t.minx,t.miny,t.maxx,t.maxy]}return null})(e.extent);if(!t)return pe().Observable.empty();const o=ye.default.getHook(ye.default.ZOOM_TO_EXTENT_HOOK),r=(0,me.CF)(n());if(o){const{crs:n,maxZoom:s,options:i={}}=e;return o(t,{crs:n,padding:r,maxZoom:s,...i}),pe().Observable.empty()}return((e,t)=>{let n=0,{extent:o=[]}=e,r=M.default.reprojectBbox(o,e.crs,t.bbox&&t.bbox.crs||"EPSG:4326");if(r){let s=M.default.reproject(ye.default.getCenterForExtent(o,e.crs),e.crs,"EPSG:4326");if("EPSG:4326"===e.crs&&o&&o[0]<=-180&&o[1]<=-90&&o[2]>=180&&o[3]>=90)n=1;else{let r=M.default.reprojectBbox(o,e.crs,t.projection||"EPSG:4326");n=ye.default.getZoomForExtent(r,t.size,0,21,null)}e.maxZoom&&n>e.maxZoom&&(n=e.maxZoom);let i={minx:r[0],miny:r[1],maxx:r[2],maxy:r[3]},a={...t.bbox,bounds:i};return pe().Observable.of((0,y.o6)(s,n,a,t.size,e.mapStateSource,t.projection,t.viewerOptions))}return pe().Observable.empty()})({...e,extent:t},(0,v.Od)(n()))}))}};var Le=n(387305),we=n(976719),Se=n(870820);function Me(e){return{type:"CHANGE_SELECTION_STATE",geomType:e.geomType,point:e.point,line:e.line,polygon:e.polygon}}var Oe=n(308602);const Ce=()=>i().createElement("span",null);var Ae=n(117931),Ne=n(191332),xe=n(867517),_e=n(23888);const Ie=function(e){let{show:t,error:n,onReload:o}=e;return t?i().createElement("div",{className:"ms-map-error-panel",style:{position:"absolute",width:"100%",height:"100%",color:"#ffffff",background:"rgba(0, 0, 0, 0.75)",zIndex:100,top:0,left:0,display:"flex",alignItems:"center",justifyContent:"center"}},i().createElement("div",{style:{maxWidth:500}},i().createElement("h1",null,i().createElement(xe.Z,{msgId:"map.renderingErrorTitle"})),i().createElement("p",null,i().createElement(xe.Z,{msgId:"map.renderingErrorMessage"})),(null==n?void 0:n.message)&&i().createElement(k.Alert,{bsStyle:"danger"},i().createElement("small",null,n.message)),o&&i().createElement(_e.Z,{bsStyle:"primary",onClick:()=>o()},i().createElement(g.Z,{msgId:"map.reloadMap"})))):null};function De(){return De=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},De.apply(this,arguments)}function Pe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class ke extends i().Component{constructor(){super(...arguments),Pe(this,"state",{canRender:!0}),Pe(this,"getHighlightLayer",((e,t,n)=>{const o=this.state.plugins;return i().createElement(o.Layer,{type:"vector",srs:e,position:t,key:"highlight",options:{name:"highlight"},env:n},this.props.features.map((t=>i().createElement(o.Feature,{msId:t.id,key:t.id,crs:e,type:t.type,style:t.style||null,geometry:t.geometry}))))})),Pe(this,"getTool",(e=>E()(e)?{name:e,impl:this.state.plugins.tools[e]}:e[this.props.mapType]||e)),Pe(this,"getConfigMapOptions",(()=>this.props.mapOptions&&this.props.mapOptions[this.props.mapType]||h.ZP.getConfigProp("defaultMapOptions")&&h.ZP.getConfigProp("defaultMapOptions")[this.props.mapType]||{})),Pe(this,"renderLayers",(()=>{const e=this.props.map.projection||"EPSG:3857",t=[];this.props.isLocalizedLayerStylesEnabled&&t.push({name:this.props.localizedLayerStylesName,value:this.props.currentLocaleLanguage});const n=this.state.plugins;return[...this.props.layers,...this.props.additionalLayers].filter(this.filterLayer).map(((o,r)=>i().createElement(n.Layer,{type:o.type,srs:e,position:r,key:o.id||o.name,options:o,securityToken:this.props.securityToken,env:t},this.renderLayerContent(o,e)))).concat(this.props.features&&this.props.features.length&&this.getHighlightLayer(e,this.props.layers.length,t)||[])})),Pe(this,"renderLayerContent",((e,t)=>{const n=this.state.plugins;return e.features?e.features.filter((0,Ne.createFeatureFilter)(e.filterObj)).map((o=>i().createElement(n.Feature,{key:o.id,msId:o.id,type:o.type,crs:t,geometry:o.geometry,features:o.features,featuresCrs:e.featuresCrs||"EPSG:4326",layerStyle:e.style,style:o.style||e.style||null,properties:o.properties}))):null})),Pe(this,"renderSupportTools",(()=>{const e=this.props.items.filter((e=>{let{Tool:t}=e;return!!t})).map((e=>{let{Tool:t,name:n,cfg:o}=e;return i().createElement(t,De({},o,{key:n,mapType:this.props.mapType}))}));return this.props.tools.map((e=>{const t=this.getTool(e),n=this.props.toolsOptions[t.name]&&this.props.toolsOptions[t.name][this.props.mapType]||this.props.toolsOptions[t.name]||{};return i().createElement(t.impl,De({key:t.name},n))})).concat(e)})),Pe(this,"filterLayer",(e=>!e.useForElevation||"cesium"===this.props.mapType||this.props.elevationEnabled)),Pe(this,"updatePlugins",(e=>{this.currentMapType=e.mapType,e.onLoadingMapPlugins(!0),this.setState({plugins:void 0}),((e,t)=>Promise.all([n(657606)("./"+e+"/index"),n(188455)("./"+e+"/plugins/index")]).then((n=>{let[o]=n;const r=o.default,s=(0,P.connect)((e=>({projectionDefs:(0,v.pb)(e),mousePosition:(0,v.x9)(e)})),Z()({},{onMapViewChanges:y.o6,onClick:y.FP,onMouseMove:y.ou,onLayerLoading:ue.Yz,onLayerLoad:ue.kI,onLayerError:ue.XG,onWarning:fe.Kp,onMouseOut:y.NE},t),((e,t,n)=>Z()({},n,e,Z()({},t,{onMouseMove:e.mousePosition?t.onMouseMove:()=>{}}))))(r.LMap),i=(0,P.connect)((e=>({enabled:e.controls&&e.controls.measure&&e.controls.measure.enabled||!1,measurement:(0,Se.VH)(e),useTreshold:e.measurement&&e.measurement.useTreshold||null,uom:e.measurement&&e.measurement.uom||{length:{unit:"m",label:"m"},area:{unit:"sqm",label:"m²"}}})),{changeMeasurementState:we.nl,updateMeasures:we.Y_,resetGeometry:we.wB,changeGeometry:we.$3,setTextLabels:we.CG,changeMeasurement:we.Bd})(r.MeasurementSupport||Ce),a=(0,P.connect)((e=>({...e.draw??{},snappingLayerInstance:(0,Oe.lM)(e)})),{onChangeDrawingStatus:j.Yf,onEndDrawing:j.fo,onGeometryChanged:j.Vw,onSelectFeatures:j.KD,onDrawingFeatures:j.uj,onDrawStopped:j.lo,setCurrentStyle:j.PY,toggleSnappingIsLoading:j.sc})(r.DrawSupport||Ce),l=(0,P.connect)((0,T.P1)((e=>(e=>e&&e.box&&e.box.status)(e)),(e=>({status:e}))),{onBoxEnd:V.zZ})(r.BoxSelectionSupport||Ce),p=(0,P.connect)((e=>e.highlight||{}),{updateHighlighted:Y._E})(r.HighlightFeatureSupport||Ce),u=(0,P.connect)((e=>({selection:e.selection||{}})),{changeSelectionState:Me})(r.SelectionSupport||Ce),d=(0,P.connect)(null,{onWarning:fe.Kp})(r.Layer||Ce),c=[],m=(0,P.connect)((0,T.P1)((e=>e.mapPopups&&e.mapPopups.popups||c),(e=>({popups:e}))),{onPopupClose:Le.hC})(r.PopupSupport||Ce);return{Map:s,Layer:d,Feature:r.Feature||Ce,tools:{measurement:i,overview:r.Overview||Ce,scalebar:r.ScaleBar||Ce,draw:a,highlight:p,selection:u,popup:m,box:l},mapType:e}})))(e.mapType,e.actions).then((t=>{this._isMounted&&t.mapType===this.currentMapType&&(this.setState({plugins:t}),e.onLoadingMapPlugins(!1,e.mapType),e.onMapTypeLoaded(!0,e.mapType))}))}))}UNSAFE_componentWillMount(){const{shouldLoadFont:e,fonts:t}=this.props;e&&t&&(this.setState({canRender:!1}),Promise.all(t.map((e=>function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise(((n,o)=>{l(e,n,{timeoutAfter:t.timeoutAfter,onTimeout:o,sampleText:t.sampleText,generic:t.generic})}))}(e,{timeoutAfter:5e3}).catch((e=>{console.warn("Fonts loading check for map style responded slowly or with an error. Fonts in map may not be rendered correctly. This is not necessarily an issue.",e)}))))).then((()=>{this.setState({canRender:!0})}))),this.updatePlugins(this.props),this._isMounted=!0}UNSAFE_componentWillReceiveProps(e){e.mapType===this.props.mapType&&e.actions===this.props.actions||this.updatePlugins(e)}componentWillUnmount(){this._isMounted=!1}render(){if(this.props.map&&this.state.canRender&&this.state.plugins){const{mapOptions:e={}}=this.props.map;return i().createElement(this.state.plugins.Map,De({id:"map"},this.props.options,{projectionDefs:this.props.projectionDefs},this.props.map,{mapOptions:{...this.getConfigMapOptions(),...e},zoomControl:this.props.zoomControl,onResolutionsChange:this.props.onResolutionsChange,errorPanel:Ie}),this.renderLayers(),this.renderSupportTools())}return this.props.loadingError?i().createElement("div",{style:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},className:"mapErrorMessage"},i().createElement(g.Z,{msgId:"map.loadingerror"}),":",this.props.loadingError):i().createElement("div",{style:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},className:"mapLoadingMessage"},this.props.loadingSpinner?i().createElement(u(),{spinnerName:"circle",overrideSpinnerClassName:"spinner"}):null,i().createElement(g.Z,{msgId:this.props.mapLoadingMessage}))}}Pe(ke,"propTypes",{mapType:r().string,map:r().object,layers:r().array,additionalLayers:r().array,zoomControl:r().bool,mapLoadingMessage:r().string,loadingSpinner:r().bool,loadingError:r().string,tools:r().array,fonts:r().array,options:r().object,mapOptions:r().object,projectionDefs:r().array,toolsOptions:r().object,onResolutionsChange:r().func,actions:r().object,features:r().array,securityToken:r().string,shouldLoadFont:r().bool,elevationEnabled:r().bool,isLocalizedLayerStylesEnabled:r().bool,localizedLayerStylesName:r().string,currentLocaleLanguage:r().string,items:r().array,onLoadingMapPlugins:r().func,onMapTypeLoaded:r().func}),Pe(ke,"defaultProps",{mapType:"leaflet",actions:{},zoomControl:!1,mapLoadingMessage:"map.loading",loadingSpinner:!0,tools:["measurement","scalebar","draw","highlight","popup","box"],options:{},mapOptions:{},fonts:["FontAwesome"],toolsOptions:{measurement:{},locate:{},scalebar:{leaflet:{position:"bottomright"}},overview:{overviewOpt:{position:"bottomright",collapsedWidth:25,collapsedHeight:25,zoomLevelOffset:-5,toggleDisplay:!0},layers:[{type:"osm"}]}},securityToken:"",additionalLayers:[],shouldLoadFont:!1,elevationEnabled:!1,onResolutionsChange:()=>{},items:[],onLoadingMapPlugins:()=>{},onMapTypeLoaded:()=>{}});const Re=(0,a.rx)("Map",{component:(0,a.$j)(D,{onResolutionsChange:y.SO,onMapTypeLoaded:y.Mk})((0,Ae.Z)(ke)),reducers:{map:U.Z,layers:G.Z,draw:function(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:z,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case j.hZ:return Z()({},t,{drawStatus:n.status,drawOwner:n.owner,drawMethod:n.method,options:n.options,features:n.features,style:n.style});case j.kD:return Z()({},t,{currentStyle:n.currentStyle});case j.DI:return Z()({},t,{tempFeatures:n.features});case j.IC:return Z()({},t,{tempFeatures:[]});case j.G_:return{...t,snapping:!t.snapping};case j.uB:return{...t,snappingLayer:n.snappingLayer,snappingIsLoading:!1};case j.Rh:return{...t,snappingIsLoading:!t.snappingIsLoading};case j.vU:return{...t,snapConfig:{...{...B,...(null===(e=n.pluginCfg)||void 0===e?void 0:e.snapConfig)||{}},...(null==t?void 0:t.snapConfig)??{},...n.prop&&void 0!==n.value?{[n.prop]:n.value}:{}}};default:return t}},box:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:W,t=arguments.length>1?arguments[1]:void 0;return t.type===V.gd?Z()({},e,{status:t.status}):e},highlight:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:K,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Y.NF:return Z()({},e,{featuresPath:t.featuresPath||"highlight.emptyFeatures"});case Y.F2:return{...e,status:t.status};case Y.fu:return{...e,highlighted:t.features.length,features:t.features,status:t.status||e.status};default:return e}},maptype:X.Z,additionallayers:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case J.jJ:{const n=te()({id:t.id,owner:t.owner,actionType:t.actionType,options:t.options},oe()),o=Q()(e.filter((e=>{let{id:t}=e;return t===n.id})));return o?e.map((e=>e.id===n.id?{...o,...n}:{...e})):[...e,n]}case J.hn:return e.concat(t.layers);case J.oy:{const{options:n,owner:o}=t;return e.map(((e,t)=>e.owner===o?{...e,options:se()(n)&&n[e.id]||ae()(n)&&n[t]||{}}:{...e}))}case J.yg:{const{id:n,owner:o}=t;return o?e.filter((e=>e.owner!==o)):e.filter((e=>e.id!==n))}case J.vD:return t.owner?e.filter((e=>e.owner!==t.owner)):[];default:return e}}},epics:be,containers:{Settings:()=>({tool:i().createElement(q,null),position:2})}})},308602:(e,t,n)=>{"use strict";n.d(t,{lM:()=>c,jP:()=>m,Qp:()=>g,l:()=>h,$N:()=>y});var o=n(227361),r=n.n(o),s=n(513218),i=n.n(s),a=n(612912),l=n(820709),p=n(904160),u=n(399790),d=n(707366);const c=e=>{var t;return!(null==e||null===(t=e.draw)||void 0===t||!t.snappingLayer)&&((0,a.CA)(e,e.draw.snappingLayer)??(0,a.iv)(e,e.draw.snappingLayer))},m=e=>r()(e,"draw.snapping",!1),g=e=>r()(e,"draw.snappingIsLoading",!1),h=e=>r()(e,"draw.snapConfig",!1),y=(0,p.o)(((e,t)=>e===t||i()(e)&&i()(t)&&(null==e?void 0:e.id)===(null==t?void 0:t.id)&&(null==e?void 0:e.title)===(null==t?void 0:t.title)))([a.l2,a.KL,l.Li,c,h,d.Pz],(function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0;const i=null==o?void 0:o.id,a=null==n?void 0:n.id,l=t.filter((e=>((null==r?void 0:r.additionalLayers)??[]).includes(e.id))).map((e=>e.options)),p=l.concat(e),d=a?[{value:a,label:(0,u.in)(n,s),active:a===i}]:[];return d.concat(p.map((e=>{var t;return!(e.id===a||!["wms","wfs","vector"].includes(null==e?void 0:e.type)||"wms"===(null==e?void 0:e.type)&&"wfs"!==(null==e||null===(t=e.search)||void 0===t?void 0:t.type)||"background"===e.group||!e.visibility)&&{value:e.id,label:(0,u.in)(e,s),active:e.id===i}})).filter(Boolean))}))},870820:(e,t,n)=>{"use strict";n.d(t,{JF:()=>p,iL:()=>u,cD:()=>d,jM:()=>c,VH:()=>g,on:()=>h});var o=n(101092),r=n(119008),s=n(521923),i=n(556233),a=n(227361),l=n.n(a);const p=e=>l()(e,"controls.measure.enabled"),u=e=>(0,r.Iz)(e)&&!e.measurement.isDrawing&&(0,o.m6)(e),d=e=>e&&e.measurement&&e.measurement.showAddAsAnnotation,c=e=>e&&e.measurement&&e.measurement.trueBearing&&e.measurement.trueBearing.measureTrueBearing,m=e=>{let t=e.measurement.feature||{};return t.geometry&&(t=(0,s.t8)("geometry.coordinates",(0,i.L0)(t.geometry||{}),t)),t},g=e=>e.measurement&&{...e.measurement,feature:m(e)}||{},h=e=>{var t;return null==e||null===(t=e.measurement)||void 0===t?void 0:t.geomType}},556233:(e,t,n)=>{"use strict";n.d(t,{rp:()=>l,Ov:()=>u,wd:()=>d,L0:()=>c}),n(701469);var o=n(91175),r=n.n(o),s=n(807654),i=n.n(s);function a(e){var t=Math.floor(e),n=60*(e-t),o=Math.floor(n),r=60*(n-o);return t+"° "+o+"' "+Math.floor(r)+"'' "}function l(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,{measureTrueBearing:t=!1,fractionDigits:n=0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o="";if(t){let t="";e>=0&&e<10?t="00":e>10&&e<100&&(t="0"),o=t+(n>0?e.toFixed(n):Math.floor(e))+"°"}else e>=0&&e<90?o="N "+a(e)+"E":e>90&&e<=180?o="S "+a(180-e)+"E":e>180&&e<270?o="S "+a(e-180)+"W":e>=270&&e<=360&&(o="N "+a(360-e)+"W");return o}const p={yd:{ft:3,m:.9144,km:9144e-7,yd:1,mi:.00056818181818,nm:.00049373650107},ft:{ft:1,m:.3048,km:3048e-7,yd:.33333333333334,mi:.0001893932,nm:164579e-9},m:{ft:3.28084,m:1,km:.001,yd:1.0936132983377,mi:621371e-9,nm:.000539956803},km:{ft:3280.84,m:1e3,km:1,yd:1093.6132983377,mi:.62137121212121,nm:.5399568207343395},mi:{ft:5280.000168959982,m:1609.3440514990027,km:1.6093440514990027,yd:1760,mi:1,nm:.8689762697078849},nm:{ft:6076.115679999979,m:1852.0000592639938,km:1.8520000592639938,yd:2025.3718285214,mi:1.150779484848481,nm:1},sqft:{sqft:1,sqm:.09290304,sqkm:9.2903043596611e-8,sqmi:3.587e-8,sqnm:2.7051601137505e-8},sqyd:{sqft:8.9999247491639,sqm:.83612040133779,sqkm:8.3612040133779e-7,sqyd:1,sqmi:3.228278917579e-7,sqnm:2.4346237458194e-7},sqm:{sqft:10.76391,sqm:1,sqkm:1e-6,sqyd:1.196,sqmi:3.8610215854245e-7,sqnm:2.91181e-7},sqkm:{sqft:10763910,sqm:1e6,sqkm:1,sqyd:1196e3,sqmi:.38610215854245,sqnm:.291181},sqmi:{sqft:27878398.920726,sqm:2589988.110336,sqkm:2.589988110336,sqyd:27878398.920726,sqmi:1,sqnm:.75415532795574},sqnm:{sqft:36966388.603652,sqm:3434290.0120544,sqkm:3.4342900120544,sqyd:36966388.603652,sqmi:1.325986786715,sqnm:1}};function u(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"m",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"m";return p[t]&&p[t][n]?e*p[t][n]:e}const d=e=>!i()(parseFloat(e[0]))&&!i()(parseFloat(e[1])),c=function(){let{coordinates:e,type:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e;if("LineString"===t){if(n=e.filter(d),n.length<2)return[]}else if("Polygon"===t){if(n=r()(e).filter(d),n.length<3)return[[]];n=[n.concat([r()(n)])]}return n}},92623:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var o=n(923645),r=n.n(o)()((function(e){return e[1]}));r.push([e.id,".ms2 .mapErrorMessage {\n    font-size: 16px;\n    color: red;\n}\n",""]);const s=r},188455:(e,t,n)=>{var o={"./cesium/plugins/index":[116854,9,8343,1250,6854],"./leaflet/plugins/index":[72183,7,5243,1263,2183],"./openlayers/plugins/index":[532454,9,1001,5604,5986,302,9141,2454,3715,9502]};function r(e){if(!n.o(o,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=o[e],r=t[0];return Promise.all(t.slice(2).map(n.e)).then((()=>n.t(r,16|t[1])))}r.keys=()=>Object.keys(o),r.id=188455,e.exports=r},657606:(e,t,n)=>{var o={"./cesium/index":[134748,8343,1250,9692,8401,8826],"./leaflet/index":[692621,5243,476,3726,5085,4175],"./openlayers/index":[546273,1704,1001,8471,302,6830,2682,9141,7849,8484,3026,3715,3965,6273]};function r(e){if(!n.o(o,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=o[e],r=t[0];return Promise.all(t.slice(1).map(n.e)).then((()=>n(r)))}r.keys=()=>Object.keys(o),r.id=657606,e.exports=r}}]);