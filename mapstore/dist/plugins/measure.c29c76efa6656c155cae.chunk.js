(self.webpackChunkmapstore2=self.webpackChunkmapstore2||[]).push([[7706],{768977:(e,t,a)=>{"use strict";a.d(t,{Z:()=>d});var l=a(45697),n=a.n(l),r=a(124852),o=a.n(r),s=a(630294),m=a(222777);function i(){return i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},i.apply(this,arguments)}function p(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class c extends o().Component{render(){const{cardComponent:e,items:t,colProps:a,onItemClick:l,size:n}=this.props,r=e||m.Z;return o().createElement("div",{className:"msSideGrid"+(this.props.className?" "+this.props.className:"")},o().createElement(s.Row,{className:"items-list"},t.map(((e,t)=>o().createElement(s.Col,i({key:e.id||t},a),o().createElement(r,i({onClick:function(){for(var t=arguments.length,a=new Array(t),n=0;n<t;n++)a[n]=arguments[n];return l(e,...a)},size:n},e)))))))}}p(c,"propTypes",{size:n().string,onItemClick:n().func,colProps:n().object,items:n().array,cardComponent:n().oneOfType([n().string,n().func]),className:n().string}),p(c,"defaultProps",{size:"",onItemClick:()=>{},colProps:{xs:12},className:"",items:[]});const d=c},141832:(e,t,a)=>{"use strict";a.d(t,{Z:()=>d});var l=a(124852),n=a.n(l),r=a(732833),o=a(756435),s=a(867076),m=a(630294),i=a(23888);const p={bottom:{true:"chevron-down",false:"chevron-up"},top:{true:"chevron-up",false:"chevron-down"},right:{true:"chevron-right",false:"chevron-left"},left:{true:"chevron-left",false:"chevron-right"}},c=e=>{let{position:t="right",onClose:a,bsStyle:l="default",title:r="",fullscreen:o=!1,showFullscreen:s=!1,glyph:c="info-sign",additionalRows:d,onFullscreen:u=(()=>{})}=e;const f=a?n().createElement(i.Z,{key:"ms-header-close",className:"square-button ms-close",onClick:a,bsStyle:l},n().createElement(m.Glyphicon,{glyph:"1-close"})):null,g=s?n().createElement(i.Z,{key:"ms-header-glyph",className:"square-button",bsStyle:l,onClick:()=>u(!o)},n().createElement(m.Glyphicon,{glyph:p[t]&&p[t][o]||"resize-full"})):n().createElement("div",{key:"ms-header-glyph",className:"square-button bg-"+l,style:{display:"flex"}},n().createElement(m.Glyphicon,{glyph:c,className:"default"===l?"text-primary":""})),h="left"===t?[f,g]:[g,f];return n().createElement(m.Grid,{fluid:!0,style:{width:"100%"},className:"ms-header ms-"+l},n().createElement(m.Row,null,n().createElement(m.Col,{xs:2},h[0]),n().createElement(m.Col,{xs:8},n().createElement("h4",null,r)),n().createElement(m.Col,{xs:2},h[1])),d)},d=(0,s.withState)("fullscreen","onFullscreen",!1)((e=>{let{fluid:t,className:a="",fullscreen:l=!1,position:s,open:m,size:i=550,style:p={},zIndex:d=1030,onClose:u,bsStyle:f,title:g,showFullscreen:h=!1,glyph:b,header:v,footer:T,children:y,onFullscreen:E=(()=>{}),fixed:w=!1,resizable:C=!1,hideHeader:S}=e;return n().createElement("div",{className:"ms-side-panel "+(w?"":"ms-absolute-dock ")+(C?"":"react-dock-no-resize ")+a},n().createElement(r.default,{fluid:t||l,position:s,dimMode:"none",isVisible:m,size:l?1:i,dockStyle:p,zIndex:d},n().createElement(o.Z,{header:!S&&m&&n().createElement(c,{position:s,onClose:u,bsStyle:f,title:g,fullscreen:l,showFullscreen:h,glyph:b,additionalRows:v,onFullscreen:E}),footer:m&&T},m&&y)))}))},688472:(e,t,a)=>{"use strict";a.d(t,{Z:()=>p});var l=a(124852),n=a.n(l),r=a(867076),o=a(756435),s=a(141832),m=a(283604);const i=(0,r.renameProps)({open:"show"})((e=>{let{children:t,header:a,...l}=e;return n().createElement(m.Z,l,n().createElement(o.Z,{header:n().createElement("div",{className:"ms-header"},a)},t))})),p=(0,r.branch)((e=>{let{dock:t}=e;return!t}),(()=>e=>n().createElement(i,e)))(s.Z)},908316:(e,t,a)=>{"use strict";a.d(t,{Z:()=>c});var l=a(124852),n=a.n(l),r=a(294184),o=a.n(r);const s=e=>{let{id:t,children:a,dockStyle:l,className:r,style:s={}}=e;const m={width:`calc(100% - ${((null==l?void 0:l.right)??0)+((null==l?void 0:l.left)??0)}px)`,transform:`translateX(-${(null==l?void 0:l.right)??0}px)`,pointerEvents:"none"};return n().createElement("div",{id:t,className:o()({...r?{[r]:!0}:{},"dock-container":!0}),style:{...m,...s}},a)};var m=a(496259),i=a(688472);function p(){return p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},p.apply(this,arguments)}const c=e=>{let{children:t,containerClassName:a,containerId:l,containerStyle:r,dock:o=!0,siblings:c,size:d,...u}=e;return n().createElement(s,{dockStyle:r,id:l,className:a},n().createElement(m.Z,null,(e=>{let{width:a}=e;return n().createElement(n().Fragment,null,n().createElement(i.Z,p({dock:o,size:d/a>1?a:d},u),t),c)})))}},51427:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>ye});var l={};a.r(l),a.d(l,{clearMapTemplatesEpic:()=>se,mergeTemplateEpic:()=>pe,openMapTemplatesEpic:()=>de,openMapTemplatesPanelEpic:()=>me,replaceTemplateEpic:()=>ce,setAllowedTemplatesEpic:()=>ie});var n=a(124852),r=a.n(n),o=a(227361),s=a.n(o),m=a(171703),i=a(630294),p=a(22222),c=a(152543),d=a(687753),u=a(27908);const f=e=>e.maptemplates&&e.maptemplates.templates,g=(0,p.P1)((e=>e.maptemplates&&e.maptemplates.allowedTemplates),u.zU,((e,t)=>e&&e.length>0?e:t||[]));var h=a(203842),b=a(804504),v=a(89518),T=a(756435),y=a(768977),E=a(8204),w=a(603754),C=a(16246),S=a(141919),O=a(486234),Z=a(475897);const k=(0,O.Z)("filterPlaceholder")(w.Z),N=(0,S.Z)((e=>{let{items:t=[]}=e;return 0===t.length}),(e=>{let{totalTemplateCount:t}=e;return{glyph:t?"filter":"ban-circle",title:r().createElement(b.Z,{msgId:t?"mapTemplates.emptyTitle":"mapTemplates.noTemplatesTitle"}),description:r().createElement(b.Z,{msgId:t?"mapTemplates.emptyDescription":"mapTemplates.noTemplatesDescription"})}}))((e=>{let{items:t=[],favouriteItems:a=[]}=e;const l=r().createElement("div",{className:"map-templates-favourites"},r().createElement("h4",null,r().createElement(b.Z,{msgId:"mapTemplates.favouritesTitle"})),r().createElement(y.Z,{size:"sm",items:a}),r().createElement("hr",null));return r().createElement(r().Fragment,null,a.length>0?l:null,r().createElement("div",{className:"map-templates-all"},a.length>0?r().createElement("h4",null,r().createElement(b.Z,{msgId:"mapTemplates.allTitle"})):null,r().createElement(y.Z,{items:t})))})),x=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return["name","description"].map((e=>t[e])).map((function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return-1!==t.toLowerCase().indexOf(e.toLowerCase())})).reduce(((e,t)=>e||t),!1)},M=e=>{let{templates:t=[],onMergeTemplate:a=(()=>{}),onReplaceTemplate:l=(()=>{}),onToggleFavourite:o=(()=>{})}=e;const[s,m]=(0,n.useState)(""),[p,c]=(0,n.useState)(),[d,u]=(0,n.useState)(!1),f=(e,t)=>({template:e,title:e.name,description:e.description,loading:e.loading,style:{pointerEvents:"none"},preview:r().createElement("div",{className:"map-templates-preview"},e.thumbnail&&"NODATA"!==e.thumbnail?r().createElement("img",{src:decodeURIComponent(e.thumbnail)}):r().createElement(i.Glyphicon,{glyph:"1-map"})),infoExtra:e.format&&r().createElement("div",{className:"map-templates-formaticon"+(t?" map-templates-favourite":"")},r().createElement(i.Glyphicon,{glyph:Z.Th[e.format]}),r().createElement("span",null,Z.Nk[e.format])),tools:r().createElement(E.Z,{btnDefaultProps:{className:"square-button-md"},buttons:[{glyph:"transfer",bsStyle:"primary",tooltipId:"mapTemplates.transfer",onClick:t=>{t.stopPropagation(),c(e),u(!0)}},{glyph:"plus",bsStyle:"primary",tooltipId:"mapTemplates.merge",onClick:t=>{t.stopPropagation(),a(e.id,e.data)}},{glyph:e.favourite?"star":"star-empty",className:"square-button-md no-border",tooltipId:e.favourite?"mapTemplates.favouriteRemove":"mapTemplates.favouriteAdd",onClick:t=>{t.stopPropagation(),o(e.id)}}]})}),g=t.slice().sort(((e,t)=>e.name>t.name?1:e.name===t.name?0:-1)).filter(x.bind(null,s)),h=g.map((e=>f(e,!1))),v=g.filter((e=>e.favourite)).map((e=>f(e,!0)));return r().createElement(r().Fragment,null,r().createElement(T.Z,{className:"map-templates-panel",header:r().createElement("div",{style:{padding:"8px 15px"}},r().createElement(k,{filterPlaceholder:"mapTemplates.filterPlaceholder",filterText:s,onFilter:m}))},r().createElement(N,{totalTemplateCount:t.length,items:h,favouriteItems:v})),r().createElement(C.Z,{modal:!0,show:d,title:r().createElement(b.Z,{msgId:"mapTemplates.confirmReplaceTitle"}),onClose:()=>{c(),u(!1)},onConfirm:()=>{l(p.id,p.data),c(),u(!1)},confirmButtonBSStyle:"default",confirmButtonContent:r().createElement(b.Z,{msgId:"mapTemplates.confirmReplaceConfirmButton"}),closeText:r().createElement(b.Z,{msgId:"cancel"}),closeGlyph:"1-close"},r().createElement(b.Z,{msgId:"mapTemplates.confirmReplaceMessage"})))};var I=a(521923),z=a(49977),P=a(478718),L=a.n(P),F=a(957557),R=a.n(F),A=a(513218),D=a.n(A),j=a(747037),G=a.n(j),B=a(701469),H=a.n(B),U=a(313311),$=a.n(U),q=a(150361),X=a.n(q),V=a(835516),_=a(288287),J=a(504518),Q=a(510644),K=a(274363),W=a(612912),Y=a(4143),ee=a(57677),te=a(945395),ae=a(926854),le=a(426529),ne=a(501797),re=a(917450);const oe=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{},a="context.errors.template.unknownError";return 403===e.status&&(a="context.errors.template.pleaseLogin",(0,Q.jl)(t())&&(a="context.errors.template.notAccessible")),404===e.status&&(a="context.errors.template.notFound"),a},se=e=>e.ofType(h.Ef).switchMap((()=>z.Observable.of((0,d.Xg)("mapTemplates","enabled",!1,!1)))),me=e=>e.ofType(h.pu).switchMap((()=>z.Observable.of((0,d.Xg)("mapTemplates","enabled",!0,!0)))),ie=(e,t)=>e.ofType(h.b9).switchMap((()=>{const e=t.getState(),a=g(e),l=e=>{const t=s()(e,"Attributes.attribute",{});return(H()(t)?t:[t]).reduce(((e,t)=>({...e,[t.name]:t.value})),{})};return a.length>0?z.Observable.defer((()=>_.Z.searchListByAttributes({OR:{FIELD:a.map((e=>({field:["ID"],operator:["EQUAL_TO"],value:[e.id]})))}},{params:{includeAttributes:!0}},"/resources/search/list"))).switchMap((e=>{const t=s()(e,"ResourceList.Resource",[]),a=(H()(t)?t:[t]).map((e=>({...L()(e,"id","name","description"),...l(e),dataLoaded:!1,loading:!1})));return z.Observable.of((0,h.T3)(a),(0,h.Sy)(!0))})).catch((e=>z.Observable.of((0,h.Sy)(!0,e)))):z.Observable.of((0,h.T3)([]),(0,h.Sy)(!0))})),pe=(e,t)=>e.ofType(h.JV).switchMap((e=>{let{id:a}=e;const l=t.getState(),n=f(l),r=$()(n,(e=>e.id===a));return(r.dataLoaded?z.Observable.of(r.data):z.Observable.defer((()=>_.Z.getData(a)))).switchMap((e=>{if(D()(e)&&void 0!==e.map||G()(e)){const t=(0,K.Od)(l),n=(0,W.l2)(l),o=(0,W.Bt)(l),s=(0,Y.Mz)(l),m=(0,ee.I)(l),i=(0,ee._)(l),p=(0,te.UC)(l),c=V.default.saveMapConfiguration(t,n,o,s,m,i,p);return(G()(e)?z.Observable.defer((()=>(0,ne.H)(e,!1))):z.Observable.of(e)).switchMap((t=>z.Observable.of(...r.dataLoaded?[]:[(0,h.mS)(a,e)],(0,ae.H0)(X()(R()(V.default.mergeMapConfigs(c,V.default.addRootParentGroup(t,r.name)),"widgetsConfig")),null))))}return r.dataLoaded?z.Observable.empty():z.Observable.of((0,h.mS)(a,e))})).let((0,le.hP)((0,h.D$)(a,!0),(0,h.D$)(a,!1),(e=>{const a=oe(e.originalError||e,t.getState);return z.Observable.of((0,J.vU)({title:"context.errors.template.title",message:a,position:"tc",autoDismiss:5}))})))})),ce=(e,t)=>e.ofType(h.ef).switchMap((e=>{let{id:a}=e;const l=t.getState(),n=f(l),r=$()(n,(e=>e.id===a)),{zoom:o,center:s}=(0,K.Od)(l);return(r.dataLoaded?z.Observable.of(r.data):z.Observable.defer((()=>_.Z.getData(a)))).switchMap((e=>(G()(e)?z.Observable.defer((()=>(0,ne.H)(e))):z.Observable.of(D()(e)&&void 0!==e.map?e:null)).switchMap((t=>z.Observable.of(...r.dataLoaded?[]:[(0,h.mS)(a,e)],...t?[(0,ae.H0)(X()({...t,map:{...t.map,zoom:t.map.zoom||o,center:t.map.center||s}}),null,!t.map.zoom&&(t.map.bbox||t.map.maxExtent))]:[]))))).let((0,le.hP)((0,h.D$)(a,!0),(0,h.D$)(a,!1),(e=>{const a=oe(e.originalError||e,t.getState);return z.Observable.of((0,J.vU)({title:"context.errors.template.title",message:a,position:"tc",autoDismiss:5}))})))})),de=(e,t)=>e.ofType(d.At,d.kM).filter((e=>{return"mapTemplates"===e.control&&(a=t.getState(),s()(a,"controls.mapTemplates.enabled"));var a})).switchMap((()=>z.Observable.of((0,re.g)(),(0,re.aN)())));var ue=a(350126),fe=a(45697),ge=a.n(fe),he=a(908316);function be(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class ve extends r().Component{componentDidUpdate(e){const{active:t,allowedTemplates:a,onSetAllowedTemplates:l}=this.props,{active:n}=e;t!==n&&t&&l(a)}render(){const{active:e,templates:t,templatesLoaded:a,onToggleControl:l,onMergeTemplate:n,onReplaceTemplate:o,onToggleFavourite:s,dockStyle:m,size:i}=this.props;return r().createElement(he.Z,{containerStyle:m,containerId:"map-templates-container",containerClassName:"dock-container",className:"map-templates-dock-panel",open:e,position:"right",size:i,bsStyle:"primary",title:r().createElement(b.Z,{msgId:"mapTemplates.title"}),style:m,onClose:l},!a&&r().createElement("div",{className:"map-templates-loader"},r().createElement(v.Z,{size:352})),a&&r().createElement(M,{templates:t,onMergeTemplate:n,onReplaceTemplate:o,onToggleFavourite:s}))}}be(ve,"propTypes",{active:ge().bool,templatesLoaded:ge().bool,templates:ge().array,allowedTemplates:ge().array,dockStyle:ge().object,onToggleControl:ge().func,onMergeTemplate:ge().func,onReplaceTemplate:ge().func,onToggleFavourite:ge().func,onSetAllowedTemplates:ge().func,size:ge().number}),be(ve,"defaultProps",{active:!1,templatesLoaded:!1,templates:[],allowedTemplates:[],dockStyle:{},onToggleControl:()=>{},onMergeTemplate:()=>{},onReplaceTemplate:()=>{},onToggleFavourite:()=>{},onSetAllowedTemplates:()=>{},size:550});const Te=(0,m.connect)((0,p.P1)((e=>(0,ue.ic)(e,{height:!0,right:!0},!0)),(e=>s()(e,"controls.mapTemplates.enabled")),f,(e=>e.maptemplates&&e.maptemplates.mapTemplatesLoaded),((e,t,a,l)=>({active:t,templates:a,templatesLoaded:l,dockStyle:e}))),{onToggleControl:d.Xi.bind(null,"mapTemplates","enabled"),onMergeTemplate:h.jl,onReplaceTemplate:h.xt,onToggleFavourite:h.pL,onSetAllowedTemplates:h.B7})(ve),ye=(0,c.rx)("MapTemplates",{component:Te,containers:{BurgerMenu:{name:"MapTemplates",position:998,text:r().createElement(b.Z,{msgId:"mapTemplates.title"}),icon:r().createElement(i.Glyphicon,{glyph:"1-map"}),action:h.nF,priority:2,doNotHide:!0,tooltip:r().createElement(b.Z,{msgId:"mapTemplates.tooltip"})},SidebarMenu:{name:"mapTemplates",position:998,text:r().createElement(b.Z,{msgId:"mapTemplates.title"}),icon:r().createElement(i.Glyphicon,{glyph:"1-map"}),action:d.Xg.bind(null,"mapTemplates","enabled",!0,!0),toggle:!0,priority:1,doNotHide:!0,tooltip:"mapTemplates.tooltip"}},reducers:{maptemplates:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case h.Ef:return{};case h.N_:return(0,I.t8)("templates",t.templates,e);case h.b9:return(0,I.t8)("allowedTemplates",t.templates,e);case h.ip:{const a=s()(e,"templates",[]).map((e=>e.id===t.id?{...e,favourite:!e.favourite}:e));return(0,I.t8)("templates",a,e)}case h.kP:{const a=s()(e,"templates",[]).map((e=>e.id===t.id?{...e,data:t.data,dataLoaded:!0}:e));return(0,I.t8)("templates",a,e)}case h.iF:{const a=s()(e,"templates",[]).map((e=>e.id===t.id?{...e,loading:t.loadingValue}:e));return(0,I.t8)("templates",a,e)}case h.cH:return(0,I.t8)("mapTeplatesLoadError",t.error,(0,I.t8)("mapTemplatesLoaded",t.loaded,e));default:return e}}},epics:l})}}]);