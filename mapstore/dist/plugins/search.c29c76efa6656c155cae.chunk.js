(self.webpackChunkmapstore2=self.webpackChunkmapstore2||[]).push([[8166],{403410:(e,t,r)=>{"use strict";r.d(t,{hn:()=>o,yg:()=>s,vD:()=>a,jJ:()=>n,oy:()=>l,W:()=>i,B1:()=>c,fU:()=>u,cY:()=>d});const o="ADDITIONALLAYER:ADD_ADDITIONAL_LAYERS",s="ADDITIONALLAYER:REMOVE_ADDITIONAL_LAYER",a="ADDITIONALLAYER:REMOVE_ALL_ADDITIONAL_LAYERS",n="ADDITIONALLAYER:UPDATE_ADDITIONAL_LAYER",l="ADDITIONALLAYER:UPDATE_OPTIONS_BY_OWNER",i=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"override",o=arguments.length>3?arguments[3]:void 0;return{type:n,id:e,owner:t,actionType:r,options:o}},c=(e,t)=>({type:l,owner:e,options:t}),u=function(){let{id:e,owner:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:s,id:e,owner:t}},d=e=>({type:a,owner:e})},420544:(e,t,r)=>{"use strict";r.d(t,{Cv:()=>o,RD:()=>s,NR:()=>a,mV:()=>n,N3:()=>l,dR:()=>i,sS:()=>c,sm:()=>u});const o="SET_SEARCH_BOOKMARK_CONFIG",s="RESET_BOOKMARK_CONFIG",a="UPDATE_BOOKMARK",n="FILTER_BOOKMARKS";function l(e,t){return{type:o,property:e,value:t}}function i(){return{type:s}}function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return{type:a,bookmark:e,idx:t}}function u(e){return{type:n,filter:e}}},940711:(e,t,r)=>{"use strict";r.d(t,{b:()=>d});var o=r(727418),s=r.n(o);const a=e=>null===e?[]:e.map((e=>({properties:{...e},id:e.osm_id,type:"Feature",bbox:e.boundingbox.map((e=>parseFloat(e))).reduce(((e,t,r)=>(e[(e=>{switch(e){case 0:return 1;case 1:return 3;case 2:return 0;case 3:return 2;default:return-1}})(r)]=t,e)),[]),geometry:e.geojson||{type:"Point",coordinates:[parseFloat(e.lon),parseFloat(e.lat)]}})));var n=r(348660),l=r(487758);const i=e=>{let{searchText:t,staticFilter:r,blacklist:o,item:s,queriableAttributes:a,predicate:l}=e;const i=(0,n.generateTemplateString)(r||"")(s);let c,u=t.split(" ").filter((e=>e)).filter((e=>o.indexOf(e.toLowerCase())<0));return 0===u.length&&(u=t?[t]:[]),u.length>0&&(c="(".concat(u.map((e=>a.map((t=>`${t} ${l} '%${e.replace("'","''")}%'`)).join(" OR "))).join(") AND (")).concat(")")),c=c?c.concat(i):i||null,c};let c={nominatim:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{returnFullData:!1};return r(61427).Z.geocode(e,t).then((e=>t.returnFullData?e:a(e.data)))},wfs:(e,t)=>{let{url:r,typeName:o,queriableAttributes:a=[],outputFormat:n="application/json",predicate:c="ILIKE",staticFilter:u="",blacklist:d=[],item:p,fromTextToFilter:m=i,returnFullData:h=!1,...g}=t;const f=m({searchText:e,staticFilter:u,blacklist:d,item:p,queriableAttributes:a,predicate:c});return l.DH(r,s()({maxFeatures:10,typeName:o,outputFormat:n,cql_filter:f},g)).then((e=>h?e:e.features))}};const u={setService:(e,t)=>{c[e]=t},getService:e=>c[e]?c[e]:null},d={Services:c,Utils:u}},802728:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var o=r(124852),s=r.n(o);const a=e=>{let{className:t,style:r,children:o}=e;return s().createElement("div",{id:"map-search-bar",style:r,className:"MapSearchBar"+(t?" "+t:"")},o)}},270250:(e,t,r)=>{"use strict";r.d(t,{Z:()=>u});var o=r(124852),s=r.n(o),a=r(45697),n=r.n(a),l=r(630294),i=r(719648);const c=(e,t)=>{let{show:r,autoFocusOnSelect:o=!0,selectedItems:a=[],className:n,style:c={textOverflow:"ellipsis"},placeholder:u,placeholderMsgId:d,hideOnBlur:p=!0,searchText:m="",typeAhead:h=!0,delay:g=1e3,blurResetDelay:f=300,onSearch:b=(()=>{}),onSearchTextChange:y=(()=>{}),onCancelSelectedItem:v=(()=>{}),onPurgeResults:S=(()=>{})}=e;const _=s().useRef(),E=s().useRef(),[I,C]=s().useState(),[k,T]=s().useState(),[R,O]=s().useState(!1);s().useEffect((()=>{const e=E.current;if(o&&a&&(e<a.length||!e&&1===a.length)){const e=_.current;e&&e.focus instanceof Function&&setTimeout((()=>e.focus()),200)}E.current=a&&a.length})),s().useEffect((()=>{R&&(b(),O(!1))}),[R,b]);let x="search.addressSearch";if(!u&&t.messages){const e=(0,i.S$)(t.messages,d||x);e&&(x=e)}else x=u;return r&&s().createElement(l.FormControl,{className:"searchInput"+(n?` ${n}`:""),key:"search-input",placeholder:x,type:"text",inputRef:e=>{_.current=e},style:c,value:m,onKeyDown:e=>{switch(e.keyCode){case 13:b();break;case 8:!m&&a&&a.length>0&&v(a[a.length-1])}},onBlur:()=>{p&&(I&&clearTimeout(I),C(setTimeout((()=>{S()}),f)))},onFocus:()=>{h&&m&&b()},onChange:e=>{let t=e.target.value;y(t),h&&(k&&clearTimeout(k),T(setTimeout((()=>{O(!0)}),g)))}})};c.contextTypes={messages:n().object};const u=c},859653:(e,t,r)=>{"use strict";r.d(t,{Z:()=>d});var o=r(124852),s=r.n(o),a=r(727418),n=r.n(a),l=r(472986),i=r.n(l),c=r(8204);function u(){return u=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},u.apply(this,arguments)}const d=e=>{let{loading:t,splitTools:r,toolbarProps:o={},toolbarButtons:a=[],children:l}=e;return s().createElement("span",{className:"search-toolbar-options"},t&&s().createElement(i(),{style:n()({},{position:"absolute"},{right:"69px",zIndex:1,top:"13px"}),spinnerName:"pulse",noFadeIn:!0}),s().createElement(c.Z,u({btnGroupProps:{className:"btn-group-menu-options"},transitionProps:null,btnDefaultProps:{className:"square-button-md",bsStyle:"primary"}},o,{buttons:a})),l)}},312471:(e,t,r)=>{"use strict";r.d(t,{f:()=>o});const o=e=>{let{searchText:t,selectedItems:r,searchOptions:o,maxResults:s,onSearch:a=(()=>{}),onSearchReset:n=(()=>{})}=e;return()=>{const e=t,l=function(){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15;return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).reduce((function(t,r){var o;return t+((null==r||null===(o=r.options)||void 0===o?void 0:o.maxFeatures)||e)}),0)||e}(null==o?void 0:o.services,s);void 0!==e&&""!==e||r&&0!==r.length?void 0!==e&&""!==e&&a(e,o,l):n()}}},177180:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>ze});var o=r(227361),s=r.n(o),a=r(727418),n=r.n(a),l=r(45697),i=r.n(l),c=r(124852),u=r.n(c),d=r(171703),p=r(22222),m=r(403410),h=r(926854),g=r(687753),f=r(859518),b=r(596974),y=r(420544),v=r(630294),S=r(441609),_=r.n(S),E=r(352353),I=r.n(E),C=r(804504),k=r(36549),T=r(423570),R=r.n(T);function O(){return O=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},O.apply(this,arguments)}const x=(0,k.Z)(v.DropdownButton),P={disabled:!1,className:"square-button-md",noCaret:!0,idDropDown:R()()},w={title:u().createElement(v.Glyphicon,{glyph:"menu-hamburger"}),tooltipId:"search.changeSearchInputField",tooltipPosition:"bottom",className:"square-button-md no-border",pullRight:!0},N=function(){let{menuItems:e=[],disabled:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return u().createElement(x,O({disabled:t},P,w),e.length?e.map((e=>e)):null)};var F=r(802728),A=r(270250),M=r(859653),V=r(312471),q=r(743129);function L(){return L=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},L.apply(this,arguments)}const D=(0,r(486234).Z)(["placeholder","clearValueText","noResultsText"])(q.ZP),Z={searchByBookmark:(e,t,r,o,s)=>{const{options:a={},layerVisibilityReload:n=!1}=e;var l,i;n?t({...r,map:{...r.map,bookmark_search_config:o}},null,{bounds:[a.west,a.south,a.east,a.north],crs:(null==r||null===(l=r.map)||void 0===l||null===(i=l.center)||void 0===i?void 0:i.crs)||"EPSG:4326"}):a&&!_()(a)&&s([a.west,a.south,a.east,a.north],"EPSG:4326")},searchIcon:(e,t)=>{let{onLayerVisibilityLoad:r,mapInitial:o,bookmarkConfig:s,onZoomToExtent:a}=t;return{tooltipId:"bookmarkSearch"===e?"search.zoomToBookmark":"",tooltipPosition:"bottom",visible:"bookmarkSearch"===e&&!(null!=s&&s.zoomOnSelect),disabled:"bookmarkSearch"===e&&!s.selected,onClick:()=>{"bookmarkSearch"===e&&Z.searchByBookmark(s.selected,r,o,s.bookmarkSearchConfig||{},a)}}}},G=e=>{let{bookmarkConfig:t,onPropertyChange:r,onLayerVisibilityLoad:o,mapInitial:s,onZoomToExtent:a}=e;const[n,l]=(0,c.useState)([]),{selected:i={},bookmarkSearchConfig:d={},zoomOnSelect:p=!0}=t||{},{bookmarks:m=[]}=d,{searchByBookmark:h}=Z;return(0,c.useEffect)((()=>{_()(m)||l(m.map((e=>e.title)))}),[m]),u().createElement("div",{className:"search-select"},u().createElement("div",{style:{flex:"1 1 0%",padding:"0px 4px"}},u().createElement(D,L({},{clearable:!0,isSearchable:!0,isClearable:!0},{onChange:e=>{const t=e&&e.value||"",[n]=m.filter(((r,o)=>r.title===t&&o===e.idx));r("selected",n),p&&h(n,o,s,d,a)},value:(null==i?void 0:i.title)||"",options:n.map(((e,t)=>({label:e,value:e,idx:t}))),placeholder:"search.b_placeholder",clearValueText:"search.b_clearvalue",noResultsText:"search.b_noresult"}))))};G.propTypes={bookmarkConfig:i().object.isRequired,onPropertyChange:i().func.isRequired};const j=(0,d.connect)((e=>({bookmarkConfig:e.searchbookmarkconfig||{}})),{onPropertyChange:y.N3,onZoomToExtent:f.Px,onLayerVisibilityLoad:h.H0})(G);var B=r(281763),z=r.n(B),K=r(700802),U=r(766586);const Y={clearCoordinates:(e,t)=>{e({owner:"search"}),t("lat",""),t("lon","")},areValidCoordinates:e=>z()(null==e?void 0:e.lon)&&z()(null==e?void 0:e.lat),zoomToPoint:function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:12;e({x:parseFloat(t.lon),y:parseFloat(t.lat)},r,"EPSG:4326")},coordinateFormatChange:(e,t,r,o)=>({buttonConfig:{title:u().createElement(v.Glyphicon,{glyph:"cog"}),tooltipId:"search.changeSearchInputField",tooltipPosition:"bottom",className:"square-button-md no-border",pullRight:!0},menuOptions:[{active:"decimal"===e,onClick:()=>t("decimal"),text:u().createElement(C.Z,{msgId:"search.decimal"})},{active:"aeronautical"===e,onClick:()=>t("aeronautical"),text:u().createElement(C.Z,{msgId:"search.aeronautical"})}],visible:r&&"coordinatesSearch"===o,Element:U.Z}),removeIcon:(e,t,r,o)=>({visible:"coordinatesSearch"===e&&(z()(t.lon)||z()(t.lat)),onClick:()=>Y.clearCoordinates(r,o)}),searchIcon:(e,t,r,o)=>({visible:"coordinatesSearch"===e,onClick:()=>{"coordinatesSearch"===e&&Y.areValidCoordinates(t)&&Y.zoomToPoint(r,t,o)}}),coordinatesMenuItem:e=>{let{activeTool:t,searchText:r,clearSearch:o,onChangeActiveSearchTool:s,onClearBookmarkSearch:a}=e;return u().createElement(v.MenuItem,{active:"coordinatesSearch"===t,onClick:()=>{void 0!==r&&""!==r&&o(),a("selected"),s("coordinatesSearch"),document.dispatchEvent(new MouseEvent("click"))}},u().createElement(v.Glyphicon,{glyph:"search-coords"})," ",u().createElement(C.Z,{msgId:"search.coordinatesSearch"}))}},W=e=>{let{coordinate:t={},format:r,onClearCoordinatesSearch:o,onZoomToPoint:s,onChangeCoord:a,defaultZoomLevel:n,aeronauticalOptions:l={seconds:{decimals:4,step:1e-4}},constraintsCoordEditor:i={decimal:{lat:{min:-90,max:90},lon:{min:-180,max:180}}}}=e;const{zoomToPoint:c,areValidCoordinates:d}=Y,p=(e,t)=>{a(e,parseFloat(t)),d()||o({owner:"search"})},m=()=>{c(s,t,n)};return u().createElement("div",{className:"coordinateEditor",style:{flexWrap:"decimal"===r?"nowrap":"wrap"}},u().createElement(v.Row,{className:`entryRow ${r}`},u().createElement(v.FormGroup,null,u().createElement(v.InputGroup,null,u().createElement(v.InputGroup.Addon,{style:{minWidth:45}},u().createElement(C.Z,{msgId:"search.latitude"})),u().createElement(K.Z,{format:r,aeronauticalOptions:l,coordinate:"lat",idx:1,value:t.lat,constraints:i,onChange:e=>p("lat",e),onKeyDown:()=>{d(t)&&m()}})))),u().createElement(v.Row,{className:`entryRow ${r}`},u().createElement(v.FormGroup,null,u().createElement(v.InputGroup,null,u().createElement(v.InputGroup.Addon,{style:{minWidth:45}},u().createElement(C.Z,{msgId:"search.longitude"})),u().createElement(K.Z,{format:r,aeronauticalOptions:l,coordinate:"lon",idx:2,value:t.lon,constraints:i,onChange:e=>p("lon",e),onKeyDown:()=>{d(t)&&m()}})))))};W.propTypes={coordinate:i().object,format:i().string,onClearCoordinatesSearch:i().func,onZoomToPoint:i().func,onChangeCoord:i().func,defaultZoomLevel:i().number};const H=(0,d.connect)((e=>({coordinate:e.search.coordinate||{}})),{onZoomToPoint:b.Z,onChangeCoord:b.TS})(W);var X=r(313311),$=r.n(X),Q=r(8204),J=r(348660);function ee(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class te extends u().Component{constructor(){super(...arguments),ee(this,"onClick",(()=>{let e=this.props.item;this.props.onItemClick(e)}))}render(){if(void 0===this.props.item)return null;let e=this.props.item;return u().createElement("div",{key:e.osm_id,className:"search-result",style:e.resultCssStyle,onClick:this.onClick},u().createElement("div",{className:"search-result-left-container"},u().createElement("div",{className:"icon"}," ",u().createElement("img",{src:e.icon})),u().createElement("div",{className:"text-result-title"},s()(e,this.props.displayName)||(0,J.generateTemplateString)(this.props.displayName||"")(e)),u().createElement("small",{className:"text-info"},this.props.subTitle&&s()(e,this.props.subTitle)||(0,J.generateTemplateString)(this.props.subTitle||"")(e))),u().createElement("div",{className:"search-result-right-container"},u().createElement("div",{className:"search-result-tools"},u().createElement(Q.Z,{btnDefaultProps:{className:"square-button-md",bsStyle:"primary"},buttons:this.props.tools}))))}}ee(te,"propTypes",{subTitle:i().string,item:i().object,displayName:i().string,idField:i().string,icon:i().string,onItemClick:i().func,tools:i().array}),ee(te,"defaultProps",{displayName:"properties.display_name",idField:"id",icon:"properties.icon",tools:[]});const re=te;var oe=r(131400),se=r(182148);function ae(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class ne extends u().Component{constructor(){super(...arguments),ae(this,"onItemClick",(e=>{this.props.onItemClick(e,this.props.mapConfig)})),ae(this,"renderResults",(()=>this.props.results.map(((e,t)=>{var r;const o=this.findService(e)||{},s=$()(this.props.layers,{name:null===(r=o.options)||void 0===r?void 0:r.typeName}),a=(0,se.zA)(o),n=!(0,se.Tv)(s,o);return u().createElement(re,{subTitle:o.subTitle,idField:o.idField,displayName:o.displayName,key:e.osm_id||e.id||"res_"+t,item:e,onItemClick:this.onItemClick,tools:[{id:"open-gfi",keyProp:"open-gfi",visible:a,disabled:n,glyph:"info-sign",tooltipId:a&&n?"search.layerMustBeVisible":"search.showGFI",onClick:t=>{t.stopPropagation(),this.props.showGFI(e)}}]})})))),ae(this,"findService",(e=>{const t=this.props.searchOptions&&this.props.searchOptions.services;if(null!==e.__SERVICE__)if(t&&"string"==typeof e.__SERVICE__){for(let r=0;r<t.length;r++)if(t[r]&&t[r].id===e.__SERVICE__)return t[r];for(let r=0;r<t.length;r++)if(t[r]&&t[r].type===e.__SERVICE__)return t[r]}else if("object"==typeof e.__SERVICE__)return e.__SERVICE__;return null}))}render(){var e=this.props.notFoundMessage;e||(e=u().createElement(oe.ZP.Message,{msgId:"noresultfound"}));let t=this.props.containerStyle,r=this.props.mapConfig&&this.props.mapConfig.size;if(this.props.fitToMapSize&&r){let e=r.width-this.props.sizeAdjustment.width,o=r.height-this.props.sizeAdjustment.height;t=n()({},this.props.containerStyle,{maxWidth:e,maxHeight:o})}return this.props.results?0===this.props.results.length?u().createElement("div",{className:"search-result-list",style:n()({padding:"10px",textAlign:"center"},t)},e):u().createElement("div",{className:"search-result-list",style:t},this.renderResults()):null}}ae(ne,"propTypes",{results:i().array,layers:i().array,searchOptions:i().object,mapConfig:i().object,fitToMapSize:i().bool,containerStyle:i().object,sizeAdjustment:i().object,onItemClick:i().func,addMarker:i().func,afterItemClick:i().func,showGFI:i().func,notFoundMessage:i().oneOfType([i().object,i().string])}),ae(ne,"defaultProps",{layers:[],sizeAdjustment:{width:0,height:110},containerStyle:{zIndex:1e3},onItemClick:()=>{},addMarker:()=>{},afterItemClick:()=>{},showGFI:()=>{}});var le=r(49977),ie=r(294707),ce=r.n(ie),ue=r(235385),de=r.n(ue),pe=r(189734),me=r.n(pe),he=r(414293),ge=r.n(he),fe=r(612912),be=r(917450),ye=r(333101),ve=r(351546),Se=r(940711),_e=r(487758),Ee=r(726598),Ie=r(975872);const Ce=(e,t)=>(0,Ee.mx)(e,{...(0,Ie.oq)(t)});var ke=r(988737);var Te=r(274363),Re=r(234228),Oe=r(23888);function xe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Pe extends u().Component{render(){return u().createElement(Oe.Z,{onClick:()=>this.props.onToggle(this.props.pressed),bsStyle:this.props.pressed?"default":"primary",className:"square-button"},u().createElement(v.Glyphicon,{glyph:"search"}))}}xe(Pe,"propTypes",{pressed:i().bool,onToggle:i().func}),xe(Pe,"defaultProps",{pressed:!1,onToggle:()=>{}});const we=(0,d.connect)((e=>({pressed:e.controls&&e.controls.search&&e.controls.search.enabled||!1})),{onToggle:g.Xi.bind(null,"search",null)})(Pe);var Ne,Fe=r(350126),Ae=r(652700),Me=r(294184),Ve=r.n(Me);function qe(){return qe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},qe.apply(this,arguments)}function Le(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const De=(0,p.P1)([e=>e.search||null,e=>e.controls&&e.controls.searchBookmarkConfig||null,e=>e.mapConfigRawData||{},e=>(null==e?void 0:e.searchbookmarkconfig)||""],((e,t,r,o)=>({enabledSearchBookmarkConfig:t&&t.enabled||!1,error:e&&e.error,coordinate:e&&e.coordinate||{},loading:e&&e.loading,searchText:e?e.searchText:"",activeSearchTool:s()(e,"activeSearchTool","addressSearch"),format:s()(e,"format")||Re.ZP.getConfigProp("defaultCoordinateFormat"),selectedItems:e&&e.selectedItems,mapInitial:r,bookmarkConfig:o||{}}))),Ze=(0,d.connect)(De,{onSearch:b.tt,onChangeCoord:b.TS,onChangeActiveSearchTool:b.a,onClearCoordinatesSearch:m.fU,onClearBookmarkSearch:y.N3,onChangeFormat:b.Zw,onToggleControl:g.Xi,onZoomToPoint:b.Z,onPurgeResults:b.kV,onSearchReset:b.v2,onSearchTextChange:b.k9,onCancelSelectedItem:b.KG,onZoomToExtent:f.Px,onLayerVisibilityLoad:h.H0})((e=>{let{activeSearchTool:t="addressSearch",removeIcon:r="1-close",searchIcon:o="search",isSearchClickable:s=!0,splitTools:a,searchText:n="",maxResults:l=15,searchOptions:i,loading:c,delay:d,blurResetDelay:p,typeAhead:m,coordinate:h={},selectedItems:g=[],defaultZoomLevel:f=12,enabledSearchBookmarkConfig:b=!1,error:y,format:S="decimal",placeholder:E,placeholderMsgId:k="search.addressSearch",showOptions:T=!0,showAddressSearchOption:R=!0,showCoordinatesSearchOption:O=!0,showBookMarkSearchOption:x=!0,onSearch:P,onSearchReset:w,onSearchTextChange:q,onCancelSelectedItem:L,onChangeCoord:D=(()=>{}),onChangeActiveSearchTool:G=(()=>{}),onClearCoordinatesSearch:B=(()=>{}),onChangeFormat:z=(()=>{}),onToggleControl:K=(()=>{}),onZoomToPoint:U=(()=>{}),onClearBookmarkSearch:W=(()=>{}),onPurgeResults:X,items:$=[],...Q}=e;const J=(0,V.f)({searchText:n,selectedItems:g,searchOptions:i,maxResults:l,onSearch:P,onSearchReset:w}),ee=()=>{w()};let te,re=[];if(R&&re.push(u().createElement(v.MenuItem,{active:"addressSearch"===t,onClick:()=>{B({owner:"search"}),W("selected"),G("addressSearch")}},u().createElement(v.Glyphicon,{glyph:o})," ",u().createElement(C.Z,{msgId:"search.addressSearch"}))),O&&re.push(u().createElement(Y.coordinatesMenuItem,{activeTool:t,searchText:n,clearSearch:ee,onChangeActiveSearchTool:G,onClearBookmarkSearch:W})),x&&!_()($)){var oe;const{allowUser:e,bookmarkSearchConfig:r}=Q.bookmarkConfig||{},o=$.find((e=>{let{name:t}=e;return"SearchByBookmark"===t}))||{};if(o.menuItem){const e=o.menuItem;re.push(u().createElement(e,null))}o.bookmarkConfig&&(te={...o.bookmarkConfig(K,b,t),...!e&&{visible:!1}}),e||0!==(null==r||null===(oe=r.bookmarks)||void 0===oe?void 0:oe.length)||"bookmarkSearch"!==t||G("addressSearch")}const se=()=>{if(T){if("coordinatesSearch"===t)return Y.coordinateFormatChange(S,z,T,t);if("bookmarkSearch"===t)return te}return null};return u().createElement(F.Z,null,u().createElement(v.FormGroup,null,u().createElement("div",{className:"input-group",style:{display:"flex"}},g&&g.map(((e,t)=>u().createElement("span",{key:"selected-item"+t,className:"input-group-addon"},u().createElement("div",{className:"selectedItem-text"},e.text)))),u().createElement(A.Z,{show:"addressSearch"===t,delay:d,typeAhead:m,blurResetDelay:p,placeholder:E,placeholderMsgId:k,searchText:n,selectedItems:g,onSearch:J,onSearchTextChange:q,onCancelSelectedItem:L,onPurgeResults:X}),"coordinatesSearch"===t&&O&&u().createElement(H,{format:S,defaultZoomLevel:f,onClearCoordinatesSearch:B}),"bookmarkSearch"===t&&x&&u().createElement(j,{mapInitial:Q.mapInitial}),u().createElement(M.Z,{splitTools:!1,toolbarButtons:[...se()?[{...se()}]:[],...$.filter((e=>{let{target:t}=e;return"button"===t})).map((e=>{let{component:t}=e;return{visible:!!T,Element:t}})),{glyph:r,className:"square-button-md no-border",bsStyle:"default",pullRight:!0,loading:!I()(c)&&c,visible:"addressSearch"===t&&(""!==n||g&&g.length>0),onClick:()=>{"addressSearch"===t&&ee()},..."coordinatesSearch"===t&&Y.removeIcon(t,h,B,D)},{glyph:o,className:"square-button-md no-border "+(s||"addressSearch"!==t?"magnifying-glass clickable":"magnifying-glass"),bsStyle:"default",pullRight:!0,tooltipPosition:"bottom",visible:!("addressSearch"!==t||(""!==n||g&&g.length>0)&&a),onClick:()=>s&&J(),..."coordinatesSearch"===t&&Y.searchIcon(t,h,U,f),..."bookmarkSearch"===t&&Z.searchIcon(t,Q)},{tooltip:(ae=y,ae?u().createElement(C.Z,{msgId:ae.msgId||"search.generic_error",msgParams:{message:ae.message,serviceType:ae.serviceType}}):null),tooltipPosition:"bottom",className:"square-button-md no-border",glyph:"warning-sign",bsStyle:"danger",glyphClassName:"searcherror",visible:!!y,onClick:ee},{visible:T,renderButton:u().createElement(N,{disabled:T,menuItems:re})}]}))));var ae})),Ge=(0,p.P1)([Te.Od,fe.l2,e=>e.search||null],((e,t,r)=>({mapConfig:e,layers:t,results:r?r.results:null}))),je=(0,d.connect)(Ge,{onItemClick:b.Jc,addMarker:b._q,showGFI:b.w4})(ne),Be=(0,d.connect)((e=>({enabled:e.controls&&e.controls.search&&e.controls.search.enabled||!1,selectedServices:e&&e.search&&e.search.selectedServices,selectedItems:e&&e.search&&e.search.selectedItems,textSearchConfig:e&&e.searchconfig&&e.searchconfig.textSearchConfig})),{onUpdateResultsStyle:b.o$})((Ne=class extends u().Component{constructor(){super(...arguments),Le(this,"getServiceOverrides",(e=>this.props.selectedItems&&this.props.selectedItems[this.props.selectedItems.length-1]&&s()(this.props.selectedItems[this.props.selectedItems.length-1],e))),Le(this,"getSearchOptions",(()=>{const{searchOptions:e,textSearchConfig:t}=this.props;return t&&t.services&&t.services.length>0?t.override?n()({},e,{services:t.services}):n()({},e,{services:e.services.concat(t.services)}):e})),Le(this,"getCurrentServices",(()=>{const{selectedServices:e}=this.props,t=this.getSearchOptions();return e&&e.length>0?n()({},t,{services:e}):t})),Le(this,"searchFitToTheScreen",(()=>{const{offsets:{right:e,left:t},mapSize:{width:r=window.innerWidth}}=this.props;return r-e-t-60>=500})),Le(this,"getSearchAndToggleButton",(()=>{const e=u().createElement(Ze,qe({key:"searchBar"},this.props,{searchOptions:this.getCurrentServices(),placeholder:this.getServiceOverrides("placeholder"),placeholderMsgId:this.getServiceOverrides("placeholderMsgId")}));return this.searchFitToTheScreen()?e:u().createElement(u().Fragment,null,u().createElement(we,null),this.props.enabled?e:null)}))}componentDidMount(){this.props.onUpdateResultsStyle({...se.be,...this.props.resultsStyle})}render(){return u().createElement("span",{id:"search-bar-container",className:Ve()({toggled:!this.searchFitToTheScreen(),"no-sidebar":!this.props.sidebarIsActive}),style:this.props.sidebarIsActive?this.props.style:null},this.getSearchAndToggleButton(),u().createElement(je,{fitToMapSize:this.props.fitResultsToMapSize,searchOptions:this.props.searchOptions,onUpdateResultsStyle:this.props.onUpdateResultsStyle,key:"nominatimresults"}))}},Le(Ne,"propTypes",{splitTools:i().bool,showOptions:i().bool,isSearchClickable:i().bool,fitResultsToMapSize:i().bool,searchOptions:i().object,resultsStyle:i().object,selectedItems:i().array,selectedServices:i().array,userServices:i().array,withToggle:i().oneOfType([i().bool,i().array]),enabled:i().bool,textSearchConfig:i().object,style:i().object,sidebarIsActive:i().bool}),Le(Ne,"defaultProps",{searchOptions:{services:[{type:"nominatim",priority:5}]},isSearchClickable:!1,splitTools:!0,resultsStyle:{color:"#3388ff",weight:4,dashArray:"",fillColor:"#3388ff",fillOpacity:.2},fitResultsToMapSize:!0,withToggle:!1,enabled:!0,style:{},sidebarIsActive:!1}),Ne)),ze={SearchPlugin:n()((0,d.connect)((0,p.zB)({style:e=>(0,Fe.ic)(e,{right:!0}),offsets:e=>(0,Fe.ic)(e,{right:!0,left:!0}),mapSize:e=>(0,Te.GV)({width:!0})(e),sidebarIsActive:e=>(0,Ae.z)(e)}),{})(Be),{OmniBar:{name:"search",position:1,tool:!0,priority:1}}),epics:{searchEpic:e=>e.ofType(b.bj).debounceTime(250).switchMap((t=>le.Observable.from((t.services||[{type:"nominatim",priority:5}]).map((e=>{const r=Se.b.Utils.getService(e.type);if(!r){const t=new Error("Service Missing");return t.msgId="search.service_missing",t.serviceType=e.type,le.Observable.of(t).do((e=>{throw e}))}return le.Observable.defer((()=>r(t.searchText,e.options).then((function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.map((t=>({...t,__SERVICE__:e,__PRIORITY__:e.priority||0})))})))).retryWhen((e=>e.delay(200).scan(((e,t)=>{if(e>=2)throw t;return e+1}),0)))}))).mergeAll().scan(((e,t)=>me()([...e,...t],["__PRIORITY__"]))).map((e=>(0,b.WN)(e.slice(0,t.maxResults||15),!1))).startWith((0,b.yo)(!0)).takeUntil(e.ofType(b.Av,b.M8,b.dX)).concat([(0,b.yo)(!1)]).catch((e=>{const t={msgId:"search.generic_error",...e,message:e.message,stack:e.stack};return le.Observable.from([(0,b.kE)(t),(0,b.yo)(!1)])})))),searchOnStartEpic:(e,t)=>e.ofType(b.Vc).switchMap((e=>{let{layer:r,cql_filter:o}=e;const s=t.getState();if(0===(0,fe.OX)(s).filter((e=>e.name===r)).length)return le.Observable.of((0,b.Tw)());const a=(0,fe.dT)(s,r);return a&&o?le.Observable.defer((()=>(0,_e.DH)(a.url,{maxFeatures:1,typeName:r,srsName:"EPSG:4326",outputFormat:"application/json",cql_filter:o}).then((function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.features&&e.features.length&&{...e.features[0],typeName:r}})))).switchMap((e=>{let{type:t,geometry:r,typeName:s}=e,a=de()({type:t,geometry:r}).geometry.coordinates;const n={lng:a[0],lat:a[1]};return a?le.Observable.of((0,be.lK)({latlng:n},s,[s],{[s]:{cql_filter:o}}),(0,be.HP)()):le.Observable.empty()})).catch((()=>le.Observable.of((0,b.I3)()))):le.Observable.empty()})),searchItemSelected:(e,t)=>e.ofType(b.dX).switchMap((e=>{let r=le.Observable.of(e.item).concatMap((t=>{if(t&&t.__SERVICE__&&t.__SERVICE__.geomService){let e=(0,J.generateTemplateString)(t.__SERVICE__.geomService.options.staticFilter||"")(t);return le.Observable.fromPromise(Se.b.Utils.getService(t.__SERVICE__.geomService.type)("",n()({},t.__SERVICE__.geomService.options,{staticFilter:e})).then((e=>n()({},t,{geometry:ve.default.mergeToPolyGeom(e)}))))}return le.Observable.of(e.item)})).concatMap((e=>{let r=e.bbox||e.properties.bbox||ce()(e),o=[(0,f.Px)([r[0],r[1],r[2],r[3]],"EPSG:4326",e.__SERVICE__&&e.__SERVICE__.options&&e.__SERVICE__.options.maxZoomLevel||21),(0,b._q)(e)];if(e.__SERVICE__&&!ge()(e.__SERVICE__.launchInfoPanel)&&e.__SERVICE__.options&&e.__SERVICE__.options.typeName){let r=de()(e).geometry.coordinates;const s={lng:r[0],lat:r[1]},a=e.__SERVICE__.options.typeName;if(r){const r=t.getState(),n=a&&(0,fe.dT)(r,a);let l=null,i=[],c={},u=!1;return"single_layer"===e.__SERVICE__.launchInfoPanel&&(u=e.__SERVICE__.forceSearchLayerVisibility,i=[a],l=e.id,c={[e.__SERVICE__.options.typeName]:{info_format:Ce(n,r),...l?{featureid:l,CQL_FILTER:void 0}:{}}}),[...u&&n?[(0,ye.He)(n.id,{visibility:!0})]:[],...e.__SERVICE__.openFeatureInfoButtonEnabled?[]:[(0,be.lK)({latlng:s},a,i,c,l)],(0,be.HP)(),...o]}}return o}));const o=e.item;let s=o&&o.__SERVICE__&&o.__SERVICE__.then,a=s?le.Observable.of((0,b.QJ)(s.map((e=>({...e,options:{item:o,...e.options}}))),{text:(0,J.generateTemplateString)(o.__SERVICE__.displayName||"")(o),placeholder:o.__SERVICE__.nestedPlaceholder&&(0,J.generateTemplateString)(o.__SERVICE__.nestedPlaceholder||"")(o),placeholderMsgId:o.__SERVICE__.nestedPlaceholderMsgId&&(0,J.generateTemplateString)(o.__SERVICE__.nestedPlaceholderMsgId||"")(o)},(0,J.generateTemplateString)(o.__SERVICE__.searchTextTemplate||"")(o))):le.Observable.empty(),l=o.__SERVICE__&&o.__SERVICE__.searchTextTemplate,i=l?le.Observable.of((0,b.k9)((0,J.generateTemplateString)(l)(o))):le.Observable.empty();return le.Observable.of((0,b.kV)()).concat(r,a,i)})),zoomAndAddPointEpic:(e,t)=>e.ofType(b.b4).switchMap((e=>{const r={type:"Feature",geometry:{type:"Point",coordinates:[e.pos.x,e.pos.y]}},o=t.getState();return le.Observable.from([(0,m.W)("search","search","overlay",{features:[r],type:"vector",name:"searchPoints",id:"searchPoints",visibility:!0,style:o.search&&o.search.style||se.be}),(0,f.xy)(e.pos,e.zoom,e.crs)])})),textSearchShowGFIEpic:(e,t)=>e.ofType(b.al).filter((e=>{var t;let{item:r={}}=e;return!(null!=r&&null!==(t=r.__SERVICE__)&&void 0!==t&&t.customGFI)})).switchMap((r=>{var o,s,a,n,l;let{item:i}=r;const c=t.getState(),u=null==i||null===(o=i.__SERVICE__)||void 0===o||null===(s=o.options)||void 0===s?void 0:s.typeName,d=u&&(0,fe.dT)(c,u),p=i.bbox||i.properties.bbox||ce()(i),m=de()(i).geometry.coordinates,h={lng:m[0],lat:m[1]},g=i.id;return m&&(0,se.zA)(null==i?void 0:i.__SERVICE__)&&(0,se.Tv)(d,null==i?void 0:i.__SERVICE__)?le.Observable.of(...null!=i&&null!==(a=i.__SERVICE__)&&void 0!==a&&a.forceSearchLayerVisibility&&d?[(0,ye.He)(d.id,{visibility:!0})]:[],(0,be.lK)({latlng:h},u,[u],{[u]:{info_format:Ce(d,c),...g?{featureid:g,CQL_FILTER:void 0}:{}}},g),(0,be.HP)(),(0,b._q)(i)).merge(p?e.ofType(be.XL).take(1).mapTo((0,f.Px)([p[0],p[1],p[2],p[3]],"EPSG:4326",(null==i||null===(n=i.__SERVICE__)||void 0===n||null===(l=n.options)||void 0===l?void 0:l.maxZoomLevel)||21)).takeUntil(e.ofType(be.Ih,be.km)):le.Observable.empty()).let((e=>p&&(0,fe._$)(t.getState())?e.startWith((0,be.PM)(!1)).concat(le.Observable.of((0,be.PM)(!0))):e)):le.Observable.empty()}))},reducers:{search:function(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1?arguments[1]:void 0;switch(r.type){case b.NN:return n()({},t,{loading:r.loading});case b.O7:return n()({},t,{error:r.error});case b.gs:return n()({},t,{searchText:r.searchText,error:null});case b.p7:let o=r.results;return!0===r.append&&t&&t.results&&(o=[...t.results,...r.results]),n()({},t,{results:o,error:null});case b.Av:return n()({},t,{results:null,error:null});case b.wn:const s=r.markerPosition.latlng?{latlng:r.markerPosition.latlng,lat:r.markerPosition.latlng.lat,lng:r.markerPosition.latlng.lng}:r.markerPosition;return n()({},t,{markerPosition:s,markerLabel:r.markerLabel});case b.Gh:return n()({},t,{highlightedFeature:r.highlightedFeature});case b.M8:return{style:t.style||{}};case g.l:return null;case b.C2:return n()({},t,{selectedServices:r.services,searchText:r.searchText,selectedItems:(t.selectedItems||[]).concat(r.items)});case b.oQ:return t?n()({},{selectedItems:t.selectedItems&&t.selectedItems.filter((e=>e!==r.item)),searchText:""===t.searchText&&r.item&&r.item.text?r.item.text.substring(0,r.item.text.length):t.searchText}):t;case b.x2:return n()({},t,{style:r.style});case b.Y7:return{...t,activeSearchTool:r.activeSearchTool};case b.GI:return{...t,format:r.format};case b.KP:return{...t,coordinate:{...t.coordinate,[r.coord]:r.val}};case b.dS:return n()({},t,{markerPosition:null!=t&&null!==(e=t.markerPosition)&&void 0!==e&&e.latlng?{}:null==t?void 0:t.markerPosition});default:return t}},mapInfo:ke.Z}}},988737:(e,t,r)=>{"use strict";r.d(t,{Z:()=>E});var o=r(727418),s=r.n(o),a=r(630998),n=r.n(a),l=r(352353),i=r.n(l),c=r(441609),u=r.n(c),d=r(755745),p=r.n(d),m=r(165442),h=r.n(m),g=r(917450),f=r(926854),b=r(687753),y=r(710187),v=r(726598);function S(e,t,r){const o="vector"===r,a=o?t.reqId:n()(e.requests||[],(e=>e.reqId===t.reqId));if(-1!==a){var l;if(["exceptions","error"].includes(r)){const t=e.requests.filter(((e,t)=>t!==a)),r=e.responses.filter(((e,t)=>t!==a));return{...e,responses:r,requests:t}}const{configuration:n,requests:c}=e;let d=e.responses||[];const p="hover"===(null==n?void 0:n.trigger)||(null==e?void 0:e.showInMapPopup);if(!o){const e={response:t[r],queryParams:t.requestParams,layerMetadata:t.layerMetadata,layer:t.layer};p?d=[...d,e]:d[a]=e}let m;return p?m={loaded:!0,index:0}:!p&&((e,t,r,o)=>{var s,a;const{configuration:n,requests:l,queryableLayers:c=[],index:d}=e,{infoFormat:p}=n||{},m=null===(s=(0,v.Te)(p))||void 0===s?void 0:s.getValidResponses([t[r]]),h=null===(a=(0,v.Te)(p))||void 0===a?void 0:a.getNoValidResponses(t),g=i()(d)&&!!m.length,f=!o&&l.length===h.filter((e=>e)).length,b=i()(d)&&o&&l.filter((e=>u()(e))).length===c.length;return g||f||b})(e,d,a,o)?m={loaded:!0,index:a}:d.length!==c.length||null!==(l=m)&&void 0!==l&&l.loaded||(m={loaded:!0}),s()({},e,{...o&&{requests:c},...!i()(m)&&m,responses:[...d]})}return e}const _={enabled:!0,configuration:{}},E=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case g.Re:return s()({},e,{warning:"NO_QUERYABLE_LAYERS"});case g.ih:return s()({},e,{warning:null});case g.Xw:return s()({},e,{enabled:t.enabled});case g.ph:return s()({},e,{enabled:!e.enabled});case g.gG:return s()({},e,{index:t.index});case g.oz:return s()({},e,{highlight:t.enabled});case g.Pn:{const{reqId:r,request:o}=t,a=e.requests||[];return s()({},e,{requests:[...a,{request:o,reqId:r}]})}case g.DZ:const{index:o,loaded:a,...n}=e;return{...n,queryableLayers:[],responses:[],requests:[]};case g.XL:return S(e,t,"data");case g.Ih:return S(e,t,"exceptions");case g.km:return S(e,t,"error");case g.xy:return s()({},e,{clickPoint:t.point,clickLayer:t.layer||null,itemId:t.itemId||null,overrideParams:t.overrideParams||null,filterNameList:t.filterNameList||null});case g.e8:return{...e,configuration:{...e.configuration,infoFormat:t.infoFormat}};case g.E0:return s()({},e,{showMarker:!0});case g.F9:return s()({},e,{showMarker:!1});case g.X_:return s()({},e,{showModalReverse:!0,reverseGeocodeData:t.reverseGeocodeData});case g.pb:return s()({},e,{showModalReverse:!1,reverseGeocodeData:void 0});case b.l:return s()({},e,{showMarker:!1,responses:[],requests:[],configuration:{...e.configuration,trigger:"click"}});case g.qb:{var r;const o={type:"Feature",properties:{},geometry:{type:"Point",coordinates:[t.request.lng,t.request.lat]}};let a=t.metadata&&t.metadata.units;switch(a){case"m":default:a="meters";break;case"deg":a="degrees";break;case"mi":a="miles"}let n=t.metadata&&t.metadata.resolution||1,l=p()(o,(t.metadata.buffer||1)*n,a);const i=(t.layer.features||[]).filter((e=>{try{return"FeatureCollection"===e.type&&e.features&&e.features.length?e.features.reduce(((e,r)=>{let o=r.properties.useGeodesicLines&&r.properties.geometryGeodesic?{...r,geometry:r.properties.geometryGeodesic}:r;return e||h()(l,n&&t.metadata.buffer&&a?p()(o,1,"meters"):o)}),!1):h()(l,n&&t.metadata.buffer&&a?p()(e,1,"meters"):e)}catch(e){return!1}}));let c=e.responses||[];const u="hover"===(null==e||null===(r=e.configuration)||void 0===r?void 0:r.trigger)||(null==e?void 0:e.showInMapPopup),d={response:{crs:null,features:i,totalFeatures:"unknown",type:"FeatureCollection"},queryParams:t.request,layerMetadata:t.metadata,format:"JSON"};let m;u?(c=[...c,d],m={reqId:0}):(c[e.requests.length]=d,m={reqId:e.requests.length});const g=[...e.requests,{}];return S(s()({},e,{requests:g,queryableLayers:t.queryableLayers,responses:[...c]}),m,"vector")}case g.lF:return s()({},e,{centerToMarker:t.status});case g.ZF:return{...e,configuration:{...e.configuration,showEmptyMessageGFI:!e.configuration.showEmptyMessageGFI}};case f.ok:return{...e,configuration:t.config.mapInfoConfiguration||e.configuration||{}};case g.GI:return{...e,formatCoord:t.format};case g.B1:return{...e,showCoordinateEditor:!t.showCoordinateEditor};case g.gc:return{...e,currentEditFeatureQuery:t.query};case g.zX:return{...e,configuration:{...e.configuration,trigger:t.trigger}};case g.Zb:return{...e,showInMapPopup:t.value};case y.Wz:return"cesium"===t.mapType?{...e,configuration:{...e.configuration,trigger:"click"}}:e;case g.Xp:return{...e,...t.cfg};default:return e}}},652700:(e,t,r)=>{"use strict";r.d(t,{T:()=>a,z:()=>n});var o=r(227361),s=r.n(o);const a=e=>s()(e,"sidebarmenu.lastActiveItem",!1),n=e=>s()(e,"controls.sidebarMenu.enabled",!1)}}]);