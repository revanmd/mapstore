(self.webpackChunkmapstore2=self.webpackChunkmapstore2||[]).push([[962],{420544:(e,t,o)=>{"use strict";o.d(t,{Cv:()=>r,RD:()=>a,NR:()=>n,mV:()=>l,N3:()=>s,dR:()=>i,sS:()=>c,sm:()=>m});const r="SET_SEARCH_BOOKMARK_CONFIG",a="RESET_BOOKMARK_CONFIG",n="UPDATE_BOOKMARK",l="FILTER_BOOKMARKS";function s(e,t){return{type:r,property:e,value:t}}function i(){return{type:a}}function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return{type:n,bookmark:e,idx:t}}function m(e){return{type:l,filter:e}}},102187:(e,t,o)=>{"use strict";o.d(t,{Z:()=>d});var r=o(45697),a=o.n(r),n=o(124852),l=o.n(n),s=o(294184),i=o.n(s);function c(){return c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r])}return e},c.apply(this,arguments)}function m(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}class b extends l().Component{constructor(){super(...arguments),m(this,"state",{is:"active"}),m(this,"onClick",(()=>this.props.onClick?this.props.onClick.bind(this):()=>{})),m(this,"onDisable",(()=>this.props.onDisable?this.props.onDisable.bind(this):()=>{})),m(this,"onConfirm",(()=>this.props.onConfirm?this.props.onConfirm():this.props.confirming&&this.props.confirming.onClick?this.props.confirming.onClick():()=>{})),m(this,"isDisabled",(()=>"disabled"===this.state.is)),m(this,"isConfirming",(()=>"confirming"===this.state.is)),m(this,"isActive",(()=>!this.isConfirming()&&!this.isDisabled())),m(this,"handleClick",(()=>this.isConfirming()&&this.props.disableAfterConfirmed?(this.onConfirm(),this.onDisable(),void this.setState({is:"disabled"})):this.isConfirming()?(this.onConfirm(),void this.setState({is:"active"})):(this.onClick(),void this.setState({is:"confirming"})))),m(this,"handleBlur",(()=>{this.setState({is:"active"})}))}render(){const{children:e,buttonProps:t,confirming:o,disabled:r}=this.props;let{text:a,style:n,className:s="btn btn-sm btn-danger"}=this.props;const m=this.isDisabled(),b=this.isConfirming();return m&&(a=r&&r.text||"Loading...",s=r&&r.className||"btn btn-sm btn-secondary",n=r&&r.style||{}),b&&(a=o&&o.text||"Confirm?",s=o&&o.className||"btn btn-sm btn-warning",n=o&&o.style||{}),l().createElement("button",c({className:i()("confirm-button",s),style:n,onClick:this.handleClick,onBlur:this.handleBlur,disabled:m},t),e,e?" ":"",a)}}m(b,"propTypes",{disableAfterConfirmed:a().bool,resetOnBlur:a().bool,onConfirm:a().func,onDisable:a().func,onClick:a().func,text:a().oneOfType([a().string,a().node]),className:a().string,style:a().object,confirming:a().shape({text:a().oneOfType([a().string,a().node]),className:a().string,style:a().object,onClick:a().func}),disabled:a().shape({text:a().oneOfType([a().string,a().node]),className:a().string,style:a().object}),children:a().node,buttonProps:a().object}),m(b,"defaultProps",{resetOnBlur:!0});const d=b},687694:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>z});var r=o(124852),a=o.n(r),n=o(171703),l=o(22222),s=o(630294),i=o(227361),c=o.n(i),m=o(414293),b=o.n(m),d=o(152543),h=o(351546),p=o(102187),k=o(590504),u=o(23888),g=o(488400),f=o(45697),y=o.n(f),E=o(603754),C=o(804504),v=o(222777),x=o(486234),S=o(8204);const _=(0,x.Z)("filterPlaceholder")(E.Z),Z=e=>{const{filter:t="",onFilter:o,onPropertyChange:r,bookmarks:n=[]}=e,l=(e,t)=>{r("bookmark",e),r("editIdx",t),r("page",1)};return a().createElement(s.Grid,{fluid:!0,id:"bookmark-list",className:"ms-header",style:{width:"100%",boxShadow:"none"}},a().createElement(s.Row,null,a().createElement(s.Col,{xs:12,style:{padding:0}},a().createElement(_,{filterPlaceholder:"search.bookmarkFilter",filterText:t,onFilter:o}))),a().createElement(s.Row,{className:"bookmark-card"},0===n.length?a().createElement("div",{className:"search-bookmark-name"},a().createElement(C.Z,{msgId:"search.bookmarkslistempty"})):n.map(((e,o)=>{return(i=e.title)&&-1!==i.toLowerCase().indexOf(t.toLowerCase())?a().createElement(v.Z,{key:`bookmark-card-${o}`,preview:a().createElement(s.Glyphicon,{glyph:"bookmark"}),title:a().createElement("span",{onClick:()=>l(e,o),style:{margin:"6px 0px"}},e&&e.title),size:"sm",tools:a().createElement(S.Z,{btnDefaultProps:{className:"square-button-md no-border"},btnGroupProps:{style:{margin:10}},buttons:[{glyph:"pencil",tooltipId:"search.editBookmark",onClick:()=>l(e,o)},{glyph:"trash",tooltipId:"search.deleteBookmark",onClick:()=>(e=>{const t=n.filter(((t,o)=>o!==e));r("bookmarkSearchConfig",{bookmarks:t})})(o)}]})}):null;var i}))))};Z.propTypes={filter:y().string,onFilter:y().func.isRequired,onPropertyChange:y().func.isRequired,bookmarks:y().array.isRequired};const I={Element:Z,validate:!0};var w=o(694174),N=o.n(w),O=o(481330);const B=(0,x.Z)("placeholder")(s.FormControl),R=(0,x.Z)("placeholder")(O.Z),F=e=>{const{onPropertyChange:t,bookmark:o={},bbox:r}=e,{options:n={},title:l,layerVisibilityReload:i=!1}=o,c=(e,r)=>{const a={...o.options,[r]:parseFloat(e)};t("bookmark",{...o,options:a})},m=e=>{t("bookmark",{...o,title:e})},b=e=>n[e]?["north","south"].includes(e)?n[e]&&!N()(n[e],-90,91)?"error":null:n[e]&&!N()(n[e],-180,181)?"error":null:null;return a().createElement("div",{id:"add-new-bookmark"},a().createElement(s.Col,null,a().createElement(s.FormGroup,{validationState:b("title")},a().createElement(s.ControlLabel,null,a().createElement(C.Z,{msgId:"search.b_title"})),a().createElement(B,{className:"bookmark-title",value:l,name:"title",type:"text",placeholder:"search.b_title",onChange:e=>{let{target:t}=e;return m(t.value)},onBlur:e=>{let{target:t}=e;return m(t.value.trim())}}))),a().createElement(s.Col,null,a().createElement(s.FormGroup,{style:{display:"flex",justifyContent:"space-between"}},a().createElement(s.ControlLabel,null,a().createElement(C.Z,{msgId:"search.b_bbox"})),a().createElement("div",{id:"bookmark-tools"},a().createElement(s.OverlayTrigger,{key:"toggleLayer",placement:"top",overlay:a().createElement(s.Tooltip,{id:"search-bookmark-layer"},a().createElement(C.Z,{msgId:"search.b_layer_tooltip"}))},a().createElement(u.Z,{key:"toggleLayer",bsStyle:"primary",className:"square-button-md btn btn-default no-border",onClick:()=>{t("bookmark",{...o,layerVisibilityReload:!i})}},a().createElement(s.Glyphicon,{glyph:i?"eye-open":"eye-close"}))),a().createElement(s.OverlayTrigger,{key:"getBBox",placement:"top",overlay:a().createElement(s.Tooltip,{id:"search-bookmark-bbox"},a().createElement(C.Z,{msgId:"search.b_bbox_tooltip"}))},a().createElement(u.Z,{key:"getBBox",bsStyle:"primary",className:"square-button-md btn btn-default no-border",onClick:()=>{const[e,a,n,l]=r,s={west:parseFloat(e)||0,south:parseFloat(a)||0,east:parseFloat(n)||0,north:parseFloat(l)||0},i={...o.options,...s};t("bookmark",{...o,options:i})}},a().createElement(s.Glyphicon,{glyph:"fit-cover"})))))),a().createElement("div",{className:"bbox-field-group"},a().createElement("div",{className:"field-top-bottom"},a().createElement(s.FormGroup,{validationState:b("north")},a().createElement(s.ControlLabel,null,a().createElement(C.Z,{msgId:"search.b_bbox_north"})),a().createElement(R,{placeholder:"search.b_bbox_north_placeholder",min:-90,max:90,name:"north",type:"number",onChange:e=>c(e,"north"),value:n.north}))),a().createElement("div",{className:"field-center-group"},a().createElement("div",{className:"field-left-right"},a().createElement(s.FormGroup,{validationState:b("west")},a().createElement(s.ControlLabel,null,a().createElement(C.Z,{msgId:"search.b_bbox_west"})),a().createElement(R,{placeholder:"search.b_bbox_west_placeholder",min:-180,max:180,name:"west",type:"number",onChange:e=>c(e,"west"),value:n.west}))),a().createElement("div",{className:"field-left-right"},a().createElement(s.FormGroup,{validationState:b("east")},a().createElement(s.ControlLabel,null,a().createElement(C.Z,{msgId:"search.b_bbox_east"})),a().createElement(R,{placeholder:"search.b_bbox_east_placeholder",min:-180,max:180,name:"east",type:"number",onChange:e=>c(e,"east"),value:n.east})))),a().createElement("div",{className:"field-top-bottom"},a().createElement(s.FormGroup,{validationState:b("south")},a().createElement(s.ControlLabel,null,a().createElement(C.Z,{msgId:"search.b_bbox_south"})),a().createElement(R,{placeholder:"search.b_bbox_south_placeholder",min:-90,max:90,name:"south",type:"number",onChange:e=>c(e,"south"),value:n.south})))))};F.propTypes={onPropertyChange:y().func,bookmark:y().object,bbox:y().array};const P={Element:F,validate:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={},title:o=""}=e,{south:r,north:a,west:n,east:l}=t,s=N()(r,-90,91)&&N()(a,-90,91),i=N()(n,-180,181)&&N()(l,-180,181),c=!!o.trim().length;return i&&s&&c}};var T=o(687753),j=o(596974),D=o(420544),G=o(926854),L=o(274363),A=o(510644);function q(){return q=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r])}return e},q.apply(this,arguments)}const K=(e,t,o,r)=>{let{canEdit:a,id:n}=o;const l=t&&(a||b()(n));return"ALL"===e||"EDIT"===e&&l||"ADMIN"===e&&r},M=(0,n.connect)((0,l.P1)([e=>{var t;return(null==e||null===(t=e.search)||void 0===t?void 0:t.activeSearchTool)||null},e=>(null==e?void 0:e.searchbookmarkconfig)||{}],((e,t)=>({active:"bookmarkSearch"===e,show:(null==t?void 0:t.allowUser)||!!c()(t,"bookmarkSearchConfig.bookmarks",[]).length}))),{onClick:j.a})((e=>{let{show:t,onClick:o,active:r}=e;return t?a().createElement(s.MenuItem,{active:r,onClick:()=>{o("bookmarkSearch"),document.dispatchEvent(new MouseEvent("click"))}},a().createElement(s.Glyphicon,{glyph:"bookmark"})," ",a().createElement(g.Z,{msgId:"search.searchByBookmark"})):null})),V=(0,l.P1)([L.Od,e=>e.controls||{},e=>e.searchbookmarkconfig||{},A.jl,A.qg,L._H],(function(e,t,o,r,a){let n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};return{bbox:e&&e.bbox&&(0,h.getExtentFromViewport)(e.bbox),enabled:t.searchBookmarkConfig&&t.searchBookmarkConfig.enabled||!1,pages:[I,P],page:o&&o.page||0,bookmark:o&&o.bookmark,bookmarkSearchConfig:o&&o.bookmarkSearchConfig,editIdx:o&&o.editIdx,filter:o&&o.filter,allowUser:K(c()(o,"bookmarkEditing"),r,n,a)}})),U=(0,n.connect)(V,{toggleControl:T.Xi,onPropertyChange:D.N3,resetBookmarkConfig:D.dR,updateBookmark:D.sS,onFilter:D.sm})((e=>{const{enabled:t,pages:o,page:n,onPropertyChange:l,bookmark:i,bookmarkSearchConfig:c={},editIdx:m,zoomOnSelect:b=!0,bookmarkEditing:d="EDIT",allowUser:h}=e;(0,r.useEffect)((()=>{l("zoomOnSelect",b),l("bookmarkEditing",d)}),[l]),(0,r.useEffect)((()=>{l("allowUser",h)}),[h]);const f=()=>{n>1?l("page",n-1):1===n&&e.resetBookmarkConfig()},y=()=>o[n].validate(i),E=o&&o[n]||null;return t?a().createElement(k.Z,{id:"bookmark-panel-dialog",draggable:!0,modal:!1},a().createElement("span",{role:"header",style:{display:"flex",justifyContent:"space-between"}},a().createElement("span",null,(()=>{const e=0===n?"search.b_listpaneltitle":"search.b_newpaneltitle";return a().createElement(g.Z,{msgId:e})})()),0===n&&a().createElement("button",{onClick:()=>{e.toggleControl("searchBookmarkConfig"),e.resetBookmarkConfig()},className:"close"}," ",a().createElement(s.Glyphicon,{glyph:"1-close"}))),a().createElement("div",{role:"body",className:"services-config-editor"},a().createElement(E.Element,q({bookmarks:c.bookmarks,onPropertyChange:l,bookmark:i},e))),0===n?a().createElement("span",{role:"footer"},a().createElement(u.Z,{onClick:()=>{l("bookmark",{}),l("page",1)},bsStyle:"primary"},a().createElement(g.Z,{msgId:"search.addbtn"}))):n===o.length-1?a().createElement("span",{role:"footer"},a().createElement(u.Z,{onClick:f,bsStyle:"primary"},a().createElement(g.Z,{msgId:"search.prevbtn"})),a().createElement(u.Z,{disabled:!y(),onClick:()=>{const{layerVisibilityReload:t=!1}=i;e.updateBookmark({...i,layerVisibilityReload:t},m)},bsStyle:"success"},a().createElement(g.Z,{msgId:"search.savebtn"}))):a().createElement("span",{role:"footer"},1===n?a().createElement(p.Z,{onConfirm:f,bsStyle:"primary",confirming:{text:a().createElement(g.Z,{msgId:"search.cancelconfirm"})},text:a().createElement(g.Z,{msgId:"search.cancelbtn"})}):a().createElement(u.Z,{onClick:f,bsStyle:"primary"},a().createElement(g.Z,{msgId:1===n?"search.cancelbtn":"search.prevbtn"})),a().createElement(u.Z,{disabled:!y(),onClick:()=>{n<o.length-1&&l("page",n+1)},bsStyle:"primary"},a().createElement(g.Z,{msgId:"search.nextbtn"})))):null})),z=(0,d.rx)("SearchByBookmark",{component:U,containers:{Search:{menuItem:M,bookmarkConfig:(e,t,o)=>({onClick:()=>{t||e("searchBookmarkConfig")},glyph:"cog",className:"square-button-md no-border ",tooltipId:"search.bookmarksettings",tooltipPosition:"bottom",bsStyle:"default",pullRight:!0,visible:"bookmarkSearch"===o})}},reducers:{searchbookmarkconfig:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case D.Cv:return{...e,[t.property]:t.value};case G.ok:{const o=t.config.map.bookmark_search_config||{};return{...e,bookmarkSearchConfig:o}}case T.l:case D.RD:return{...e,bookmark:void 0,page:0,editIdx:void 0};case D.NR:{let o=(e.bookmarkSearchConfig&&e.bookmarkSearchConfig.bookmarks||[]).slice();const r={...t.bookmark};return-1!==t.idx?o[t.idx]=r:o.push(r),{...e,bookmark:void 0,page:0,editIdx:void 0,bookmarkSearchConfig:{...e.bookmarkSearchConfig,bookmarks:o}}}case D.mV:return{...e,filter:t.filter};default:return e}}}})},488400:(e,t,o)=>{"use strict";o.d(t,{Z:()=>n});var r=o(171703),a=o(804504);const n=(0,r.connect)((e=>({locale:e.locale&&e.locale.currentLocale,messages:e.locale&&e.locale.messages||[]})))(a.Z)}}]);