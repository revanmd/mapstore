(self.webpackChunkmapstore2=self.webpackChunkmapstore2||[]).push([[7535],{403410:(e,t,n)=>{"use strict";n.d(t,{hn:()=>i,yg:()=>o,vD:()=>r,jJ:()=>a,oy:()=>s,W:()=>l,B1:()=>c,fU:()=>d,cY:()=>p});const i="ADDITIONALLAYER:ADD_ADDITIONAL_LAYERS",o="ADDITIONALLAYER:REMOVE_ADDITIONAL_LAYER",r="ADDITIONALLAYER:REMOVE_ALL_ADDITIONAL_LAYERS",a="ADDITIONALLAYER:UPDATE_ADDITIONAL_LAYER",s="ADDITIONALLAYER:UPDATE_OPTIONS_BY_OWNER",l=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"override",i=arguments.length>3?arguments[3]:void 0;return{type:a,id:e,owner:t,actionType:n,options:i}},c=(e,t)=>({type:s,owner:e,options:t}),d=function(){let{id:e,owner:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:o,id:e,owner:t}},p=e=>({type:r,owner:e})},535035:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>ye});var i={};n.r(i),n.d(i,{disableGFIForStreetViewEpic:()=>le,streetViewMapClickHandler:()=>de,streetViewSetupTearDown:()=>ce,streetViewSyncLayer:()=>pe,tearDownStreetViewOnDrawToolActive:()=>ue});var o=n(124852),r=n.n(o),a=n(630294),s=n(171703),l=n(152543);const c="street-view",d=c,p="street-view-marker",u="street-view-data";var h=n(22222),g=n(804504),v=n(590504),f=n(101706),y=n(119008),m=n(873826),w=n(108469);const b=(0,y.Yq)(c),E=e=>(null==e?void 0:e.streetView)??{},I=e=>{var t;return null===(t=E(e))||void 0===t?void 0:t.apiLoaded},k=(0,h.P1)(E,(function(){let{location:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e})),A=(0,h.P1)(E,(function(){let{pov:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e}));function L(e){var t;return(null===(t=E(e))||void 0===t?void 0:t.configuration)??{}}const O={provider:"custom",type:"tileprovider",url:"https://mts1.googleapis.com/vt?hl=en-US&lyrs=svv|cb_client:apiv3&style=40,18&x={x}&y={y}&z={z}"};function S(e){var t;return(null===(t=L(e))||void 0===t?void 0:t.useDataLayer)??!0}var D=n(687753),T=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var i,o,r;if(Array.isArray(t)){if((i=t.length)!=n.length)return!1;for(o=i;0!=o--;)if(!e(t[o],n[o]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((i=(r=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(o=i;0!=o--;)if(!Object.prototype.hasOwnProperty.call(n,r[o]))return!1;for(o=i;0!=o--;){var a=r[o];if(!e(t[a],n[a]))return!1}return!0}return t!=t&&n!=n};const M="__googleMapsScriptId";class N{constructor({apiKey:e,channel:t,client:n,id:i=M,libraries:o=[],language:r,region:a,version:s,mapIds:l,nonce:c,retries:d=3,url:p="https://maps.googleapis.com/maps/api/js"}){if(this.CALLBACK="__googleMapsCallback",this.callbacks=[],this.done=!1,this.loading=!1,this.errors=[],this.version=s,this.apiKey=e,this.channel=t,this.client=n,this.id=i||M,this.libraries=o,this.language=r,this.region=a,this.mapIds=l,this.nonce=c,this.retries=d,this.url=p,N.instance){if(!T(this.options,N.instance.options))throw new Error(`Loader must not be called again with different options. ${JSON.stringify(this.options)} !== ${JSON.stringify(N.instance.options)}`);return N.instance}N.instance=this}get options(){return{version:this.version,apiKey:this.apiKey,channel:this.channel,client:this.client,id:this.id,libraries:this.libraries,language:this.language,region:this.region,mapIds:this.mapIds,nonce:this.nonce,url:this.url}}get failed(){return this.done&&!this.loading&&this.errors.length>=this.retries+1}createUrl(){let e=this.url;return e+=`?callback=${this.CALLBACK}`,this.apiKey&&(e+=`&key=${this.apiKey}`),this.channel&&(e+=`&channel=${this.channel}`),this.client&&(e+=`&client=${this.client}`),this.libraries.length>0&&(e+=`&libraries=${this.libraries.join(",")}`),this.language&&(e+=`&language=${this.language}`),this.region&&(e+=`&region=${this.region}`),this.version&&(e+=`&v=${this.version}`),this.mapIds&&(e+=`&map_ids=${this.mapIds.join(",")}`),e}deleteScript(){const e=document.getElementById(this.id);e&&e.remove()}load(){return this.loadPromise()}loadPromise(){return new Promise(((e,t)=>{this.loadCallback((n=>{n?t(n.error):e(window.google)}))}))}loadCallback(e){this.callbacks.push(e),this.execute()}setScript(){if(document.getElementById(this.id))return void this.callback();const e=this.createUrl(),t=document.createElement("script");t.id=this.id,t.type="text/javascript",t.src=e,t.onerror=this.loadErrorCallback.bind(this),t.defer=!0,t.async=!0,this.nonce&&(t.nonce=this.nonce),document.head.appendChild(t)}reset(){this.deleteScript(),this.done=!1,this.loading=!1,this.errors=[],this.onerrorEvent=null}resetIfRetryingFailed(){this.failed&&this.reset()}loadErrorCallback(e){if(this.errors.push(e),this.errors.length<=this.retries){const e=this.errors.length*Math.pow(2,this.errors.length);console.log(`Failed to load Google Maps script, retrying in ${e} ms.`),setTimeout((()=>{this.deleteScript(),this.setScript()}),e)}else this.onerrorEvent=e,this.callback()}setCallback(){window.__googleMapsCallback=this.callback.bind(this)}callback(){this.done=!0,this.loading=!1,this.callbacks.forEach((e=>{e(this.onerrorEvent)})),this.callbacks=[]}execute(){if(this.resetIfRetryingFailed(),this.done)this.callback();else{if(window.google&&window.google.maps&&window.google.maps.version)return console.warn("Google Maps already loaded outside @googlemaps/js-api-loader.This may result in undesirable behavior as options and script parameters may not match."),void this.callback();this.loading||(this.loading=!0,this.setCallback(),this.setScript())}}}const C=e=>{var t,n;return{pano:null==e?void 0:e.pano,shortDescription:null==e?void 0:e.shortDescription,description:null==e?void 0:e.description,latLng:{lat:null==e||null===(t=e.latLng)||void 0===t?void 0:t.lat(),lng:null==e||null===(n=e.latLng)||void 0===n?void 0:n.lng()}}};let P;function x(){return P}const R="STREET_VIEW:API_LOADING",_="STREET_VIEW:API_LOADED",V="STREET_VIEW:SET_LOCATION",Z="STREET_VIEW:SET_POV",j="STREET_VIEW:CONFIGURE",z="STREET_VIEW:RESET";function U(e){return{type:R,loading:e}}function Y(){return(e,t)=>{var n,i,o,r,a,s,l;I(t())?e((0,D.Xi)(c,"enabled")):(U(!0),function(){let{apiKey:e,version:t="weekly",useStaticCache:n=!0,...i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(n?P:void 0)?new Promise((e=>e(P))):new N({apiKey:e,version:t,...i}).load().then((e=>(P=e,e)))}({apiKey:(n=t(),(null===(i=L(n))||void 0===i?void 0:i.apiKey)??(null===(o=(0,w.kQ)(n))||void 0===o||null===(r=o.apiKeys)||void 0===r?void 0:r.googleStreetViewAPIKey)??(null===(a=(0,w.kQ)(n))||void 0===a||null===(s=a.apiKeys)||void 0===s?void 0:s.googleAPIKey)??(null===(l=(0,w.kQ)(n))||void 0===l?void 0:l.googleAPIKey))}).then((()=>{U(!1),e({type:_}),e((0,D.Xi)(c,"enabled"))})).catch((e=>{U(!1),console.log(e)})))}}function K(e){return{type:V,location:e}}var B=n(618446),W=n.n(B),G=n(747119);const $=()=>r().createElement(G.Z,{iconFit:!1,glyph:"road",title:r().createElement(g.Z,{msgId:"streetView.emptyTitle"}),description:r().createElement(g.Z,{msgId:"streetView.emptyDescription"})}),H=e=>{const{size:t,google:n,position:i,location:a,pov:s,className:l="google-street-view",style:c={},panoramaOptions:d={}}=e,p=(0,o.useRef)(),[u,h]=(0,o.useState)();(0,o.useEffect)((()=>{if(n&&a&&!u){const e=new n.maps.StreetViewPanorama(p.current,{position:i,pov:s,zoom:1,...d});a.pano&&e.setPano(a.pano),h(e)}}),[n,a,u,d]);const[g,v]=(0,o.useState)();return(0,o.useEffect)((()=>(u&&v(((e,t)=>{let{location:n,setLocation:i,setPov:o}=t;const r=[];return r.push(e.addListener("position_changed",(()=>{const t=C(e.getLocation());W()(null==n?void 0:n.latLng,null==t?void 0:t.latLng)||i(t)}))),r.push(e.addListener("pov_changed",(()=>{const{heading:t,pitch:n}=e.getPov();o({heading:t,pitch:n})}))),r})(u,e)),function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];e&&t.forEach((t=>e.removeListener(t)))}(u,g))),[u]),(0,o.useEffect)((()=>{n&&n.maps.event.trigger(u,"resize")}),[t]),(0,o.useEffect)((()=>{u&&a.pano&&u.setPano(a.pano)}),[null==a?void 0:a.pano]),r().createElement(r().Fragment,null,r().createElement("div",{className:l,style:{display:u?"none":"block",...c}},r().createElement($,null)),r().createElement("div",{className:l,style:{display:u?"block":"none",...c},ref:p}))};function F(){return F=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},F.apply(this,arguments)}const Q=(0,s.connect)((0,h.zB)({apiLoaded:I,location:k,panoramaOptions:function(e){var t;return null===(t=L(e))||void 0===t?void 0:t.panoramaOptions}}),{setLocation:K,setPov:function(e){return{type:Z,pov:e}}})((e=>{let{apiLoaded:t,enabled:n,...i}=e;return t?r().createElement(H,F({location,google:x()},i)):null})),X=(0,s.connect)((0,h.zB)({enabled:b}),{onClose:()=>Y()})((function(e){let{enabled:t,onClose:n=(()=>{})}=e;const[i,s]=(0,o.useState)({width:400,height:300});return t?r().createElement(v.Z,{bodyClassName:"street-view-window-body",draggable:!0,style:{zIndex:1e4,position:"absolute",left:"17%",top:"50px",margin:0,width:i.width}},r().createElement("span",{role:"header",style:{display:"flex",justifyContent:"space-between"}},r().createElement("span",null,r().createElement(g.Z,{msgId:"streetView.title"})),r().createElement("button",{onClick:()=>n(),className:"close"},r().createElement(a.Glyphicon,{glyph:"1-close"}))),r().createElement("div",{role:"body",style:{height:i.height}},r().createElement(f.Resizable,{width:i.width,height:i.height,onResize:(e,t)=>{let{size:n}=t;s(n)}},r().createElement("div",{style:{display:"flex",flexDirection:"column",width:i.width,height:i.height}},r().createElement(Q,{enabled:t,size:i,style:{flex:1,margin:10,height:"calc(100% - 20px)",width:"calc(100% - 20px)"}}))))):null})),J={};var q=n(49977),ee=n.n(q),te=n(504518),ne=n(403410),ie=n(859518),oe=n(917450),re=n(975872),ae=n(502422);const se=function(e){let{rotation:t=0}=e;return`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" xml:space="preserve">\n\t\t<g transform="translate(50,50) scale(2)">\n            <circle style="stroke: #a5ff91; stroke-width: 2; fill: #5bA640; fill-opacity:0.6; opacity: 1;" vector-effect="non-scaling-stroke" cx="0" cy="0" r="13"/>\n        </g>\n        <g transform="translate(50,50) scale(2) rotate(${t})">\n            <polygon style="stroke: #a5ff91; stroke-width: 2; fill: #228D4F; fill-opacity:1; opacity: 1;" vector-effect="non-scaling-stroke" points="0,-12 5,-5 0,-8 -5,-5 "/>\n        </g>\n        <g transform="translate(50,50) translate(0,-5) scale(1.5)">\n            <circle style="stroke: #3100aa; stroke-width: 2; fill: #037dff; fill-opacity:1; opacity: 1;" vector-effect="non-scaling-stroke" cx="0" cy="0" r="3"/>\n        </g>\n        <g transform="translate(50,50) scale(2) translate(5,5) rotate(180)">\n            <path d="M0,0 a1,1 0 0,0 10,0" style="stroke: #3100aa; stroke-width: 2; fill: #037dff; fill-opacity:1; opacity: 1;" vector-effect="non-scaling-stroke"/>\n        </g>\n</svg>`},le=(e,t)=>{let{getState:n=(()=>{})}=t;return e.ofType(D.kM,D.At,D.dc).filter((e=>{let{control:t}=e;return t===c})).filter((()=>b(n()))).filter((()=>(0,re.yg)(n()))).switchMap((()=>ee().Observable.of((0,oe.aN)(),(0,oe.TM)()).merge(e.ofType(D.kM,D.At,D.dc).filter((e=>{let{control:t}=e;return t===c})).take(1).filter((()=>!b(n()))).filter((()=>!(0,re.yg)(n()))).mapTo((0,oe.TM)()).takeUntil(e.ofType(D.l)))))},ce=(e,t)=>{let{getState:n=(()=>{})}=t;return e.ofType(D.kM,D.At,D.dc).filter((e=>{let{control:t}=e;return t===c})).filter((()=>b(n()))).switchMap((()=>{return ee().Observable.from([(0,ie.H0)("click",c),...S(n())?[(0,ne.W)(u,d,"overlay",{id:u,name:u,visibility:!0,...(t=n(),(null===(i=L(t))||void 0===i?void 0:i.dataLayerConfig)??O)})]:[],(0,ne.W)(p,d,"overlay",{id:p,type:"vector",name:p,visibility:!0})]).concat(e.ofType(D.kM,D.At,D.dc).filter((e=>{let{control:t}=e;return t===c})).filter((()=>!b(n()))).take(1).switchMap((()=>ee().Observable.from([(0,ie.$X)("click",c),...S(n())?[(0,ne.fU)({id:u,owner:d})]:[],(0,ne.fU)({id:p,owner:d})]))).takeUntil(e.ofType(D.l)));var t,i}))},de=(e,t)=>{let{getState:n=(()=>{})}=t;return e.ofType(ie.TR).filter((()=>b(n()))).filter((()=>I(n()))).switchMap((e=>{let{point:t}=e;const n=t.latlng;return ee().Observable.defer((()=>function(e){return(new(x().maps.StreetViewService)).getPanorama({location:e,radius:50}).then((function(){let{data:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{location:t}=e??{};return C(t)}))}(n))).map(K).catch((e=>"ZERO_RESULTS"===e.code?ee().Observable.of((0,te.um)({title:"streetView.title",message:"streetView.messages.noDataForPosition"})):(console.error(e),ee().Observable.of((0,te.vU)({title:"streetView.title",message:"streetView.messages.unknownError"})))))}))},pe=(e,t)=>{let{getState:n=(()=>{})}=t;return e.ofType(V,Z).switchMap((()=>{const e=n(),t=k(e),i=A(e);return t?ee().Observable.of(((e,t)=>{const{lat:n,lng:i}=null==e?void 0:e.latLng;return{type:"Feature",geometry:{type:"Point",coordinates:[i,n],crs:"EPSG:4326"},style:[{iconAnchor:[.5,.5],anchorXUnits:"fraction",anchorYUnits:"fraction",opacity:1,size:100,symbolUrl:"data:image/svg+xml;charset=utf-8,"+encodeURIComponent(se({rotation:null==t?void 0:t.heading})),shape:"triangle",id:"c65cadc0-9b46-11ea-a138-dd5f1faf9a0d",highlight:!1,weight:4}]}})(t,i)).map((e=>{const t=function(e){var t,n;return null===(t=((0,m.K)(e)??[]).filter((e=>{let{id:t}=e;return t===p})))||void 0===t||null===(n=t[0])||void 0===n?void 0:n.options}(n());return(0,ne.W)(p,d,"overlay",{...t,features:[e]})})):ee().Observable.empty()}))},ue=(e,t)=>(0,ae.U)(e,t,c);var he=n(893379),ge=n.n(he),ve=n(91028);ge()(ve.Z,{insert:"head",singleton:!1}),ve.Z.locals;const fe=(0,s.connect)((()=>({})),{onMount:function(e){return{type:j,configuration:e}},onUnmount:function(){return{type:z}}})((e=>{let{onMount:t,onUnmount:n,apiKey:i,useDataLayer:a,dataLayerConfig:s,panoramaOptions:l}=e;return(0,o.useEffect)((()=>(t({apiKey:i,useDataLayer:a,dataLayerConfig:s,panoramaOptions:l}),()=>{n()})),[i,a,s,JSON.stringify(l??{})]),r().createElement(X,null)})),ye=(0,l.rx)("StreetView",{options:{disablePluginIf:"{state('mapType') === 'leaflet' || state('mapType') === 'cesium'}"},epics:i,reducers:{streetView:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:J,t=arguments.length>1?arguments[1]:void 0;const n=null==t?void 0:t.type;switch(n){case j:return{...e,configuration:null==t?void 0:t.configuration};case V:return{...e,location:(null==t?void 0:t.location)??e.location};case Z:return{...e,pov:(null==t?void 0:t.pov)??e.pov};case R:return{...e,apiLoading:null==t?void 0:t.loading};case _:return{...e,apiLoaded:!0};case z:return J;default:return e}}},component:fe,containers:{BurgerMenu:{position:40,priority:2,doNotHide:!0,name:c,text:r().createElement(g.Z,{msgId:"streetView.title"}),tooltip:"streetView.tooltip",icon:r().createElement(a.Glyphicon,{glyph:"road"}),action:()=>Y()},SidebarMenu:{position:40,priority:1,doNotHide:!0,name:c,text:r().createElement(g.Z,{msgId:"streetView.title"}),tooltip:"streetView.tooltip",icon:r().createElement(a.Glyphicon,{glyph:"road"}),action:()=>Y(),selector:e=>({bsStyle:e.controls["street-view"]&&e.controls["street-view"].enabled?"primary":"tray",active:e.controls["street-view"]&&e.controls["street-view"].enabled||!1})}}})},502422:(e,t,n)=>{"use strict";n.d(t,{U:()=>p});var i=n(687753),o=n(49977),r=n.n(o),a=n(119008),s=n(172768),l=n(296252),c=n(859518),d=n(306692);const p=function(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:(e,t)=>r().Observable.from([(0,i.Xg)(t,"enabled",null)]),p=arguments.length>4&&void 0!==arguments[4]?arguments[4]:(e,t)=>(0,a.Yq)(t)(e);return e.ofType(s.Np,l.hZ,c.YD,d.$O).filter((e=>{let{type:i,status:o,owner:r,eventName:a,toolName:u}=e;const h=p(t.getState(),n);switch(i){case d.$O:return"featureGrid"!==n;case c.YD:return h&&"click"===a&&u!==n;case l.hZ:return h&&("drawOrEdit"===o||"start"===o)&&r!==n;case s.Np:default:return h&&"annotations"!==n}})).switchMap((e=>p(t.getState(),n)?o(t.getState(),n,e):r().Observable.empty()))}},91028:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(923645),o=n.n(i)()((function(e){return e[1]}));o.push([e.id,"/* css for react-resizable */\n.ms2 .street-view-window-body .react-resizable-handle {\n        position: absolute;\n        width: 20px;\n        height: 20px;\n        bottom: 0;\n        right: 0;\n        background: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2IDYiIHN0eWxlPSJiYWNrZ3JvdW5kLWNvbG9yOiNmZmZmZmYwMCIgeD0iMHB4IiB5PSIwcHgiIHdpZHRoPSI2cHgiIGhlaWdodD0iNnB4Ij48ZyBvcGFjaXR5PSIwLjMwMiI+PHBhdGggZD0iTSA2IDYgTCAwIDYgTCAwIDQuMiBMIDQgNC4yIEwgNC4yIDQuMiBMIDQuMiAwIEwgNiAwIEwgNiA2IEwgNiA2IFoiIGZpbGw9IiMwMDAwMDAiLz48L2c+PC9zdmc+');\n        background-position: bottom right;\n        padding: 0 3px 3px 0;\n        background-repeat: no-repeat;\n        background-origin: content-box;\n        box-sizing: border-box;\n        cursor: se-resize;\n    }\n.ms2 .street-view-window-body .react-resizable {\n    position: relative;\n}\n/* override the standard justify */\n.ms2 .street-view-window-body .empty-state-container .empty-state-main-view .empty-state-description {\n    text-align: center;\n}\n",""]);const r=o}}]);