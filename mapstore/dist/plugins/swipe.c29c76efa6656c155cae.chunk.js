(self.webpackChunkmapstore2=self.webpackChunkmapstore2||[]).push([[6235],{141832:(e,t,n)=>{"use strict";n.d(t,{Z:()=>d});var r=n(124852),s=n.n(r),o=n(732833),l=n(756435),i=n(867076),a=n(630294),c=n(23888);const p={bottom:{true:"chevron-down",false:"chevron-up"},top:{true:"chevron-up",false:"chevron-down"},right:{true:"chevron-right",false:"chevron-left"},left:{true:"chevron-left",false:"chevron-right"}},u=e=>{let{position:t="right",onClose:n,bsStyle:r="default",title:o="",fullscreen:l=!1,showFullscreen:i=!1,glyph:u="info-sign",additionalRows:d,onFullscreen:m=(()=>{})}=e;const g=n?s().createElement(c.Z,{key:"ms-header-close",className:"square-button ms-close",onClick:n,bsStyle:r},s().createElement(a.Glyphicon,{glyph:"1-close"})):null,y=i?s().createElement(c.Z,{key:"ms-header-glyph",className:"square-button",bsStyle:r,onClick:()=>m(!l)},s().createElement(a.Glyphicon,{glyph:p[t]&&p[t][l]||"resize-full"})):s().createElement("div",{key:"ms-header-glyph",className:"square-button bg-"+r,style:{display:"flex"}},s().createElement(a.Glyphicon,{glyph:u,className:"default"===r?"text-primary":""})),h="left"===t?[g,y]:[y,g];return s().createElement(a.Grid,{fluid:!0,style:{width:"100%"},className:"ms-header ms-"+r},s().createElement(a.Row,null,s().createElement(a.Col,{xs:2},h[0]),s().createElement(a.Col,{xs:8},s().createElement("h4",null,o)),s().createElement(a.Col,{xs:2},h[1])),d)},d=(0,i.withState)("fullscreen","onFullscreen",!1)((e=>{let{fluid:t,className:n="",fullscreen:r=!1,position:i,open:a,size:c=550,style:p={},zIndex:d=1030,onClose:m,bsStyle:g,title:y,showFullscreen:h=!1,glyph:v,header:E,footer:w,children:f,onFullscreen:S=(()=>{}),fixed:b=!1,resizable:x=!1,hideHeader:C}=e;return s().createElement("div",{className:"ms-side-panel "+(b?"":"ms-absolute-dock ")+(x?"":"react-dock-no-resize ")+n},s().createElement(o.default,{fluid:t||r,position:i,dimMode:"none",isVisible:a,size:r?1:c,dockStyle:p,zIndex:d},s().createElement(l.Z,{header:!C&&a&&s().createElement(u,{position:i,onClose:m,bsStyle:g,title:y,fullscreen:r,showFullscreen:h,glyph:v,additionalRows:E,onFullscreen:S}),footer:a&&w},a&&f)))}))},688472:(e,t,n)=>{"use strict";n.d(t,{Z:()=>p});var r=n(124852),s=n.n(r),o=n(867076),l=n(756435),i=n(141832),a=n(283604);const c=(0,o.renameProps)({open:"show"})((e=>{let{children:t,header:n,...r}=e;return s().createElement(a.Z,r,s().createElement(l.Z,{header:s().createElement("div",{className:"ms-header"},n)},t))})),p=(0,o.branch)((e=>{let{dock:t}=e;return!t}),(()=>e=>s().createElement(c,e)))(i.Z)},801387:(e,t,n)=>{"use strict";n.r(t),n.d(t,{Support:()=>U,default:()=>K});var r=n(124852),s=n.n(r),o=n(171703),l=n(22222),i=n(612912),a=n(744448),c=n(727418),p=n.n(c);const u="SWIPE:SET_ACTIVE",d="SWIPE:SET_MODE",m="SWIPE:SET_SWIPE_TOOL_DIRECTION",g="SWIPE:SET_SPY_TOOL_RADIUS";function y(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"active";return{type:u,active:e,prop:t}}var h=n(49977),v=n.n(h),E=n(333101),w=n(275982);const f={resetLayerSwipeSettingsEpic:(e,t)=>e.ofType(E.c7).switchMap((e=>{let{nodeType:n}=e;const r=t.getState();return(0,a.yn)(r).active&&"group"===n?v().Observable.of(y(!1)):v().Observable.empty()})),deactivateSwipeToolOnSwitchMaps:(e,t)=>e.ofType(w.nk).switchMap((()=>(0,a.yn)(t.getState()).active?v().Observable.of(y(!1)):v().Observable.empty()))};var S=n(152543),b=n(743129),x=n(185552),C=n.n(x),P=n(313311),I=n.n(P),M=n(804504),k=n(688472);const z=[{label:"Horizontal",value:"cut-horizontal"},{label:"Vertical",value:"cut-vertical"}],T=e=>{let{spyModeSettings:t,onSetSpyToolRadius:n}=e;return s().createElement("div",{className:"mapstore-swipe-settings-spy"},s().createElement("h4",null,s().createElement(M.Z,{msgId:"toc.radius"})),s().createElement("div",{className:"mapstore-slider with-tooltip"},s().createElement(C(),{tooltips:!0,step:10,start:[t.radius],range:{min:[20],max:[100]},onChange:e=>n(e[0])})))},N=e=>{let{swipeModeSettings:t,onSetSwipeToolDirection:n}=e;return s().createElement("div",{className:"mapstore-swipe-settings-slider"},s().createElement("h4",null,s().createElement(M.Z,{msgId:"toc.direction"})),s().createElement(b.ZP,{styles:{menuPortal:e=>({...e,zIndex:3100})},onChange:e=>{let{value:t}=e;return n(t)},clearable:!1,value:I()(z,["value",t.direction]),options:z}))},R=(0,l.P1)([a.yn,a.wQ,a.IY],((e,t,n)=>({configuring:(null==e?void 0:e.configuring)||!1,toolMode:(null==e?void 0:e.mode)||"swipe",swipeModeSettings:t,spyModeSettings:n}))),Z=(0,o.connect)(R,{onSetConfigurationActive:y,onSetSwipeToolDirection:function(e){return{type:m,direction:e}},onSetSpyToolRadius:function(e){return{type:g,radius:e}}})((e=>{let{configuring:t,toolMode:n,swipeModeSettings:r,spyModeSettings:o,onSetConfigurationActive:l=(()=>{}),onSetSpyToolRadius:i=(()=>{}),onSetSwipeToolDirection:a=(()=>{})}=e;return s().createElement("div",{className:"mapstore-swipe-settings"},s().createElement(k.Z,{title:"spy"===n?s().createElement(M.Z,{msgId:"toc.spyconfiguration"}):s().createElement(M.Z,{msgId:"toc.swipeconfiguration"}),open:t,onClose:()=>l(!1,"configuring"),enableFooter:!1,draggable:!0,size:"xs",bodyClassName:"mapstore-swipe-setiings-modal-body",dialogClassName:" mapstore-swipe-settings-modal",glyph:"transfer"},"spy"===n?s().createElement(T,{spyModeSettings:o,onSetSpyToolRadius:i}):s().createElement(N,{swipeModeSettings:r,onSetSwipeToolDirection:a})))}));var L=n(630294),O=n(485294),A=n.n(O);const G=e=>{let{map:t,layer:n,type:s,getWidth:o,getHeight:l,circleCutProp:i}=e;const a=(0,r.useCallback)((e=>{let n=e.context;const r=o()*t.pixelRatio_;n.save(),n.beginPath(),n.rect(r,0,n.canvas.width-r,n.canvas.height),n.strokeStyle="rgba(0,0,0,0.5)",n.clip()}),[n,s]),c=(0,r.useCallback)((e=>{e.context.restore()}),[n,s]),p=(0,r.useCallback)((e=>{let n=e.context;const r=l()*t.pixelRatio_;n.save(),n.beginPath(),n.rect(0,r,n.canvas.width,n.canvas.height-r),n.clip()}),[n,s]),u=(0,r.useCallback)((e=>{let t=e.context,n=e.frameState.pixelRatio;t.save(),t.beginPath();const r=i.getMousePosition();r&&(t.arc(r[0]*n,r[1]*n,i.radius*n,0,2*Math.PI),t.lineWidth=5*n,t.strokeStyle="rgba(0,0,0,0.5)",t.stroke()),t.clip()}),[n,s,i]);return(0,r.useEffect)((()=>{const e=t.getLayers().getArray().filter((e=>e.get("msId")===n))[0];if(e){switch(s){case"cut-vertical":((e,t,n)=>{e.on("precompose",t),e.on("postcompose",n)})(e,a,c);break;case"cut-horizontal":((e,t,n)=>{e.on("precompose",t),e.on("postcompose",n)})(e,p,c);break;case"circle":((e,t,n)=>{e.on("precompose",t),e.on("postcompose",n)})(e,u,c)}return t.render(),()=>{e.un("precompose",a),e.un("precompose",p),e.un("precompose",u),e.un("postcompose",c),t.render()}}return()=>t.render()}),[n,s,i]),null},_=e=>{let{type:t,map:n,widthRef:o}=e;const[l,i]=(0,r.useState)(),[a,c]=(0,r.useState)(!0),p=()=>{i({x:0,y:0}),o.current=n.getProperties().size[0]/2};return(0,r.useEffect)((()=>(window.addEventListener("resize",p),()=>{window.removeEventListener("resize",p)})),[t]),(0,r.useEffect)((()=>{o.current=n.getProperties().size[0]/2}),[t]),s().createElement(A(),{position:l,bounds:"parent",onStart:()=>c(!1),onDrag:(e,t)=>((e,t)=>{o.current+=t.deltaX,i({x:t.x,y:t.y}),n.render()})(0,t),onStop:()=>c(!0)},s().createElement("div",{className:"mapstore-swipe-slider",style:{height:"100%",top:"0px",left:n.getProperties().size[0]/2+"px",width:"8px",cursor:"col-resize"}},a&&s().createElement("div",{className:"ms-vertical-swipe-slider-arrows",style:{top:n.getProperties().size[1]/2-26+"px"}},s().createElement("div",{className:"ms-slider-arrows"},s().createElement(L.Glyphicon,{glyph:"chevron-left"})),s().createElement("div",{className:"ms-slider-arrows"},s().createElement(L.Glyphicon,{glyph:"chevron-right"})))))},D=e=>{let{type:t,map:n,heightRef:o}=e;const[l,i]=(0,r.useState)(),[a,c]=(0,r.useState)(!0),p=()=>{i({x:0,y:0}),o.current=n.getProperties().size[1]/2};return(0,r.useEffect)((()=>(window.addEventListener("resize",p),()=>{window.removeEventListener("resize",p)})),[t]),(0,r.useEffect)((()=>{o.current=n.getProperties().size[1]/2}),[t]),s().createElement(A(),{position:l,bounds:"parent",onStart:()=>c(!1),onDrag:(e,t)=>((e,t)=>{o.current+=t.deltaY,i({x:t.x,y:t.y}),n.render()})(0,t),onStop:()=>c(!0)},s().createElement("div",{className:"mapstore-swipe-slider",style:{height:"8px",top:n.getProperties().size[1]/2+"px",left:"0px",width:"100%",cursor:"row-resize"}},a&&s().createElement("div",{className:"ms-horizontal-swipe-slider-arrows",style:{left:n.getProperties().size[0]/2-26+"px"}},s().createElement("div",{className:"ms-slider-arrows"},s().createElement(L.Glyphicon,{glyph:"chevron-up"})),s().createElement("div",{className:"ms-slider-arrows"},s().createElement(L.Glyphicon,{glyph:"chevron-down"})))))},F=e=>{let{map:t,layer:n,type:o="cut-vertical",active:l}=e;const i=(0,r.useRef)(),a=(0,r.useRef)();return n&&l?s().createElement(s().Fragment,null,"cut-vertical"===o&&s().createElement(_,{widthRef:a,map:t,type:o}),"cut-horizontal"===o&&s().createElement(D,{heightRef:i,map:t,type:o}),s().createElement(G,{map:t,layer:n,type:o,getWidth:()=>a.current,getHeight:()=>i.current})):null},Y=e=>{let{layer:t,map:n,active:o,radius:l}=e;const i=(0,r.useRef)(),a=(0,r.useCallback)((e=>{i.current=n.getEventPixel(e),n.render()}),[t,l]),c=(0,r.useCallback)((()=>{i.current=null,n.render()}),[t,l]);(0,r.useEffect)((()=>{const e=n.getTargetElement();return e.addEventListener("mousemove",a),e.addEventListener("mouseout",c),()=>{e.removeEventListener("mousemove",a),e.removeEventListener("mouseout",c)}}),[]);const p={radius:l,getMousePosition:()=>i.current};return t&&o?s().createElement(G,{map:n,layer:t,type:"circle",circleCutProp:p}):null};var W=n(45697),j=n.n(W);function q(){return q=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},q.apply(this,arguments)}const H=(0,n(36549).Z)(L.SplitButton),Q={title:s().createElement(L.Glyphicon,{glyph:"transfer"}),tooltipId:"toc.compareTool",tooltipPosition:"top",className:"square-button-md no-border",pullRight:!0},V=e=>{const{swipeSettings:t,onSetActive:n,onSetSwipeMode:r,status:o}=e;return s().createElement(H,q({onClick:()=>{t.active||"LAYER"!==o?n(!1):n(!0)},bsStyle:null!=t&&t.active?"success":"primary"},Q),s().createElement(L.MenuItem,{active:"swipe"===(null==t?void 0:t.mode),onClick:()=>{r("swipe"),n(!0)}},s().createElement(L.Glyphicon,{glyph:"vert-dashed"}),s().createElement(M.Z,{msgId:"toc.swipe"})),s().createElement(L.MenuItem,{active:"spy"===(null==t?void 0:t.mode),onClick:()=>{r("spy"),n(!0)}},s().createElement(L.Glyphicon,{glyph:"search"}),s().createElement(M.Z,{msgId:"toc.spyGlass"})),s().createElement(L.MenuItem,{onClick:()=>{t.configuring||"LAYER"!==o?n(!1,"configuring"):n(!0,"configuring")}},s().createElement(L.Glyphicon,{glyph:"cog"}),s().createElement(M.Z,{msgId:"toc.configureTool"})))};V.propTypes={swipeSettings:j().object,status:j().string,onSetActive:j().func,onSetSwipeMode:j().func},V.defaultProps={status:"LAYER",onSetSwipeMode:()=>{},onSetActive:()=>{}};const B=V,U=e=>{let{mode:t,map:n,layer:r,active:o,swipeModeSettings:l,spyModeSettings:i}=e;return"spy"===t?s().createElement(Y,{map:n,layer:r,active:o,radius:i.radius}):s().createElement(F,{map:n,layer:r,active:o,type:l.direction})},X=(0,l.P1)([i.Iz,a.yn,a.wQ,a.IY],((e,t,n,r)=>({layer:null==e?void 0:e.id,active:t.active||!1,swipeModeSettings:n,spyModeSettings:r,mode:(null==t?void 0:t.mode)||"swipe"}))),J=(0,o.connect)(X,null)(U),K=(0,S.rx)("Swipe",{options:{disablePluginIf:"{state('mapType') === 'leaflet' || state('mapType') === 'cesium'}"},component:Z,containers:{TOC:{name:"Swipe",target:"toolbar",selector:e=>{let{status:t}=e;return"LAYER"===t},Component:(0,o.connect)((0,l.P1)(a.yn,(e=>({swipeSettings:e}))),{onSetActive:y,onSetSwipeMode:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"swipe";return{type:d,mode:e}}})(B)},Map:{name:"Swipe",Tool:J}},reducers:{swipe:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case u:return p()({},e,{[t.prop]:t.active});case d:return p()({},e,{mode:t.mode});case m:{const n={...e.swipe,direction:t.direction};return p()({},e,{swipe:n})}case g:{const n={...e.spy,radius:t.radius};return p()({},e,{spy:n})}default:return e}}},epics:f})},744448:(e,t,n)=>{"use strict";n.d(t,{yn:()=>r,IY:()=>s,wQ:()=>o});const r=e=>e.swipe&&e.swipe||{active:!1},s=e=>{var t;return(null==e||null===(t=e.swipe)||void 0===t?void 0:t.spy)||{radius:80}},o=e=>{var t;return(null==e||null===(t=e.swipe)||void 0===t?void 0:t.swipe)||{direction:"cut-vertical"}}}}]);