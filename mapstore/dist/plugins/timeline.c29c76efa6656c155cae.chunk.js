(self.webpackChunkmapstore2=self.webpackChunkmapstore2||[]).push([[6523],{481151:(e,t,n)=>{"use strict";n.d(t,{NH:()=>a,E7:()=>r,N7:()=>i,L9:()=>s,hQ:()=>o,NC:()=>l,c9:()=>c,up:()=>d,AN:()=>p,FZ:()=>m,Fi:()=>u,KB:()=>g,E0:()=>y,Q_:()=>h,hY:()=>b,wO:()=>f,sT:()=>v,wR:()=>T,h1:()=>E,hS:()=>P,zK:()=>S,VS:()=>O,oz:()=>k,FH:()=>L,XN:()=>A,Ym:()=>w,RQ:()=>I});const a="PLAYBACK:START",r="PLAYBACK:PAUSE",i="PLAYBACK:STOP",s="PLAYBACK:SET_FRAMES",o="PLAYBACK:APPEND_FRAMES",l="PLAYBACK:FRAMES_LOADING",c="PLAYBACK:SET_CURRENT_FRAME",d="PLAYBACK:SELECT_PLAYBACK_RANGE",p="PLAYBACK:SET_INTERVAL_DATA",m="PLAYBACK:SETTINGS_CHANGE",u="PLAYBACK:TOGGLE_ANIMATION_MODE",g="PLAYBACK:ANIMATION_STEP_MOVE",y="PLAYBACK:UPDATE_METADATA",h={PLAY:"PLAY",STOP:"STOP",PAUSE:"PAUSE"},b=()=>({type:a}),f=()=>({type:r}),v=()=>({type:i}),T=e=>({type:s,frames:e}),E=e=>({type:c,frame:e}),P=e=>({type:o,frames:e}),S=e=>({type:l,loading:e}),O=e=>({type:d,range:e}),k=(e,t)=>({type:m,name:e,value:t}),L=()=>({type:u}),A=e=>({type:g,direction:e}),w=e=>{let{next:t,previous:n,forTime:a}=e;return{type:y,forTime:a,next:t,previous:n}},I=e=>({type:p,timeIntervalData:e})},832979:(e,t,n)=>{"use strict";n.d(t,{Z:()=>m});var a=n(124852),r=n.n(a),i=n(118438),s=n(630294),o=n(957557),l=n.n(o),c=n(180307),d=n.n(c);function p(){return p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},p.apply(this,arguments)}const m=e=>class extends r().Component{render(){let t=null;const{popoverOptions:n,keyProp:a,...o}=this.props;return r().createElement("span",{className:"mapstore-info-popover"},r().createElement(e,p({},l()(o,["renderPopover","tooltipId"]),{key:a,ref:e=>{t=e}})),r().createElement(i.Z,{placement:n.placement,shouldUpdatePosition:!0,show:!0,target:()=>d().findDOMNode(t)},r().createElement(s.Popover,n.props,n.content)))}}},251820:(e,t,n)=>{"use strict";n.d(t,{Z:()=>v});var a=n(124852),r=n.n(a),i=n(532475),s=n.n(i),o=n(414293),l=n.n(o),c=n(45697),d=n.n(c),p=n(730381),m=n.n(p),u=n(630294),g=n(36549),y=n(23888);function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const b=(0,g.Z)(u.Glyphicon);class f extends r().Component{constructor(){var e;super(...arguments),e=this,h(this,"onUpdate",((e,t)=>{const n=m()(this.props.date).utc(),a=t?m()(n).add(1,e):m()(n).subtract(1,e);a.isValid()&&!isNaN(a.toDate().getTime())&&this.props.onUpdate(a.toISOString())})),h(this,"onChange",(function(t,n){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e=>e;if(""!==n){const r=m()(e.props.date).utc(),i=r["day"===t?"date":t]&&m()(r)["day"===t?"date":t](a(n));i.isValid()&&!isNaN(i.toDate().getTime())&&e.props.onUpdate(i.toISOString())}})),h(this,"getForm",(()=>{const e=this.props.date&&m()(this.props.date).utc();return[{name:"icon",value:"calendar",type:"icon"},{name:"day",placeholder:"DD",value:e&&e.date()},{name:"month",placeholder:"MM",readOnly:!0,value:e&&e.month(),format:e=>!l()(e)&&""!==e&&m().monthsShort(e),parseValue:e=>e-1},{name:"year",placeholder:"YYYY",value:e&&e.year()},{name:"icon",value:"time",type:"icon"},{name:"hours",placeholder:"hh",value:e&&e.hours()},{name:"separator",value:":",type:"separator"},{name:"minutes",placeholder:"mm",value:e&&e.minutes()},{name:"separator",value:":",type:"separator"},{name:"seconds",placeholder:"ss",value:e&&e.seconds()},{name:"separator",value:e&&e.utcOffset(),type:"separator",format:e=>"UTC "+(e>=0?"+":"-")+s()(e/60,2,0)}]}))}render(){const e=this.getForm();return r().createElement(u.Form,{className:`ms-inline-datetime ${this.props.className}`,style:this.props.style},r().createElement(u.FormGroup,{controlId:"inlineDateTime"},this.props.glyph&&r().createElement("div",{style:this.props.clickable?{cursor:"pointer"}:{},onClick:()=>this.props.clickable&&this.props.onIconClick(this.props.date,this.props.glyph)},r().createElement(b,{tooltip:this.props.clickable?this.props.tooltip:void 0,tooltipId:this.props.clickable?this.props.tooltipId:void 0,className:"ms-inline-datetime-icon",glyph:this.props.glyph})),e.map((e=>"icon"===e.type&&r().createElement("div",{className:`ms-inline-datetime-input ms-dt-${e.name}`},r().createElement(b,{glyph:e.value}))||"separator"===e.type&&r().createElement("div",{className:`ms-inline-datetime-input ms-dt-${e.name}`},e.format&&e.format(e.value)||e.value)||r().createElement("div",{className:`ms-inline-datetime-input ms-dt-${e.name}`},this.props.showButtons&&r().createElement(y.Z,{bsSize:"xs",disabled:!this.props.date,onClick:()=>this.onUpdate(e.name,!0)},r().createElement(b,{glyph:"chevron-up"})),r().createElement(u.FormControl,{type:"text",readOnly:e.readOnly,placeholder:e.placeholder||e.name,disabled:!this.props.date,value:e.format&&e.format(e.value)||e.value,onChange:t=>this.onChange(e.name,t.target.value,e.parseValue)}),this.props.showButtons&&r().createElement(y.Z,{bsSize:"xs",disabled:!this.props.date,onClick:()=>this.onUpdate(e.name)},r().createElement(b,{glyph:"chevron-down"})))))))}}h(f,"propTypes",{date:d().string,clickable:d().bool,onUpdate:d().func,onIconClick:d().func,glyph:d().string,style:d().object,className:d().string,tooltip:d().string,tooltipId:d().string,showButtons:d().bool}),h(f,"defaultProps",{date:"",onIconClick:()=>{},clickable:!1,onUpdate:()=>{},glyph:"time",style:{},className:"",tooltip:""});const v=f},169988:(e,t,n)=>{"use strict";n.d(t,{ZP:()=>N});var a=n(49977),r=n.n(a),i=n(747037),s=n.n(i),o=n(227361),l=n.n(o),c=n(91175),d=n.n(c),p=n(984596),m=n.n(p),u=n(730381),g=n.n(u),y=n(426529),h=n(859518),b=n(69371),f=n(929761),v=n(333101),T=n(504518),E=n(612912),P=n(555994),S=n(833517),O=n(926244),k=n(175082),L=n(234425);const A="time",w=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=(0,P.Li)(e()),a=(0,P.uy)(e()),r=(0,P.Ry)(e()),i=(0,P.F3)(n)(e()),s="end"===(0,P.pW)(e());return[r,a,"time",{limit:1,...t,fromEnd:s},i]},I=(e,t,n)=>{const a=e();if((0,P.uy)(a)){const t=(0,P.pW)(a);return(0,L.w)(w,!1,e,t,n).map((e=>(0,O.Qn)(e.filter((e=>!!e)),n,t)||n))}const i=(0,S.aK)((0,E.CA)(a,t))(a);return r().Observable.of((0,O.Qn)(i,n)||n)},C=e=>s()(e)?e:e.toISOString(),R=(e,t,n)=>{const a=t.domain.split("--"),i=(0,P.YK)(n())||{start:new Date(a[0]),end:new Date(a[1])},{range:s,resolution:o}=(0,O.un)(i,20),c=(0,E.CA)(n(),e).name,p=(0,P.oo)(n()),u={[A]:`${C(s.start)}/${C(s.end)}`};return(0,k.ot)(t.source.url,c,A,{[A]:`${C(s.start)}/${C(s.end)}`},o,(0,P.F3)(e)(n())).merge((0,k.i8)(t.source.url,c,u,{...(0,P.F3)(e)(n()),expandLimit:p})).scan(((e,t)=>({...e,...t})),{}).switchMap((e=>{let{Histogram:t,Domains:n}=e;const a=l()(d()(m()(l()(n,"DimensionDomain")||[]).filter((function(){let{Identifier:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e===A}))),"Domain");let i;try{i=t&&t.Values&&t.Values.split(",").map((e=>parseInt(e,10)))||[]}catch(e){i=[]}const o=a&&a.indexOf("--")<0&&a.split(",");return r().Observable.of({range:s,histogram:t&&t.Domain?{values:i,domain:t.Domain}:void 0,domain:a?{values:o}:void 0})}))},N={setTimelineCurrentTime:function(e){let{getState:t=(()=>{})}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.ofType(b.qx).throttleTime(100).switchMap((e=>{let{time:n,group:a}=e;const i=t();return a?I(t,a,n).switchMap((e=>{const t=(0,P.YK)(i),{start:n,end:a}=t||{};let s=[];if(n&&a&&(g()(e).isBefore(n)||g()(e).isAfter(a))){const t=g()(a).diff(n);s=[(0,b.y3)({start:g()(e).subtract(t/2),end:g()(e).add(t/2)})]}return r().Observable.from([...s,(0,f.yR)(e)])})).let((0,y.hP)((0,b.aA)(!1,!0),(0,b.aA)(!1,!1))):r().Observable.of((0,f.yR)(n))}))},settingInitialOffsetValue:function(e){let{getState:t=(()=>{})}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.ofType(b.JU).switchMap((e=>{const n=5,a=t(),i=(0,S.WT)(a),s=(0,P.YK)(a);if(e.enabled){const{start:t=0,end:o=864e5*n}=s||{},l=(0,S.ns)(a),c=g()(o).diff(t);let d=s?g()(t).add(c/2).toISOString():g()(new Date).toISOString();const p=g()(i||d).add(c/n);let m=e.enabled&&!i?r().Observable.of((0,f.yR)(d)):r().Observable.empty(),u=e.enabled&&!l||e.enabled&&g()(l).diff(i)<0?r().Observable.of((0,f.pF)(p.toISOString())):r().Observable.empty();const y=s?r().Observable.empty():r().Observable.of((0,b.y3)({start:g()(d).add(-1*c/2),end:g()(d).add(c/2)}));return m.concat(u).concat(y)}return r().Observable.of((0,f.pF)())}))},updateRangeDataOnRangeChange:function(e){let{getState:t=(()=>{})}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.ofType(b.Lv).merge(e.ofType(h.pP).filter((()=>(0,P.cX)(t()))),e.ofType(b.w)).debounceTime(400).merge(e.ofType(f.XV).debounceTime(50)).switchMap((()=>{const e=(0,S.m$)(t())||{},n=Object.keys(e).filter((n=>e[n]&&e[n].domain&&(0,O._q)(e[n].domain)||(0,P.cX)(t())));return r().Observable.merge(...n.map((n=>R(n,e[n],t).map((e=>{let{range:t,histogram:a,domain:r}=e;return(0,b.cO)(n,t,a,r)})).startWith((0,b.aA)(n,!0)).catch((()=>r().Observable.of((0,T.vU)({uid:"error_with_timeline_update",title:"timeline.errors.multidim_error_title",message:"timeline.errors.multidim_error_message"})))).concat(r().Observable.of((0,b.aA)(n,!1))))))}))},syncTimelineGuideLayer:function(e){let{getState:t=(()=>{})}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.ofType(b.cb).merge(e.ofType(v.sb,v.yS).withLatestFrom(e.ofType(b._V),((e,n)=>{let{layerId:a}=n;return a&&!(0,P.rV)(t()).some((e=>e.id===a))})).filter((e=>!!e))).switchMap((()=>{const e=t(),n=l()((0,P.rV)(e),"[0].id");return(0,P.en)(e)&&n?r().Observable.of((0,b.kq)(n)):r().Observable.empty()}))},snapTimeGuideLayer:function(e){let{getState:t=(()=>{})}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.ofType(b._V).filter((e=>(null==e?void 0:e.layerId)&&(0,P.en)(t()))).switchMap((e=>{let{layerId:n}=e;return I(t,n,(0,S.WT)(t())||(new Date).toISOString()).filter((e=>e)).map((e=>(0,f.yR)(e)))}))}}},234425:(e,t,n)=>{"use strict";n.d(t,{w:()=>o});var a=n(49977),r=n.n(a),i=n(175082),s=n(926244);const o=(e,t,n,a,o)=>r().Observable.forkJoin((0,i.Ci)(...e(n,{sort:"asc",fromValue:t?(0,s.p)(o,1e-4,"remove"):o,..."end"===a?{fromEnd:!0}:{}})).map((e=>e.DomainValues.Domain.split(","))).map((e=>{let[t]=e;return t})).catch((e=>e&&r().Observable.of(null))),(0,i.Ci)(...e(n,{sort:"desc",fromValue:t?(0,s.p)(o,1e-4,"add"):o,..."end"===a?{fromEnd:!0}:{}})).map((e=>e.DomainValues.Domain.split(","))).map((e=>{let[t]=e;return t})).catch((e=>e&&r().Observable.of(null))))},382652:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>he});var a=n(91175),r=n.n(a),i=n(747037),s=n.n(i),o=n(730381),l=n.n(o),c=n(727418),d=n.n(c),p=n(124852),m=n.n(p),u=n(630294),g=n(171703),y=n(867076),h=n(22222),b=n(929761),f=n(481151),v=n(69371),T=n(804504),E=n(36549),P=n(640924),S=n(8204),O=n(251820),k=n(833517),L=n(350126),A=n(365452),w=n(555994),I=n(513218),C=n.n(I),R=n(170735),N=n.n(R),D=n(414293),Y=n.n(D),Z=n(359704),V=n.n(Z),B=n(297977),_=n(904160),M=n(715828),x=n(52713),K=n(92742),U=n.n(K),F=n(926244);const H=(e,t)=>l()(t).diff(e)>0,$=(0,y.withHandlers)({clickHandler:e=>{let{selectedLayer:t,offsetEnabled:n,status:a,setCurrentTime:r=(()=>{}),selectGroup:i=(()=>{})}=e;return function(){let{time:e,group:s,what:o,event:l}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("PLAY"!==a)switch(o){case"group-label":s&&"PLAY"!==a&&i(s);break;default:{const a=l&&l.target&&l.target.closest(".vis-custom-time"),i=a&&a.getAttribute("class"),s=i&&U()(i.replace("vis-custom-time",""));e&&!n&&"startPlaybackTime"!==s&&"endPlaybackTime"!==s&&r(e.toISOString(),t);break}}}},timechangedHandler:e=>{let{currentTime:t,setOffset:n=(()=>{}),setCurrentTime:a=(()=>{}),currentTimeRange:r={},playbackRange:i,setPlaybackRange:s=(()=>{}),selectedLayer:o}=e;return function(){let{time:e,id:l}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("startPlaybackTime"!==l&&"endPlaybackTime"!==l)"currentTime"===l&&(r.end?H(e,r.end)?a(e.toISOString(),null):(a(r.end),n(e.toISOString())):a(e.toISOString(),o)),"offsetTime"===l&&(H(t,e)?n(e.toISOString()):(a(e.toISOString()),n(t)));else{const t={...i,[l]:e.toISOString()};let{start:n,end:a}=(0,F.og)(t.startPlaybackTime,t.endPlaybackTime);H(n,a)&&s({startPlaybackTime:n,endPlaybackTime:a})}}}}),G=(0,y.compose)((0,y.withPropsOnChange)(["rangeItems","playbackRange","playbackEnabled","selectedLayer"],(e=>{let{rangeItems:t=[],playbackEnabled:n,playbackRange:a}=e;return{rangeItems:n&&a&&void 0!==a.startPlaybackTime&&void 0!==a.endPlaybackTime?[...t,{id:"playback-range",...(0,F.og)(a.startPlaybackTime,a.endPlaybackTime),type:"background",className:"ms-playback-range"}].filter((e=>e)):t}})),(0,y.compose)((0,y.withHandlers)({onUpdate:e=>{let{moveCurrentRange:t=(()=>{})}=e;return e=>{let{id:n,start:a}=e;"current-range"===n&&t(a.toISOString())}}}),(0,y.withPropsOnChange)(["options","onUpdate"],(e=>{let{options:t={},onUpdate:n=(()=>{})}=e;return{options:{...t,snap:null,editable:{add:!1,updateTime:!1,updateGroup:!1,remove:!1,overrideItems:!1},onMove:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;n(e),t(e)}}}})),(0,y.withPropsOnChange)(["rangeItems","currentTime","offsetEnabled","selectedLayer","currentTimeRange","readOnly"],(e=>{let{currentTimeRange:t,rangeItems:n=[],readOnly:a,offsetEnabled:r}=e;return{rangeItems:r&&void 0!==t.start&&void 0!==t.end?[...n,{id:"current-range",editable:{updateTime:!a,updateGroup:!1,remove:!1},...(0,F.og)(t.start,t.end),type:"background",className:"ms-current-range"}].filter((e=>e)):n}}))),(0,y.withPropsOnChange)(["currentTime","playbackRange","playbackEnabled","offsetEnabled","currentTimeRange"],(e=>{let{currentTime:t,playbackRange:n,playbackEnabled:a,offsetEnabled:r,currentTimeRange:i}=e;return{customTimes:[t?{currentTime:t}:{},a&&n&&n.startPlaybackTime&&n.endPlaybackTime?n:{},r&&i?{offsetTime:i.end}:{}].reduce(((e,t)=>t?{...e,...t}:{...e}),{})}})));var W=n(707366);const j=(0,_.o)(((e,t)=>e===t||!Y()(e)&&!Y()(t)&&e.id===t.id&&e.title===t.title&&e.name===t.name))(w.rV,(e=>e)),z=(0,y.compose)((0,g.connect)((0,h.P1)(w.YK,w.__,j,w.E2,W.Pz,((e,t,n,a,r)=>({viewRange:e,items:t,layers:n,loading:a,currentLocale:r})))),(0,y.withPropsOnChange)(((e,t)=>{const{layers:n=[],loading:a,selectedLayer:r,currentLocale:i}=e,{layers:s,loading:o,selectedLayer:l,nextLocale:c}=t,d=e.hideLayersName!==t.hideLayersName;return a!==o||r!==l||i!==c||d||n&&s&&n.length!==s.length||N()(n,s||[],(function(){let{id:e,title:t,name:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e+t+n})).length>0}),(e=>{let{layers:t=[],loading:n={},selectedLayer:a,currentLocale:r}=e;return{groups:t.map((e=>({id:e.id,className:(n[e.id]?"loading":"")+(e.id&&e.id===a?" selected":""),content:'<div class="timeline-layer-label-container">'+(n[e.id]?'<div class="timeline-layer-icon"><div class="timeline-spinner"></div></div>':`<div class="timeline-layer-icon">${e.id&&e.id===a?'<i class="glyphicon glyphicon-time"></i>':""}</div>`)+`<div class="timeline-layer-title">${C()(e.title)?e.title[r]??e.title.default:s()(e.title)&&e.title?e.title:e.name}</div></div>`})))}}))),q=(0,y.compose)((0,g.connect)((0,h.P1)(k.WT,w.m_,((e,t)=>({currentTime:e,currentTimeRange:t}))),{setCurrentTime:v.HM,moveCurrentRange:b.PZ,setOffset:b.pF})),X=(0,y.compose)((0,g.connect)((0,h.zB)({playbackRange:A.KC,status:A.dS}),{setPlaybackRange:f.VS})),Q=(0,y.compose)((0,g.connect)((0,h.P1)(w.Li,(e=>({selectedLayer:e}))),{selectGroup:v.kq})),J=(0,y.compose)((0,g.connect)((()=>({})),{rangechangedHandler:v.y3})),ee=(0,y.compose)(q,X,Q,$,J,z,(0,y.defaultProps)({key:"timeline",options:{maxHeight:"90%",verticalScroll:!0,stack:!1,showMajorLabels:!0,showCurrentTime:!1,zoomMin:10,zoomable:!0,type:"background",margin:{item:0,axis:0},format:{minorLabels:{minute:"h:mma",hour:"ha"}},itemsAlwaysDraggable:!0,moment:e=>l()(e).utc()}}),(0,y.withPropsOnChange)(["viewRange","options"],(e=>{let{viewRange:t={},options:n}=e;return{options:{...n,...t}}})),(0,y.withPropsOnChange)(["status"],(e=>{let{status:t}=e;return{readOnly:"PLAY"===t}})),(0,y.withPropsOnChange)(["items"],(e=>{let{items:t,options:n}=e;return{options:{...n,...V()(t,{className:"interval"})&&{stack:!0}}}})),G,(0,M.Z)((e=>{let{loading:t}=e;return t&&t.timeline}),(()=>m().createElement("div",{style:{margin:"auto",fontWeight:"bold"}},m().createElement(x.Z,{style:{display:"inline-block",verticalAlign:"middle"}}),m().createElement(T.Z,{msgId:"loading"}))),{white:!0}))((0,B.Z)()((0,p.lazy)((()=>Promise.all([n.e(9824),n.e(4328)]).then(n.bind(n,875990))))));var te=n(49977),ne=n.n(te),ae=n(832979),re=n(23888);function ie(){return ie=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},ie.apply(this,arguments)}const se=(0,y.compose)((0,y.withProps)({collapseHintPopoverOptions:{placement:"top",props:{title:m().createElement("span",null,m().createElement(u.Glyphicon,{glyph:"time"})," ",m().createElement("strong",null,m().createElement(T.Z,{msgId:"timeline.collapsed.title"})))},content:m().createElement(T.Z,{msgId:"timeline.collapsed.tooltip"})}}),(0,y.mapPropsStream)((e=>e.combineLatest((e=>e.distinctUntilKeyChanged("collapsed").filter((e=>{let{collapsed:t}=e;return t})).take(1).switchMap((e=>{let{collapseHintPopoverOptions:t}=e;return ne().Observable.timer(5e3).startWith({popoverOptions:t}).concat(ne().Observable.of({}))})).startWith({}))(e),((e,t)=>({...e,...t}))))),(0,y.branch)((e=>{let{popoverOptions:t}=e;return t}),ae.Z,E.Z))(re.Z),oe=(0,y.compose)((0,g.connect)((0,h.P1)(w.zb,w.qJ,((e,t)=>({collapsed:e,visible:t}))),{setCollapsed:v.w2}),(0,y.branch)((e=>{let{visible:t}=e;return!t}),y.renderNothing),(0,y.withHandlers)({onClick:e=>{let{collapsed:t,setCollapsed:n}=e;return()=>n(!t)}}),(0,y.withProps)((e=>{let{collapsed:t}=e;return{bsStyle:t?"primary":"success",tooltipId:t?"timeline.show":"timeline.hide"}})))((e=>m().createElement(se,ie({},e,{bsSize:"xsmall"}),m().createElement(u.Glyphicon,{glyph:"time"}))));var le=n(399790),ce=n(89518);function de(){return de=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},de.apply(this,arguments)}const pe=(0,E.Z)(re.Z),me=e=>s()(e)&&-1!==e.indexOf("%"),ue=e=>parseInt(e,10)/100,ge=(e,t)=>l()(t).diff(e)>0,ye=(0,y.compose)((0,g.connect)((0,h.P1)(w.pn,w.rV,k.WT,w.m_,k.RP,A.KC,A.dS,w.YK,(e=>{var t;return void 0!==(null===(t=e.timeline)||void 0===t?void 0:t.loader)}),((e,t,n,a,r,i,s,o,l)=>({visible:e,layers:t,currentTime:n,currentTimeRange:a,offsetEnabled:r,playbackRange:i,status:s,viewRange:o,timelineIsReady:l}))),{setCurrentTime:v.HM,onOffsetEnabled:v.PQ,setOffset:b.pF,setPlaybackRange:f.VS,moveRangeTo:v.y3,onInit:v._e}),(0,y.branch)((e=>{let{visible:t=!0,layers:n=[]}=e;return!t||0===Object.keys(n).length}),y.renderNothing),(0,y.withState)("options","setOptions",(e=>{let{expandedPanel:t}=e;return{collapsed:!t}})),(0,g.connect)((0,h.P1)(w.cX,(e=>({mapSync:e}))),{toggleMapSync:v.Z7}),(0,y.compose)((0,y.compose)((0,y.withStateHandlers)((()=>({})),{onResize:()=>e=>{let{width:t}=e;return{containerWidth:t}}}),(0,P.Z)({querySelector:".ms2",closest:!0,debounceTime:100})),(0,y.defaultProps)({showHiddenLayers:!1,expandLimit:20,snapType:"start",endValuesSupport:void 0,style:{marginBottom:35,marginLeft:100,marginRight:80}}),(0,g.connect)((0,h.P1)((e=>(0,L.ic)(e,{right:!0,bottom:!0,left:!0})),(e=>({mapLayoutStyle:e})))),(0,y.withProps)((e=>{let{containerWidth:t,style:n,mapLayoutStyle:a}=e;const{marginLeft:r,marginRight:i}=n||{};let{left:s=0,right:o=0}=a;if(o=me(o)&&ue(o)*t||o,s=me(s)&&ue(s)*t||s,t){const e=t-o-s-r-i;return{hide:e<410,compactToolbar:e<880,style:{...n,...a,minWidth:410}}}return{style:{...n,...a,minWidth:410}}})),(0,y.branch)((e=>{let{hide:t}=e;return t}),y.renderNothing),(0,y.setDisplayName)("TimelinePlugin")))((e=>{let{items:t,options:n,setOptions:a,mapSync:i,toggleMapSync:s=(()=>{}),currentTime:o,setCurrentTime:c,offsetEnabled:d,onOffsetEnabled:g,currentTimeRange:y,setOffset:h,style:b,status:f,viewRange:v,moveRangeTo:E,compactToolbar:P,showHiddenLayers:k,expandLimit:L,snapType:A,endValuesSupport:w,onInit:I=(()=>{}),layers:C,timelineIsReady:R}=e;(0,p.useEffect)((()=>{I(k,L,A,w)}),[I]);const{hideLayersName:N,collapsed:D}=n,Y=r()(t&&t.filter((e=>"playback"===e.name))),Z=Y&&Y.plugin,V=(e,t,n,a)=>{const r=l()(n.end).diff(n.start)/2;if("time-current"===t&&n&&n.start.toString()!==l()(e).add(-1*r).toString()&&n.end.toString()!==l()(e).add(r).toString()&&E({start:l()(e).add(-1*r),end:l()(e).add(r)}),"range-start"===t||"range-end"===t){const e=l()(a.end).diff(a.start),t=l()(a.start).add(e/2);E(e/2<=r?{start:l()(t).add(-1*r),end:l()(t).add(r)}:{start:l()(t).add(-1*e*5/2),end:l()(t).add(5*e/2)})}};return m().createElement("div",{style:{position:"absolute",marginBottom:35,marginLeft:100,...b,right:D?"auto":b.right||0},className:`timeline-plugin${N?" hide-layers-name":""}${d?" with-time-offset":""} ${(0,le.ab)(C)?"":"hidden"}`},d&&m().createElement(O.Z,{clickable:!D,glyph:"range-start",onIconClick:(e,t)=>"PLAY"!==f&&V(e,t,v,y),tooltip:m().createElement(T.Z,{msgId:"timeline.rangeStart"}),showButtons:!0,date:o||y&&y.start,onUpdate:e=>(y&&ge(e,y.end)||!y)&&"PLAY"!==f&&c(e),className:"shadow-soft",style:{position:"absolute",top:-5,left:2,transform:"translateY(-100%)"}}),m().createElement("div",{className:"timeline-plugin-toolbar"+(P?" ms-collapsed":"")},d&&y?m().createElement(O.Z,{clickable:!D,glyph:"range-end",onIconClick:(e,t)=>"PLAY"!==f&&V(e,t,v,y),tooltip:m().createElement(T.Z,{msgId:"timeline.rangeEnd"}),date:y.end,showButtons:!0,onUpdate:e=>"PLAY"!==f&&ge(o,e)&&h(e)}):m().createElement(O.Z,{clickable:!D,glyph:"time-current",showButtons:!0,onIconClick:(e,t)=>"PLAY"!==f&&V(e,t,v),tooltip:m().createElement(T.Z,{msgId:"timeline.currentTime"}),date:o||y&&y.start,onUpdate:e=>(y&&ge(e,y.end)||!y)&&"PLAY"!==f&&c(e)}),m().createElement("div",{className:"timeline-plugin-btn-group"},m().createElement(S.Z,{btnDefaultProps:{className:"square-button-md",bsStyle:"primary"},buttons:[{glyph:"list",tooltip:m().createElement(T.Z,{msgId:N?"timeline.showLayerName":"timeline.hideLayerName"}),bsStyle:N?"primary":"success",visible:!D,active:!N,onClick:()=>a({...n,hideLayersName:!N})},{glyph:"time-offset",bsStyle:d?"success":"primary",active:d,disabled:"PLAY"===f,tooltip:m().createElement(T.Z,{msgId:d?"timeline.disableRange":"timeline.enableRange"}),onClick:()=>{"PLAY"!==f&&g(!d)}},{glyph:"map-synch",tooltip:m().createElement(T.Z,{msgId:i?"timeline.mapSyncOn":"timeline.mapSyncOff"}),bsStyle:i?"success":"primary",active:i,onClick:()=>s(!i)}]}),Z&&m().createElement(Z,de({},Y,{settingsStyle:{right:D||P?40:"unset"}}))),m().createElement(pe,{onClick:()=>a({...n,collapsed:!D}),className:"square-button-sm ms-timeline-expand",bsStyle:"primary",tooltip:m().createElement(T.Z,{msgId:D?"timeline.expand":"timeline.collapse"})},m().createElement(u.Glyphicon,{glyph:D?"chevron-up":"chevron-down"}))),!R&&m().createElement("div",{className:"timeline-loader"},m().createElement(ce.Z,{size:50})),!D&&m().createElement(ee,{offsetEnabled:d,playbackEnabled:!0,hideLayersName:N,timelineLayers:C}))})),he={TimelinePlugin:d()(ye,{disablePluginIf:"{state('mapType') === 'cesium'}",WidgetsTray:{tool:m().createElement(oe,null),position:0}}),reducers:{dimension:n(811974).Z,timeline:n(729536).Z},epics:n(169988).ZP}},811974:(e,t,n)=>{"use strict";n.d(t,{Z:()=>u});var a=n(929761),r=n(333101),i=n(687753),s=n(521923),o=n(730381),l=n.n(o),c=n(66604),d=n.n(c),p=n(535937),m=n.n(p);const u=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case a.XV:return(0,s.t8)(`data[${t.dimension}][${t.layerId}]`,t.data,e);case a.mE:return(0,s.t8)("currentTime",t.time,e);case a.at:return(0,s.t8)("offsetTime",t.offsetTime,e);case a.mD:if(e.offsetTime&&e.currentTime){const n=l()(e.offsetTime).diff(e.currentTime),a=l()(t.time).add(n);return(0,s.t8)("currentTime",t.time,(0,s.t8)("offsetTime",a.toISOString(),e))}return(0,s.t8)("currentTime",t.time,e);case r.sb:{const n=d()(e.data,(e=>m()(e,((e,n)=>n!==t.node))));return(0,s.t8)("data",n,e)}case i.l:return(0,s.t8)("data",void 0,(0,s.t8)("currentTime",void 0,(0,s.t8)("offsetTime",void 0,e)));default:return e}}},729536:(e,t,n)=>{"use strict";n.d(t,{Z:()=>y});var a=n(333101),r=n(687753),i=n(69371),s=n(926854),o=n(481151),l=n(521923),c=n(328583),d=n.n(c),p=n(535937),m=n.n(p),u=n(218721),g=n.n(u);const y=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{settings:{autoSelect:!0,collapsed:!1,snapType:"start",snapRadioButtonEnabled:!1}},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case i.M5:return(0,l.t8)("settings.collapsed",t.collapsed,e);case i.w:return(0,l.t8)("settings.mapSync",t.mapSync,e);case i.lz:return(0,l.t8)("settings.snapType",t.snapType,e);case i.Wb:return(0,l.t8)("settings.endValuesSupport",t.endValuesSupport,e);case i.Lv:return(0,l.t8)("range",{start:t.start,end:t.end},e);case i.iv:return(0,l.t8)(`rangeData[${t.layerId}]`,{range:t.range,histogram:t.histogram,domain:t.domain},e);case i.br:return t.layerId?(0,l.t8)(`loading[${t.layerId}]`,t.loading,e):(0,l.t8)("loading.timeline",t.loading,e);case i._V:{let n=e;return n=(0,l.t8)("selectedLayer",t.layerId,n),n=(0,l.t8)("settings",{...n.settings,snapType:"start",snapRadioButtonEnabled:!1},n),n}case o.AN:return(0,l.t8)("settings.snapRadioButtonEnabled",t.timeIntervalData,e);case i.Xe:return(0,l.t8)("selectedLayer",t.layerId,e);case a.sb:{let n=e;return d()({},e,{rangeData:g()(n.rangeData,t.node)?m()(n.rangeData,((e,n)=>n!==t.node)):n.rangeData,loading:g()(n.rangeData,t.node)?m()(n.loading,((e,n)=>n!==t.node)):n.loading,selectedLayer:e.selectedLayer===t.node?void 0:e.selectedLayer})}case r.l:return d()({},e,{range:void 0,rangeData:void 0,selectedLayer:void 0,loading:void 0,MouseEvent:void 0});case i.p:{var n,c;const a=null==e||null===(n=e.settings)||void 0===n?void 0:n.endValuesSupport,r=null==e||null===(c=e.settings)||void 0===c?void 0:c.snapRadioButtonEnabled;return(0,l.t8)("settings",{...e.settings,showHiddenLayers:t.showHiddenLayers,expandLimit:t.expandLimit,snapType:t.snapType,endValuesSupport:void 0!==a?a:t.endValuesSupport,snapRadioButtonEnabled:void 0!==r?r:t.snapRadioButtonEnabled},e)}case s.ok:var p,u,y,h;return{...e,settings:{...e.settings,endValuesSupport:null==t||null===(p=t.config)||void 0===p||null===(u=p.timelineData)||void 0===u?void 0:u.endValuesSupport,snapRadioButtonEnabled:null==t||null===(y=t.config)||void 0===y||null===(h=y.timelineData)||void 0===h?void 0:h.snapRadioButtonEnabled}};default:return e}}},365452:(e,t,n)=>{"use strict";n.d(t,{z2:()=>r,V3:()=>i,dS:()=>s,yt:()=>l,E2:()=>c,Np:()=>d,KC:()=>p,Wq:()=>m,rp:()=>u,PF:()=>g});var a=n(22222);const r=e=>e&&e.playback&&e.playback.settings,i=e=>(r(e)||{}).frameDuration||5,s=e=>e&&e.playback&&e.playback.status,o=e=>e&&e.playback&&e.playback.frames,l=e=>{const t=o(e)||[];return t[t.length-1]},c=e=>e&&e.playback&&e.playback.framesLoading,d=e=>e&&e.playback&&e.playback.currentFrame,p=e=>(e=>e&&e.playback&&e.playback.playbackRange)(e),m=e=>(o(e)||[])[d(e)],u=e=>e&&e.playback&&e.playback.metadata,g=(0,a.P1)(o,d,(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return{hasNext:e[t+1],hasPrevious:e[t-1]}}))},18190:e=>{var t=Math.floor;e.exports=function(e,n){var a="";if(!e||n<1||n>9007199254740991)return a;do{n%2&&(a+=e),(n=t(n/2))&&(e+=e)}while(n);return a}},105076:(e,t,n)=>{var a=n(989881);e.exports=function(e,t){var n;return a(e,(function(e,a,r){return!(n=t(e,a,r))})),!!n}},378302:(e,t,n)=>{var a=n(18190),r=n(880531),i=n(440180),s=n(862689),o=n(788016),l=n(683140),c=Math.ceil;e.exports=function(e,t){var n=(t=void 0===t?" ":r(t)).length;if(n<2)return n?a(t,e):t;var d=a(t,c(e/o(t)));return s(t)?i(l(d),0,e).join(""):d.slice(0,e)}},170735:(e,t,n)=>{var a=n(920731),r=n(121078),i=n(267206),s=n(105976),o=n(229246),l=n(610928),c=s((function(e,t){var n=l(t);return o(n)&&(n=void 0),o(e)?a(e,r(t,1,o,!0),i(n,2)):[]}));e.exports=c},532475:(e,t,n)=>{var a=n(378302),r=n(788016),i=n(640554),s=n(479833);e.exports=function(e,t,n){e=s(e);var o=(t=i(t))?r(e):0;return t&&o<t?a(t-o,n)+e:e}},359704:(e,t,n)=>{var a=n(282908),r=n(267206),i=n(105076),s=n(701469),o=n(816612);e.exports=function(e,t,n){var l=s(e)?a:i;return n&&o(e,t,n)&&(t=void 0),l(e,r(t,3))}}}]);