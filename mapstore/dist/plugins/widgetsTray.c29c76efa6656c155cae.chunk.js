(self.webpackChunkmapstore2=self.webpackChunkmapstore2||[]).push([[6949],{468178:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>K});var n=s(124852),o=s.n(n),l=s(45697),r=s.n(l),i=s(171703),a=s(867076),p=s(22222),c=s(36549),d=s(630294),u=s(952273),g=s(492838),h=s(313311),m=s.n(h),f=s(630998),y=s.n(f),b=s(189734),w=s.n(b);const v=e=>!e.dataGrid||!e.dataGrid.static,P=(0,p.P1)(u.zm,u.YR,u.yZ,u.lF,(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,s=arguments.length>2?arguments[2]:void 0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return w()(e.filter(v).map((e=>y()(t,(t=>t===e.id))>=0?{...e,collapsed:!0}:e)),(e=>{const t=n[e.id]&&n[e.id].layout,o=m()(s,{i:e.id})||t||{},{x:l=0,y:r=0}=o;return 100*r+l}))}));var O=s(725211);const x=(0,a.compose)((0,a.defaultProps)({toolsOptions:{seeHidden:"user.role===ADMIN"}}),(0,O.Z)("toolsOptions",{asObject:!0}),(0,a.withProps)((e=>{let{widgets:t,toolsOptions:s={seeHidden:!1}}=e;return{widgets:s.seeHidden?t:t.filter((e=>!e.hide))}})));var C=s(756435),T=s(8204);const E=function(){let{widgetType:e,type:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const s=e&&"chart"!==e?e:t;switch(s){case"text":return"sheet";case"table":return"features-grid";case"pie":return"pie-chart";case"line":return"1-line";case"map":return"1-map";case"counter":return"counter";default:return"stats"}},k=(0,a.compose)((0,a.withPropsOnChange)(["btnGroupProps"],(e=>{let{btnGroupProps:t}=e;return{btnGroupProps:{...t,className:"widgets-bar"+(t&&t.className?` ${t.className}`:"")}}})),(0,a.withPropsOnChange)(["widgets","onClick"],(e=>{let{widgets:t=[],onClick:s=(()=>{})}=e;return{buttons:t.map((e=>({glyph:E(e),tooltip:e.title,className:e.collapsed?"btn-tray":"btn-tray active",onClick:()=>s(e)})))}})))(T.Z),I=(0,a.compose)((0,i.connect)((0,p.P1)(P,(e=>({widgets:e}))),{onClick:g.f}),(0,a.defaultProps)({btnGroupProps:{className:"widgets-toolbar",style:{marginLeft:2,marginRight:2}}}),x,(0,a.withProps)((e=>{let{btnGroupProps:t={},btnDefaultProps:s={}}=e;return{btnGroupProps:{bsSize:"xsmall",...t},btnDefaultProps:{bsSize:"xsmall",...s||{}}}})))(k);var S=s(23888),G=s(350126);function W(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const Z=(0,c.Z)(S.Z),F=function(){let{expanded:e,onClick:t=(()=>{})}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o().createElement(Z,{tooltipId:e?"widgets.tray.collapseTray":"widgets.tray.expandTray",bsSize:"xsmall",bsStyle:"default",style:{borderColor:"transparent"},onClick:t},o().createElement(d.Glyphicon,{glyph:e?"chevron-right":"chevron-left"}))},M=(0,a.compose)((0,i.connect)((0,p.P1)(u.E5,(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{widgets:e}})),{onClick:()=>(0,g.Ff)()}),x,(0,a.withProps)((e=>{let{widgets:t=[]}=e;return{shouldExpand:0===t.length}})))((function(){let{onClick:e=(()=>{}),shouldExpand:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o().createElement(Z,{tooltipId:t?"widgets.tray.expandAll":"widgets.tray.collapseAll",bsStyle:t?"primary":"success active",bsSize:"xsmall",onClick:e},o().createElement(d.Glyphicon,{glyph:"list"}))}));class N extends o().Component{render(){var e;return this.props.enabled?o().createElement("div",{className:"widgets-tray",style:{marginBottom:32,marginRight:((null===(e=this.props.layout)||void 0===e?void 0:e.right)??0)+65,bottom:0,right:0,position:"absolute"}},o().createElement(C.Z,{columns:[o().createElement(F,{key:"collapse-tray",toolsOptions:this.props.toolsOptions,expanded:this.props.expanded,onClick:()=>this.props.setExpanded(!this.props.expanded)}),o().createElement(M,{key:"collapse-all",toolsOptions:this.props.toolsOptions}),...this.props.items.map((e=>e.tool))||[]]},this.props.expanded?o().createElement(I,{toolsOptions:this.props.toolsOptions}):null)):null}}W(N,"propTypes",{enabled:r().bool,toolsOptions:r().object,items:r().array,expanded:r().bool,setExpanded:r().func,layout:r().object}),W(N,"defaultProps",{enabled:!0,items:[],expanded:!1,setExpanded:()=>{},layout:{}});const z=(0,a.compose)((0,a.withState)("expanded","setExpanded",!1),(0,i.connect)((0,p.P1)(P,(e=>(0,G.ic)(e,{right:!0})),(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return{widgets:e,layout:t}})),{toggleTray:g.ep}),x,(0,a.withProps)((e=>{let{widgets:t=[]}=e;return{hasCollapsedWidgets:t.filter((function(){let{collapsed:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e})).length>0,hasTrayWidgets:t.length>0}})),(0,a.lifecycle)({componentDidMount(){this.props.toggleTray&&this.props.toggleTray(!0)},componentWillUnmount(){this.props.toggleTray&&this.props.toggleTray(!1)}}),(0,a.mapPropsStream)((e=>e.merge(e.distinctUntilKeyChanged("hasCollapsedWidgets").do((e=>{let{setExpanded:t=(()=>{}),hasCollapsedWidgets:s}=e;return t(s)})).ignoreElements()))),(0,a.withProps)((e=>{let{enabled:t,hasTrayWidgets:s}=e;return{enabled:t&&s}})))(N);var V=s(748928),j=s(49977),A=s.n(j),D=s(227361),J=s.n(D),_=s(69371),H=s(926854),R=s(504518),U=s(333101),Y=s(555994);const $=e=>((0,u.E5)(e)||[]).filter((e=>!J()(e,"dataGrid.static"))).length>0,q=e=>t=>t.take(1).switchMap((()=>A().Observable.of((0,R.um)({...e,autoDismiss:8,position:"tr",uid:"timeline-collapsed"})))).merge(t),B={collapseTimelineOnWidgetsEvents:function(e){let{getState:t=(()=>{})}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return A().Observable.merge(e.ofType(g.Ym,g.uU,H.ok,g.$A,g.Jm).filter((()=>$(t())&&(0,Y.pn)(t())))).switchMap((()=>A().Observable.of((0,_.w2)(!0)))).let(q({title:"widgets.tray.notifications.collapsed.timelineTitle",message:"widgets.tray.notifications.collapsed.message"}))},collapseWidgetsOnTimelineEvents:function(e){let{getState:t=(()=>{})}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return A().Observable.merge(e.ofType(_.M5).filter((e=>{let{collapsed:t}=e;return!t})),e.ofType(U.yS).filter((function(){let{newProperties:e={}}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.dimensions}))).filter((()=>$(t())&&(0,Y.qJ)(t())&&(0,Y.pn)(t()))).switchMap((()=>A().Observable.of((0,g.Ff)()))).let(q({title:"widgets.tray.notifications.collapsed.widgetsTitle",message:"widgets.tray.notifications.collapsed.message"}))},expandTimelineIfCollapsedOnTrayUnmount:function(e){let{getState:t=(()=>{})}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.ofType(g.yY,g.$A,H.ok).filter((()=>!(0,Y.pn)(t())&&(0,Y.qJ)(t()))).filter((()=>!$(t()))).switchMap((()=>A().Observable.of((0,_.w2)(!1))))}},K={WidgetsTrayPlugin:(0,V.Z)(z),epics:B}},748928:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});var n=s(22222),o=s(171703),l=s(350126),r=s(101092);const i=(0,o.connect)((0,n.P1)(l.Jz,l.VM,r.c0,((e,t,s)=>({enabled:!e&&!t&&!s}))))},725211:(e,t,s)=>{"use strict";s.d(t,{Z:()=>v});var n=s(867076),o=s(171703),l=s(22222),r=s(274363),i=s(510644),a=s(227361),p=s.n(a),c=s(984596),d=s.n(c),u=s(66604),g=s.n(u),h=s(747037),m=s.n(h),f=s(701469),y=s.n(f);const b=e=>{let{accessInfo:t,postProcessValue:s,reduceFun:n}=e;return e=>{let o=d()(e),l=n;return o.length>1&&"__OR__"===o[0]&&(l=(e,t)=>e||t,o=o.slice(1)),o.map((e=>{let o=e;if(y()(o))return b({accessInfo:t,postProcessValue:s,reduceFun:n})(o);let l=!1;o&&m()(o)&&o.startsWith("!")&&(l=!0,o=o.substr(1));const r=e=>l?!e:e,i=m()(o)&&o.split(":");if(i&&i[0]){const e=i[0].split(/\!\=\=?/),n=i[0].split(/\=\=?\=?/);return e.length>1?r(s(p()(t,e[0]),o)!==e[1]):n.length>1?r(s(p()(t,n[0]),o)===n[1]):r(s(p()(t,i[0]),o))}return o})).reduce(l||((e,t)=>e&&t))}},w=function(e){let{asObject:t=!1,postProcessValue:s=(e=>e),reduceFun:o,accessInfo:l="accessInfo"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,n.withPropsOnChange)([e,l],(function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t?{[e]:g()(n[e],b({accessInfo:n[l],postProcessValue:s,reduceFun:o}))}:{[e]:b({accessInfo:n[l],postProcessValue:s,reduceFun:o})(n[e])}}))},v=function(){return(0,n.compose)((0,o.connect)((0,l.P1)(r.J9,r._H,i.np,((e,t,s)=>({accessInfo:{mapId:e,mapInfo:t,user:s}})))),w(...arguments))}}}]);